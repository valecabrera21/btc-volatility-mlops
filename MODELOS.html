
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Modelos de predicción de la volatilidad para cada ventana (7, 14, 21 y 28 días) &#8212; MiniProyecto 2</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'MODELOS';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Análisis de los residuos para cada volatilidad" href="RESIDUOS.html" />
    <link rel="prev" title="Análisis Exploratorio de los Datos" href="EDA.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="MiniProyecto 2 - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="MiniProyecto 2 - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    <div style="text-align: center;">Mini Proyecto 2</div>
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="EDA.html"><strong>Análisis Exploratorio de los Datos</strong></a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><strong>Modelos de predicción de la volatilidad para cada ventana (7, 14, 21 y 28 días)</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="RESIDUOS.html"><strong>Análisis de los residuos para cada volatilidad</strong></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FMODELOS.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/MODELOS.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Modelos de predicción de la volatilidad para cada ventana (7, 14, 21 y 28 días)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#librerias"><strong>Librerías</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#base-de-datos"><strong>Base de datos</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#funciones-importantes"><strong>Funciones importantes</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-prediccion-por-volatilidad"><strong>Modelos de predicción por volatilidad</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#volatilidad-de-la-ventana-de-7-dias"><strong>Volatilidad de la ventana de 7 días</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretaciones"><strong>Interpretaciones</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#lag-7-dias"><strong>Lag 7 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#lag-14-dias"><strong>Lag 14 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#lag-21-dias"><strong>Lag 21 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#lag-28-dias"><strong>Lag 28 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#general"><strong>General</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#volatilidad-de-la-ventana-de-14-dias"><strong>Volatilidad de la ventana de 14 días</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"><strong>Interpretaciones</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><strong>Lag 7 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><strong>Lag 14 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id4"><strong>Lag 21 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id5"><strong>Lag 28 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id6"><strong>General</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#volatilidad-de-la-ventana-de-21-dias"><strong>Volatilidad de la ventana de 21 días</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7"><strong>Interpretaciones</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id8"><strong>Lag 7 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id9"><strong>Lag 14 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id10"><strong>Lag 21 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id11"><strong>Lag 28 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id12"><strong>General</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#volatilidad-de-la-ventana-de-28-dias"><strong>Volatilidad de la ventana de 28 días</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id13"><strong>Interpretaciones</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id14"><strong>Lag 7 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id15"><strong>Lag 14 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id16"><strong>Lag 21 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id17"><strong>Lag 28 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id18"><strong>General</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-general"><strong>Análisis general</strong></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="modelos-de-prediccion-de-la-volatilidad-para-cada-ventana-7-14-21-y-28-dias">
<h1><strong>Modelos de predicción de la volatilidad para cada ventana (7, 14, 21 y 28 días)</strong><a class="headerlink" href="#modelos-de-prediccion-de-la-volatilidad-para-cada-ventana-7-14-21-y-28-dias" title="Link to this heading">#</a></h1>
<section id="librerias">
<h2><strong>Librerías</strong><a class="headerlink" href="#librerias" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">glob</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">joblib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tensorflow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tf</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.dates</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mdates</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.stattools</span><span class="w"> </span><span class="kn">import</span> <span class="n">bds</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.neural_network</span><span class="w"> </span><span class="kn">import</span> <span class="n">MLPRegressor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">PredefinedSplit</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">GridSearchCV</span><span class="p">,</span> <span class="n">GroupKFold</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tsxv.splitTrainValTest</span><span class="w"> </span><span class="kn">import</span> <span class="n">split_train_val_test_groupKFold</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">mean_absolute_percentage_error</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-09-27 23:41:16.532985: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-09-27 23:41:16.636179: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-09-27 23:41:18.399795: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Verificando disponibilidad de GPU...&quot;</span><span class="p">)</span>
<span class="n">gpu_devices</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">list_physical_devices</span><span class="p">(</span><span class="s1">&#39;GPU&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">gpu_devices</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;GPU detectada y configurada por TensorFlow.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ADVERTENCIA: No se detectó GPU. El modelo se entrenará en la CPU.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Verificando disponibilidad de GPU...
GPU detectada y configurada por TensorFlow.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">BASE_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>  <span class="c1"># Esto es la carpeta notebooks</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="base-de-datos">
<h2><strong>Base de datos</strong><a class="headerlink" href="#base-de-datos" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;datamodelos.csv&#39;</span><span class="p">)</span>  <span class="c1"># Ruta al archivo CSV</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_path</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Precio</th>
      <th>RetornoLog</th>
      <th>Volatilidad_7d</th>
      <th>Volatilidad_14d</th>
      <th>Volatilidad_21d</th>
      <th>Volatilidad_28d</th>
    </tr>
    <tr>
      <th>Fecha</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2018-01-29</th>
      <td>11251.00</td>
      <td>-0.054395</td>
      <td>0.690572</td>
      <td>1.522041</td>
      <td>1.371132</td>
      <td>1.367343</td>
    </tr>
    <tr>
      <th>2018-01-30</th>
      <td>10237.51</td>
      <td>-0.094399</td>
      <td>1.005329</td>
      <td>1.143258</td>
      <td>1.410198</td>
      <td>1.351515</td>
    </tr>
    <tr>
      <th>2018-01-31</th>
      <td>10285.10</td>
      <td>0.004638</td>
      <td>0.895483</td>
      <td>1.142321</td>
      <td>1.395937</td>
      <td>1.348702</td>
    </tr>
    <tr>
      <th>2018-02-01</th>
      <td>9224.52</td>
      <td>-0.108831</td>
      <td>1.127962</td>
      <td>1.259500</td>
      <td>1.383471</td>
      <td>1.388793</td>
    </tr>
    <tr>
      <th>2018-02-02</th>
      <td>8873.03</td>
      <td>-0.038849</td>
      <td>1.117298</td>
      <td>1.223554</td>
      <td>1.365130</td>
      <td>1.292856</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2025-02-02</th>
      <td>99796.00</td>
      <td>-0.024038</td>
      <td>0.319643</td>
      <td>0.426355</td>
      <td>0.448729</td>
      <td>0.480990</td>
    </tr>
    <tr>
      <th>2025-02-03</th>
      <td>94495.21</td>
      <td>-0.054579</td>
      <td>0.486452</td>
      <td>0.504795</td>
      <td>0.508193</td>
      <td>0.498576</td>
    </tr>
    <tr>
      <th>2025-02-04</th>
      <td>101367.77</td>
      <td>0.070206</td>
      <td>0.764874</td>
      <td>0.545473</td>
      <td>0.581348</td>
      <td>0.528412</td>
    </tr>
    <tr>
      <th>2025-02-05</th>
      <td>97589.30</td>
      <td>-0.037987</td>
      <td>0.779201</td>
      <td>0.565460</td>
      <td>0.580056</td>
      <td>0.542300</td>
    </tr>
    <tr>
      <th>2025-02-06</th>
      <td>98329.13</td>
      <td>0.007552</td>
      <td>0.776559</td>
      <td>0.567925</td>
      <td>0.580981</td>
      <td>0.532689</td>
    </tr>
  </tbody>
</table>
<p>2566 rows × 6 columns</p>
</div></div></div>
</div>
</section>
<section id="funciones-importantes">
<h2><strong>Funciones importantes</strong><a class="headerlink" href="#funciones-importantes" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Modelado y cálculo de métricas</span>
<span class="k">def</span><span class="w"> </span><span class="nf">modelado</span><span class="p">(</span><span class="n">volatilidad</span><span class="p">,</span> <span class="n">lags_list</span><span class="p">,</span> <span class="n">n_steps_forecast</span><span class="p">,</span> <span class="n">n_steps_jump</span><span class="p">):</span>
    
    <span class="n">results_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s1">&#39;results&#39;</span><span class="p">)</span> <span class="c1"># Carpeta para guardar CSVs de resultados</span>
    <span class="n">model_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="s1">&#39;app&#39;</span><span class="p">,</span> <span class="s1">&#39;modelos_finales&#39;</span><span class="p">)</span> <span class="c1"># Carpeta para guardar modelos</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">results_path</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">model_path</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Diccionario para guardar los DataFrames detallados de cada lag</span>
    <span class="n">dictdetalladolag</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># Lista para guardar los datos del reporte resumen</span>
    <span class="n">reporteresumen</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Lista para guardar los resultados de cada fold</span>
    <span class="n">resultadosfold</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Diccionario maestro donde quedará todo lo necesario para graficar</span>
    <span class="n">dictresultados</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># Diccionario para guardar modelos y scalers de cada combinación lag-fold</span>
    <span class="n">modelos_guardados</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Serie temporal a modelar</span>
    <span class="n">timeSeries</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Volatilidad_</span><span class="si">{</span><span class="n">volatilidad</span><span class="si">}</span><span class="s1">d&#39;</span><span class="p">]</span>
    
    <span class="c1"># Iteración sobre los lags</span>
    <span class="k">for</span> <span class="n">n_steps_input</span> <span class="ow">in</span> <span class="n">lags_list</span><span class="p">:</span>
        
        <span class="c1"># División de datos respeyando temporalidad y grupos</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">Xcv</span><span class="p">,</span> <span class="n">ycv</span><span class="p">,</span> <span class="n">Xtest</span><span class="p">,</span> <span class="n">ytest</span> <span class="o">=</span> <span class="n">split_train_val_test_groupKFold</span><span class="p">(</span>
            <span class="n">timeSeries</span><span class="p">,</span> <span class="n">n_steps_input</span><span class="p">,</span> <span class="n">n_steps_forecast</span><span class="p">,</span> <span class="n">n_steps_jump</span>
        <span class="p">)</span>

        <span class="c1"># Listas para almacenar resultados del lag actual</span>
        <span class="n">mape_folds</span><span class="p">,</span> <span class="n">mae_folds</span><span class="p">,</span> <span class="n">rmse_folds</span><span class="p">,</span> <span class="n">mse_folds</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="n">bds_pvalues_folds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">residuos_fold</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># Listas para almacenar predicciones y reales de todos los folds</span>
        <span class="n">preds_train_folds</span><span class="p">,</span> <span class="n">preds_val_folds</span><span class="p">,</span> <span class="n">preds_test_folds</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="n">real_train_folds</span><span class="p">,</span> <span class="n">real_val_folds</span><span class="p">,</span> <span class="n">real_test_folds</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        
        <span class="c1"># Iteración sobre los folds</span>
        <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)):</span>
            
            <span class="c1"># Se ajusta el scaler SOLO con los datos de entrenamiento del fold</span>
            <span class="n">scaler_x</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">fold</span><span class="p">])</span>
            <span class="n">scaler_y</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">fold</span><span class="p">])</span>
            
            <span class="c1"># Se transforman todos los conjuntos con el scaler ajustado</span>
            <span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler_x</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">fold</span><span class="p">])</span>
            <span class="n">X_val</span> <span class="o">=</span> <span class="n">scaler_x</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">Xcv</span><span class="p">[</span><span class="n">fold</span><span class="p">])</span>
            <span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler_x</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">Xtest</span><span class="p">[</span><span class="n">fold</span><span class="p">])</span>
            
            <span class="n">y_train</span> <span class="o">=</span> <span class="n">scaler_y</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">fold</span><span class="p">])</span>
            <span class="n">y_val</span> <span class="o">=</span> <span class="n">scaler_y</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">ycv</span><span class="p">[</span><span class="n">fold</span><span class="p">])</span> 
            
            <span class="c1"># Modelo MLP multistep</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">MLPRegressor</span><span class="p">(</span><span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span><span class="mi">32</span><span class="p">),</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>  <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">fold</span><span class="p">)</span>
            <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
            
            <span class="c1"># Guardar modelo y scalers temporalmente</span>
            <span class="n">modelos_guardados</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;vol_</span><span class="si">{</span><span class="n">volatilidad</span><span class="si">}</span><span class="s1">_lag_</span><span class="si">{</span><span class="n">n_steps_input</span><span class="si">}</span><span class="s1">_fold_</span><span class="si">{</span><span class="n">fold</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="n">model</span><span class="p">,</span>
                <span class="s1">&#39;scaler_x&#39;</span><span class="p">:</span> <span class="n">scaler_x</span><span class="p">,</span>
                <span class="s1">&#39;scaler_y&#39;</span><span class="p">:</span> <span class="n">scaler_y</span><span class="p">,</span>
                <span class="s1">&#39;n_steps_input&#39;</span><span class="p">:</span> <span class="n">n_steps_input</span><span class="p">,</span>
                <span class="s1">&#39;n_steps_forecast&#39;</span><span class="p">:</span> <span class="n">n_steps_forecast</span><span class="p">,</span>
                <span class="s1">&#39;n_steps_jump&#39;</span><span class="p">:</span> <span class="n">n_steps_jump</span><span class="p">,</span>
                <span class="s1">&#39;volatilidad&#39;</span><span class="p">:</span> <span class="n">volatilidad</span>
            <span class="p">}</span>
                
            <span class="c1">#Predicciones</span>
            <span class="n">preds_train</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
            <span class="n">preds_val</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
            <span class="n">preds_test</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
            
            <span class="c1"># Desnormalización de predicciones</span>
            <span class="n">preds_train_des</span> <span class="o">=</span> <span class="n">scaler_y</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">preds_train</span><span class="p">)</span>
            <span class="n">preds_val_des</span> <span class="o">=</span> <span class="n">scaler_y</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">preds_val</span><span class="p">)</span>
            <span class="n">preds_test_des</span> <span class="o">=</span> <span class="n">scaler_y</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">preds_test</span><span class="p">)</span>
            
            <span class="c1"># Desnormalización de reales</span>
            <span class="n">y_train_des</span> <span class="o">=</span> <span class="n">scaler_y</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
            <span class="n">y_val_des</span> <span class="o">=</span> <span class="n">scaler_y</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_val</span><span class="p">)</span>
            
            <span class="c1"># Test</span>
            <span class="n">y_test_des</span> <span class="o">=</span> <span class="n">ytest</span><span class="p">[</span><span class="n">fold</span><span class="p">]</span>
            
            <span class="c1"># Prueba BDS en residuos del horizonte 1</span>
            <span class="n">residuos_h1</span> <span class="o">=</span> <span class="n">y_test_des</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">preds_test_des</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">bds_pvalue</span> <span class="o">=</span> <span class="n">bds</span><span class="p">(</span><span class="n">residuos_h1</span><span class="p">,</span> <span class="n">max_dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">bds_pvalues_folds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bds_pvalue</span><span class="p">)</span>
            
            <span class="c1"># Lista de residuos por fold</span>
            <span class="n">residuos_fold</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_test_des</span> <span class="o">-</span> <span class="n">preds_test_des</span><span class="p">)</span>
            
            <span class="c1"># Guardar predicciones y reales de todos los folds</span>
            <span class="n">preds_train_folds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">preds_train_des</span><span class="p">)</span>
            <span class="n">preds_val_folds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">preds_val_des</span><span class="p">)</span>
            <span class="n">preds_test_folds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">preds_test_des</span><span class="p">)</span>
            
            <span class="n">real_train_folds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_train_des</span><span class="p">)</span>
            <span class="n">real_val_folds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_val_des</span><span class="p">)</span>
            <span class="n">real_test_folds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_test_des</span><span class="p">)</span>
            
            <span class="c1"># Cálculo de métricas por horizonte</span>
            <span class="n">mape_h</span><span class="p">,</span> <span class="n">mae_h</span><span class="p">,</span> <span class="n">mse_h</span><span class="p">,</span> <span class="n">rmse_h</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
            
            <span class="c1"># Iterar por cada horizonte</span>
            <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps_forecast</span><span class="p">):</span>
                <span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test_des</span><span class="p">[:,</span> <span class="n">h</span><span class="p">]</span>
                <span class="n">y_pred</span> <span class="o">=</span> <span class="n">preds_test_des</span><span class="p">[:,</span> <span class="n">h</span><span class="p">]</span>
                
                <span class="c1"># Evitar división por cero en MAPE. Cálculo de métricas</span>
                <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-8</span>
                <span class="n">mape_h</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">y_true</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">y_true</span> <span class="o">+</span> <span class="n">epsilon</span><span class="p">)))</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
                <span class="n">mae_h</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
                <span class="n">mse_val</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
                <span class="n">mse_h</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mse_val</span><span class="p">)</span>
                <span class="n">rmse_h</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse_val</span><span class="p">))</span>
                
            <span class="c1"># Guardar métricas del fold actual</span>
            <span class="n">mape_folds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mape_h</span><span class="p">)</span>
            <span class="n">mae_folds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mae_h</span><span class="p">)</span>
            <span class="n">mse_folds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mse_h</span><span class="p">)</span>
            <span class="n">rmse_folds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse_h</span><span class="p">)</span>
            
            <span class="c1"># Guardar predicciones y reales del fold actual</span>
            <span class="n">dictdetalladolag</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;lag_</span><span class="si">{</span><span class="n">n_steps_input</span><span class="si">}</span><span class="s1">_predicciones&#39;</span><span class="p">,</span> <span class="p">{})[</span><span class="sa">f</span><span class="s1">&#39;fold_</span><span class="si">{</span><span class="n">fold</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;y_test_real&quot;</span><span class="p">:</span> <span class="n">y_test_des</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="s2">&quot;y_pred_test&quot;</span><span class="p">:</span> <span class="n">preds_test_des</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="p">}</span>

            <span class="c1"># Guardar métricas promedio del fold (sobre horizontes)</span>
            <span class="n">resultadosfold</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s2">&quot;Lag&quot;</span><span class="p">:</span> <span class="n">n_steps_input</span><span class="p">,</span>
                <span class="s2">&quot;Fold&quot;</span><span class="p">:</span> <span class="n">fold</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s2">&quot;MAPE&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mape_h</span><span class="p">),</span>
                <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mae_h</span><span class="p">),</span>
                <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rmse_h</span><span class="p">),</span>
                <span class="s2">&quot;MSE&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mse_h</span><span class="p">),</span>
                <span class="s2">&quot;BDS_pvalue&quot;</span><span class="p">:</span> <span class="n">bds_pvalue</span>
            <span class="p">})</span>  

        <span class="c1"># Reportes detallados por lag </span>
        <span class="k">if</span> <span class="n">mape_folds</span><span class="p">:</span> <span class="c1"># Verificar que no esté vacío</span>
            <span class="n">horizontes</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;H</span><span class="si">{</span><span class="n">h</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps_forecast</span><span class="p">)]</span>
            <span class="n">metricas</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;MAPE&#39;</span><span class="p">,</span> <span class="s1">&#39;MAE&#39;</span><span class="p">,</span> <span class="s1">&#39;RMSE&#39;</span><span class="p">,</span> <span class="s1">&#39;MSE&#39;</span><span class="p">]</span>
        
            <span class="c1"># Crear MultiIndex para las columnas</span>
            <span class="n">multi_cols</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([</span><span class="n">horizontes</span><span class="p">,</span> <span class="n">metricas</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Horizonte&#39;</span><span class="p">,</span> <span class="s1">&#39;Métrica&#39;</span><span class="p">])</span>
        
            <span class="c1"># Organizar los datos para el DataFrame</span>
            <span class="n">datatabla</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)):</span> <span class="c1"># Iterar por cada fold</span>
                <span class="n">fila</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps_forecast</span><span class="p">):</span> <span class="c1"># Iterar por cada horizonte</span>
                    <span class="n">fila</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mape_folds</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
                    <span class="n">fila</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mae_folds</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
                    <span class="n">fila</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse_folds</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
                    <span class="n">fila</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mse_folds</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
                <span class="n">datatabla</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fila</span><span class="p">)</span>

            <span class="c1"># DataFrame con métricas</span>
            <span class="n">df_metricas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">datatabla</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">multi_cols</span><span class="p">)</span>
            <span class="n">df_metricas</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Fold </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">))]</span>
            
            <span class="c1"># DataFrame con BDS como primera columna</span>
            <span class="n">df_bds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
                <span class="s1">&#39;BDS_pvalue_H1&#39;</span><span class="p">:</span> <span class="n">bds_pvalues_folds</span>
            <span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">df_metricas</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            
            <span class="c1"># Unión de ambos DataFrames</span>
            <span class="n">datacompleta</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_bds</span><span class="p">,</span> <span class="n">df_metricas</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            
            <span class="c1"># Calcular Mean ± Std para cada columna (horizonte-métrica)</span>
            <span class="n">mean_row</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">datacompleta</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>  <span class="c1"># Para columnas MultiIndex</span>
                    <span class="n">col_data</span> <span class="o">=</span> <span class="n">datacompleta</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># Para columna BDS</span>
                    <span class="n">col_data</span> <span class="o">=</span> <span class="n">datacompleta</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                
                <span class="n">mean_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">col_data</span><span class="p">)</span>
                <span class="n">std_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">col_data</span><span class="p">)</span>
                
                <span class="k">if</span> <span class="n">col</span> <span class="o">==</span> <span class="s1">&#39;BDS_pvalue_H1&#39;</span><span class="p">:</span>
                    <span class="n">mean_row</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mean_val</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> ± </span><span class="si">{</span><span class="n">std_val</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">mean_row</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mean_val</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> ± </span><span class="si">{</span><span class="n">std_val</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span>
            
            <span class="c1"># Agregar fila Mean ± Std al final del DataFrame</span>
            <span class="n">df_mean_std</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">mean_row</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Mean ± Std&#39;</span><span class="p">])</span>
            <span class="n">datacompleta</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">datacompleta</span><span class="p">,</span> <span class="n">df_mean_std</span><span class="p">])</span>
            
            <span class="c1"># Guardar DataFrame detallado en el diccionario</span>
            <span class="n">dictdetalladolag</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;lag_</span><span class="si">{</span><span class="n">n_steps_input</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datacompleta</span>

            <span class="c1"># Reporte resumen promedio por lag (promedio sobre folds y horizontes)</span>
            <span class="n">resumenfila</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;Lag&#39;</span><span class="p">:</span> <span class="n">n_steps_input</span><span class="p">,</span>
                <span class="s1">&#39;MAPE_Promedio&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mape_folds</span><span class="p">),</span>
                <span class="s1">&#39;MAE_Promedio&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mae_folds</span><span class="p">),</span>
                <span class="s1">&#39;RMSE_Promedio&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rmse_folds</span><span class="p">),</span>
                <span class="s1">&#39;MSE_Promedio&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mse_folds</span><span class="p">),</span>
                <span class="s1">&#39;BDS_pvalue_Promedio&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bds_pvalues_folds</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="n">reporteresumen</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resumenfila</span><span class="p">)</span>

            <span class="c1"># Diccionario maestro de resultados</span>
            <span class="n">dictresultados</span><span class="p">[</span><span class="n">n_steps_input</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;reals&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">real_train_folds</span><span class="p">,</span> 
                    <span class="s2">&quot;val&quot;</span><span class="p">:</span> <span class="n">real_val_folds</span><span class="p">,</span> 
                    <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="n">real_test_folds</span>
                <span class="p">},</span>
                <span class="s2">&quot;preds&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">preds_train_folds</span><span class="p">,</span>
                    <span class="s2">&quot;val&quot;</span><span class="p">:</span> <span class="n">preds_val_folds</span><span class="p">,</span>
                    <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="n">preds_test_folds</span>
                <span class="p">},</span>
                <span class="s2">&quot;original_df&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
                <span class="s2">&quot;bds_pvalues&quot;</span><span class="p">:</span> <span class="n">bds_pvalues_folds</span><span class="p">,</span>
                <span class="s2">&quot;residuos&quot;</span><span class="p">:</span> <span class="n">residuos_fold</span>
            <span class="p">}</span>
    
    <span class="c1"># DataFrame resumen final</span>
    <span class="n">dataresumen</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">reporteresumen</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Lag&#39;</span><span class="p">)</span>    

    <span class="c1"># Guardar resultados en CSVs en la carpeta results</span>
    <span class="k">for</span> <span class="n">lag</span><span class="p">,</span> <span class="n">df_report</span> <span class="ow">in</span> <span class="n">dictdetalladolag</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df_report</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="c1"># Guardar cada DataFrame detallado por lag</span>
            <span class="n">df_report</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">results_path</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;vol</span><span class="si">{</span><span class="n">volatilidad</span><span class="si">}</span><span class="s1">d_reporte_detallado_</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s1">.csv&#39;</span><span class="p">))</span>
    
    <span class="c1"># Guardar el reporte resumen final de cada volatilidad</span>
    <span class="n">dataresumen</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">results_path</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;vol</span><span class="si">{</span><span class="n">volatilidad</span><span class="si">}</span><span class="s1">_reporte_resumen_promedio.csv&#39;</span><span class="p">))</span>
    
    <span class="c1"># Análisis para identificar el mejor modelo y guardarlo</span>
    <span class="c1"># Identificar el mejor lag basado en el menor RMSE promedio</span>
    <span class="n">mejor_lag</span> <span class="o">=</span> <span class="n">dataresumen</span><span class="p">[</span><span class="s1">&#39;RMSE_Promedio&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
    <span class="n">mejor_lag_rmse</span> <span class="o">=</span> <span class="n">dataresumen</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mejor_lag</span><span class="p">,</span> <span class="s1">&#39;RMSE_Promedio&#39;</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> El mejor modelo para la volatilidad de </span><span class="si">{</span><span class="n">volatilidad</span><span class="si">}</span><span class="s2"> días está en el lag de </span><span class="si">{</span><span class="n">mejor_lag</span><span class="si">}</span><span class="s2"> días. (RMSE promedio: </span><span class="si">{</span><span class="n">mejor_lag_rmse</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    
    <span class="c1"># Mejor fold dentro del mejor lag</span>
    <span class="n">df_folds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultadosfold</span><span class="p">)</span>
    <span class="n">folds_mejor_lag</span> <span class="o">=</span> <span class="n">df_folds</span><span class="p">[</span><span class="n">df_folds</span><span class="p">[</span><span class="s1">&#39;Lag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">mejor_lag</span><span class="p">]</span>
    <span class="n">idx_mejor_fold</span> <span class="o">=</span> <span class="n">folds_mejor_lag</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
    <span class="n">mejor_fold_info</span> <span class="o">=</span> <span class="n">folds_mejor_lag</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx_mejor_fold</span><span class="p">]</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Dentro del lag </span><span class="si">{</span><span class="n">mejor_lag</span><span class="si">}</span><span class="s2">, el mejor fold es el Fold </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">mejor_fold_info</span><span class="p">[</span><span class="s1">&#39;Fold&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2"> con RMSE: </span><span class="si">{</span><span class="n">mejor_fold_info</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Guardar la información del mejor fold</span>
    <span class="n">key_mejor_modelo</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;vol_</span><span class="si">{</span><span class="n">volatilidad</span><span class="si">}</span><span class="s1">_lag_</span><span class="si">{</span><span class="n">mejor_lag</span><span class="si">}</span><span class="s1">_fold_</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">mejor_fold_info</span><span class="p">[</span><span class="s2">&quot;Fold&quot;</span><span class="p">])</span><span class="si">}</span><span class="s1">&#39;</span>  
    <span class="n">mejor_modelo_data</span> <span class="o">=</span> <span class="n">modelos_guardados</span><span class="p">[</span><span class="n">key_mejor_modelo</span><span class="p">]</span>

    <span class="c1"># Diccionario con todo lo necesario para la API</span>
    <span class="n">modelo_para_api</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;modelo&#39;</span><span class="p">:</span> <span class="n">mejor_modelo_data</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">],</span>
        <span class="s1">&#39;scaler_x&#39;</span><span class="p">:</span> <span class="n">mejor_modelo_data</span><span class="p">[</span><span class="s1">&#39;scaler_x&#39;</span><span class="p">],</span>
        <span class="s1">&#39;scaler_y&#39;</span><span class="p">:</span> <span class="n">mejor_modelo_data</span><span class="p">[</span><span class="s1">&#39;scaler_y&#39;</span><span class="p">],</span>
        <span class="s1">&#39;parametros&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;volatilidad&#39;</span><span class="p">:</span> <span class="n">volatilidad</span><span class="p">,</span>
            <span class="s1">&#39;lag&#39;</span><span class="p">:</span> <span class="n">mejor_lag</span><span class="p">,</span>
            <span class="s1">&#39;fold&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">mejor_fold_info</span><span class="p">[</span><span class="s1">&#39;Fold&#39;</span><span class="p">]),</span>
            <span class="s1">&#39;n_steps_input&#39;</span><span class="p">:</span> <span class="n">mejor_modelo_data</span><span class="p">[</span><span class="s1">&#39;n_steps_input&#39;</span><span class="p">],</span>
            <span class="s1">&#39;n_steps_forecast&#39;</span><span class="p">:</span> <span class="n">mejor_modelo_data</span><span class="p">[</span><span class="s1">&#39;n_steps_forecast&#39;</span><span class="p">],</span>
            <span class="s1">&#39;n_steps_jump&#39;</span><span class="p">:</span> <span class="n">mejor_modelo_data</span><span class="p">[</span><span class="s1">&#39;n_steps_jump&#39;</span><span class="p">]</span>
        <span class="p">},</span>
        <span class="s1">&#39;metricas&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">mejor_fold_info</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">],</span>
            <span class="s1">&#39;MAE&#39;</span><span class="p">:</span> <span class="n">mejor_fold_info</span><span class="p">[</span><span class="s1">&#39;MAE&#39;</span><span class="p">],</span>
            <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mejor_fold_info</span><span class="p">[</span><span class="s1">&#39;MAPE&#39;</span><span class="p">],</span>
            <span class="s1">&#39;MSE&#39;</span><span class="p">:</span> <span class="n">mejor_fold_info</span><span class="p">[</span><span class="s1">&#39;MSE&#39;</span><span class="p">],</span>
            <span class="s1">&#39;BDS_pvalue&#39;</span><span class="p">:</span> <span class="n">mejor_fold_info</span><span class="p">[</span><span class="s1">&#39;BDS_pvalue&#39;</span><span class="p">]</span>
        <span class="p">},</span>
        <span class="s1">&#39;residuos_mejor_fold&#39;</span> <span class="p">:</span> <span class="n">dictresultados</span><span class="p">[</span><span class="n">mejor_lag</span><span class="p">][</span><span class="s1">&#39;residuos&#39;</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="n">mejor_fold_info</span><span class="p">[</span><span class="s1">&#39;Fold&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="c1"># Guardar el mejor modelo con joblib en la carpeta modelos_finales</span>
    <span class="n">modelo_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">model_path</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;mejor_modelo_vol</span><span class="si">{</span><span class="n">volatilidad</span><span class="si">}</span><span class="s1">d.joblib&#39;</span><span class="p">)</span>
    <span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">modelo_para_api</span><span class="p">,</span> <span class="n">modelo_filename</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;reportes_detallados&#39;</span><span class="p">:</span> <span class="n">dictdetalladolag</span><span class="p">,</span>
        <span class="s1">&#39;reporte_resumen&#39;</span><span class="p">:</span> <span class="n">dataresumen</span><span class="p">,</span>
        <span class="s1">&#39;results_all&#39;</span><span class="p">:</span> <span class="n">dictresultados</span><span class="p">,</span>  
        <span class="s1">&#39;reporte_folds&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultadosfold</span><span class="p">),</span>
        <span class="s1">&#39;mejor_modelo&#39;</span><span class="p">:</span> <span class="n">modelo_para_api</span>
    <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Gráficos de real vs predicho</span>
<span class="k">def</span><span class="w"> </span><span class="nf">graficos</span><span class="p">(</span><span class="n">lags_list</span><span class="p">,</span> <span class="n">results_all</span><span class="p">,</span> <span class="n">results_df</span><span class="p">,</span> <span class="n">n_steps_forecast</span><span class="p">,</span> <span class="n">n_steps_jump</span><span class="p">,</span> <span class="n">volatilidad</span><span class="p">):</span>
   
    <span class="c1"># Carpeta para guardar las imágenes</span>
    <span class="n">figs_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;figs/volatilidad_</span><span class="si">{</span><span class="n">volatilidad</span><span class="si">}</span><span class="s1">d&#39;</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">figs_path</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># Función para graficar predicciones vs reales por fold y horizonte</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">prediccionesfold</span><span class="p">(</span><span class="n">fold_idx</span><span class="p">,</span> <span class="n">fold_name</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">lag_seleccionado</span><span class="p">,</span>
                         <span class="n">n_steps_forecast</span><span class="p">,</span> <span class="n">n_steps_jump</span><span class="p">,</span> <span class="n">horizon_to_plot</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        
        <span class="c1"># Datos reales</span>
        <span class="n">real_train</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;reals&#39;</span><span class="p">][</span><span class="s1">&#39;train&#39;</span><span class="p">][</span><span class="n">fold_idx</span><span class="p">][:,</span> <span class="n">horizon_to_plot</span><span class="p">]</span>
        <span class="n">real_val</span>   <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;reals&#39;</span><span class="p">][</span><span class="s1">&#39;val&#39;</span><span class="p">][</span><span class="n">fold_idx</span><span class="p">][:,</span> <span class="n">horizon_to_plot</span><span class="p">]</span>
        <span class="n">real_test</span>  <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;reals&#39;</span><span class="p">][</span><span class="s1">&#39;test&#39;</span><span class="p">][</span><span class="n">fold_idx</span><span class="p">][:,</span> <span class="n">horizon_to_plot</span><span class="p">]</span>

        <span class="c1"># Datos predichos</span>
        <span class="n">preds_train</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;preds&#39;</span><span class="p">][</span><span class="s1">&#39;train&#39;</span><span class="p">][</span><span class="n">fold_idx</span><span class="p">][:,</span> <span class="n">horizon_to_plot</span><span class="p">]</span>
        <span class="n">preds_val</span>   <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;preds&#39;</span><span class="p">][</span><span class="s1">&#39;val&#39;</span><span class="p">][</span><span class="n">fold_idx</span><span class="p">][:,</span> <span class="n">horizon_to_plot</span><span class="p">]</span>
        <span class="n">preds_test</span>  <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;preds&#39;</span><span class="p">][</span><span class="s1">&#39;test&#39;</span><span class="p">][</span><span class="n">fold_idx</span><span class="p">][:,</span> <span class="n">horizon_to_plot</span><span class="p">]</span>
        
        <span class="c1"># Datos del DataFrame original para índices temporales</span>
        <span class="n">original_df</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;original_df&#39;</span><span class="p">]</span>
        <span class="n">n_splits</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;reals&#39;</span><span class="p">][</span><span class="s1">&#39;train&#39;</span><span class="p">])</span>
        <span class="n">n_test</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">real_test</span><span class="p">)</span>
        <span class="n">n_val</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">real_val</span><span class="p">)</span>
        
        <span class="c1"># Construcción de índices temporales</span>
        <span class="n">test_start_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">original_df</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">n_splits</span> <span class="o">-</span> <span class="n">fold_idx</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_test</span> <span class="o">*</span> <span class="n">n_steps_jump</span><span class="p">)</span>
        <span class="n">val_start_idx</span> <span class="o">=</span> <span class="n">test_start_idx</span> <span class="o">-</span> <span class="n">n_val</span>
        <span class="n">train_end_idx</span> <span class="o">=</span> <span class="n">val_start_idx</span>
        <span class="n">train_start_idx</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">train_end_idx</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">real_train</span><span class="p">))</span>
        
        <span class="c1"># Índices temporales para cada conjunto conversión a datetime</span>
        <span class="n">train_timestamps</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">original_df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">train_start_idx</span><span class="p">:</span><span class="n">train_end_idx</span><span class="p">])</span>
        <span class="n">val_timestamps</span>   <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">original_df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">val_start_idx</span><span class="p">:</span><span class="n">test_start_idx</span><span class="p">])</span>
        <span class="n">test_timestamps</span>  <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">original_df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">test_start_idx</span><span class="p">:</span><span class="n">test_start_idx</span> <span class="o">+</span> <span class="n">n_test</span><span class="p">])</span>

        <span class="c1"># Cálculo de RMSE para título (train y test)</span>
        <span class="n">rmse_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span>
            <span class="n">real_train</span><span class="p">[</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">train_timestamps</span><span class="p">):],</span>
            <span class="n">preds_train</span><span class="p">[</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">train_timestamps</span><span class="p">):]</span>
        <span class="p">))</span>
        <span class="n">rmse_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">real_test</span><span class="p">,</span> <span class="n">preds_test</span><span class="p">))</span>

        <span class="c1"># Gráfica de serie temporal de real vs predicho</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">fold_name</span><span class="si">}</span><span class="s2"> - Ventana de </span><span class="si">{</span><span class="n">lag_seleccionado</span><span class="si">}</span><span class="s2"> días - Horizonte = </span><span class="si">{</span><span class="n">horizon_to_plot</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;RMSE Train=</span><span class="si">{</span><span class="n">rmse_train</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> vs RMSE Test=</span><span class="si">{</span><span class="n">rmse_test</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                     <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

        <span class="c1"># Train</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">train_timestamps</span><span class="p">,</span> <span class="n">real_train</span><span class="p">[</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">train_timestamps</span><span class="p">):],</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Train Actual&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#48cae4&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">train_timestamps</span><span class="p">,</span> <span class="n">preds_train</span><span class="p">[</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">train_timestamps</span><span class="p">):],</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Train Predicho&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#023047&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

        <span class="c1"># Validación</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">val_timestamps</span><span class="p">,</span> <span class="n">real_val</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Validación Actual&#39;</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#e9d8a6&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">val_timestamps</span><span class="p">,</span> <span class="n">preds_val</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Validación Predicha&#39;</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#eb5e28&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
        
        <span class="c1"># Test</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_timestamps</span><span class="p">,</span> <span class="n">real_test</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Test Actual&#39;</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#ff7e6b&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_timestamps</span><span class="p">,</span> <span class="n">preds_test</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Test Predicho&#39;</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#9d0208&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        
        <span class="c1"># Formateo del eje x según el rango de fechas</span>
        <span class="n">all_dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
            <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">train_timestamps</span><span class="p">),</span>
            <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">val_timestamps</span><span class="p">),</span>
            <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">test_timestamps</span><span class="p">)</span>
        <span class="p">])</span>
        <span class="n">date_range_days</span> <span class="o">=</span> <span class="p">(</span><span class="n">all_dates</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">all_dates</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="o">.</span><span class="n">days</span>
        
        <span class="c1"># Ajustar el localizador según el rango de fechas</span>
        <span class="k">if</span> <span class="n">date_range_days</span> <span class="o">&lt;=</span> <span class="mi">30</span><span class="p">:</span>  <span class="c1"># Menos de un mes</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DayLocator</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/%m&#39;</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">date_range_days</span> <span class="o">&lt;=</span> <span class="mi">180</span><span class="p">:</span>  <span class="c1"># Menos de 6 meses</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">MonthLocator</span><span class="p">())</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%b %Y&#39;</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">date_range_days</span> <span class="o">&lt;=</span> <span class="mi">730</span><span class="p">:</span>  <span class="c1"># Menos de 2 años</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">MonthLocator</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%b %Y&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Más de 2 años</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">MonthLocator</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%b %Y&#39;</span><span class="p">))</span>
        
        <span class="c1"># Rotar etiquetas</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_majorticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
        
        <span class="c1"># Líneas verticales para separar conjuntos</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_timestamps</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">train_timestamps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;_nolegend_&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">val_timestamps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;_nolegend_&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
        
        <span class="c1"># Ajustar layout</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        
        <span class="c1"># Guardar la imagen en la carpeta de figs </span>
        <span class="n">safe_fold_name</span> <span class="o">=</span> <span class="n">fold_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;vol</span><span class="si">{</span><span class="n">volatilidad</span><span class="si">}</span><span class="s1">d_prediccion_</span><span class="si">{</span><span class="n">safe_fold_name</span><span class="si">}</span><span class="s1">_lag</span><span class="si">{</span><span class="n">lag_seleccionado</span><span class="si">}</span><span class="s1">_h</span><span class="si">{</span><span class="n">horizon_to_plot</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">.png&#39;</span>
        <span class="n">full_path_to_save</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">figs_path</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">full_path_to_save</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Seleccionar el lag con mejor RMSE promedio</span>
    <span class="n">lag_seleccionado</span> <span class="o">=</span> <span class="n">lags_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">results_all</span><span class="p">[</span><span class="n">lag_seleccionado</span><span class="p">]</span>

    <span class="c1"># Identificar los folds mejor, peor y mediano basado en RMSE promedio</span>
    <span class="n">mean_rmse_per_fold</span> <span class="o">=</span> <span class="n">results_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Fold&#39;</span><span class="p">)[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
    <span class="n">best_fold_idx</span>   <span class="o">=</span> <span class="n">mean_rmse_per_fold</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">worst_fold_idx</span>  <span class="o">=</span> <span class="n">mean_rmse_per_fold</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">median_fold_idx</span> <span class="o">=</span> <span class="n">mean_rmse_per_fold</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">mean_rmse_per_fold</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="c1"># Diccionario con los folds a graficar</span>
    <span class="n">folds_to_plot</span> <span class="o">=</span> <span class="p">{</span>
        <span class="sa">f</span><span class="s1">&#39;Mejor Fold (Fold </span><span class="si">{</span><span class="n">best_fold_idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">:</span> <span class="n">best_fold_idx</span><span class="p">,</span>
        <span class="sa">f</span><span class="s1">&#39;Fold Mediano (Fold </span><span class="si">{</span><span class="n">median_fold_idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">:</span> <span class="n">median_fold_idx</span><span class="p">,</span>
        <span class="sa">f</span><span class="s1">&#39;Peor Fold (Fold </span><span class="si">{</span><span class="n">worst_fold_idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">:</span> <span class="n">worst_fold_idx</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="c1"># Graficar y guardar imágenes por fold y horizonte</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">folds_to_plot</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps_forecast</span><span class="p">):</span>   <span class="c1"># loop para graficar todos los horizontes</span>
            <span class="n">prediccionesfold</span><span class="p">(</span>
                <span class="n">fold_idx</span><span class="o">=</span><span class="n">idx</span><span class="p">,</span>
                <span class="n">fold_name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span>
                <span class="n">lag_seleccionado</span><span class="o">=</span><span class="n">lag_seleccionado</span><span class="p">,</span>
                <span class="n">n_steps_forecast</span><span class="o">=</span><span class="n">n_steps_forecast</span><span class="p">,</span>
                <span class="n">n_steps_jump</span><span class="o">=</span><span class="n">n_steps_jump</span><span class="p">,</span>
                <span class="n">horizon_to_plot</span><span class="o">=</span><span class="n">h</span>
            <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Transformación de DataFrame detallado para gráficos de RMSE por horizonte</span>
<span class="k">def</span><span class="w"> </span><span class="nf">rmsehorizonte</span><span class="p">(</span><span class="n">df_detallado</span><span class="p">,</span> <span class="n">n_steps_forecast</span><span class="p">):</span>
    
    <span class="c1"># Lista para almacenar los datos transformados</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="c1"># Excluir la fila &#39;Mean ± Std&#39;</span>
    <span class="n">datanoprom</span> <span class="o">=</span> <span class="n">df_detallado</span><span class="p">[</span><span class="n">df_detallado</span><span class="o">.</span><span class="n">index</span> <span class="o">!=</span> <span class="s1">&#39;Mean ± Std&#39;</span><span class="p">]</span>
    
    <span class="c1"># Iterar por cada fold y cada horizonte</span>
    <span class="k">for</span> <span class="n">fold_name</span> <span class="ow">in</span> <span class="n">datanoprom</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
        <span class="n">fold_num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fold_name</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        
        <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_steps_forecast</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="c1"># La columna es una tupla</span>
            <span class="n">col_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s1">&#39;H</span><span class="si">{</span><span class="n">h</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;RMSE&#39;</span><span class="p">)</span>
            
            <span class="c1"># Acceder directamente usando la tupla como clave</span>
            <span class="n">rmse_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">datanoprom</span><span class="p">[</span><span class="n">col_tuple</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">fold_name</span><span class="p">])</span>
            
            <span class="c1"># Agregar a la lista</span>
            <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;Fold&#39;</span><span class="p">:</span> <span class="n">fold_num</span><span class="p">,</span>
                <span class="s1">&#39;Horizonte&#39;</span><span class="p">:</span> <span class="n">h</span><span class="p">,</span>
                <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse_value</span>
            <span class="p">})</span>
    
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Gráficos de análisis de RMSE</span>
<span class="k">def</span><span class="w"> </span><span class="nf">rmsegraficos</span><span class="p">(</span><span class="n">results_df</span><span class="p">,</span> <span class="n">nombre_experimento</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
    
    <span class="c1"># Carpeta para guardar las imágenes</span>
    <span class="n">figs_path</span> <span class="o">=</span> <span class="s1">&#39;figs&#39;</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">figs_path</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>

    <span class="c1"># Crear figura con dos subplots</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="c1"># Título general</span>
    <span class="n">titulo_figura</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Análisis de RMSE para </span><span class="si">{</span><span class="n">nombre_experimento</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="n">nombre_experimento</span> <span class="k">else</span> <span class="s1">&#39;Análisis de RMSE&#39;</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">titulo_figura</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

    <span class="c1"># Gráfico 1: RMSE promedio por Fold - Diagrama de barras</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">results_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Fold&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;RMSE&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">errorbar</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#0096c7&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;RMSE Promedio por Fold&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Fold&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;RMSE Promedio&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ax1</span><span class="o">.</span><span class="n">patches</span><span class="p">:</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">p</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                     <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">p</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">get_height</span><span class="p">()),</span>
                     <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
                     <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    
    <span class="c1"># Gráfico 2: RMSE promedio por Horizonte - Línea con puntos</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">results_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Horizonte&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;RMSE&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">errorbar</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#0096c7&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;RMSE Promedio por Horizonte de Predicción&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Horizonte (pasos de tiempo)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;RMSE Promedio&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;Horizonte&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.96</span><span class="p">])</span>
    
    <span class="c1"># Guardar la imagen en la carpeta figs</span>
    <span class="n">safe_name</span> <span class="o">=</span> <span class="n">nombre_experimento</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">nombre_experimento</span> <span class="k">else</span> <span class="s1">&#39;default&#39;</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;analisis_rmse_</span><span class="si">{</span><span class="n">safe_name</span><span class="si">}</span><span class="s1">.png&#39;</span>
    <span class="n">full_path_to_save</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">figs_path</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">full_path_to_save</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="n">rmse_fold</span> <span class="o">=</span> <span class="n">results_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Fold&quot;</span><span class="p">)[</span><span class="s2">&quot;RMSE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">rmse_horizonte</span> <span class="o">=</span> <span class="n">results_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Horizonte&quot;</span><span class="p">)[</span><span class="s2">&quot;RMSE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">rmse_fold</span><span class="p">,</span> <span class="n">rmse_horizonte</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Función principal para mostrar resultados de una ventana de volatilidad</span>
<span class="k">def</span><span class="w"> </span><span class="nf">resultadosventana</span><span class="p">(</span><span class="n">volatilidad</span><span class="p">,</span> <span class="n">lags_list</span><span class="p">,</span> <span class="n">n_steps_forecast</span><span class="p">,</span> <span class="n">n_steps_jump</span><span class="p">):</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Resultados para la ventana de volatilidad de&quot;</span><span class="p">,</span> <span class="n">volatilidad</span><span class="p">,</span> <span class="s2">&quot;días&quot;</span><span class="p">)</span>
    
    <span class="c1"># Llamar a la función de modelado</span>
    <span class="n">resultados</span> <span class="o">=</span> <span class="n">modelado</span><span class="p">(</span><span class="n">volatilidad</span><span class="p">,</span> <span class="n">lags_list</span><span class="p">,</span> <span class="n">n_steps_forecast</span><span class="p">,</span> <span class="n">n_steps_jump</span><span class="p">)</span>
    
    <span class="c1"># Iterar por cada lag</span>
    <span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="n">lags_list</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Análisis para el lag de&quot;</span><span class="p">,</span> <span class="n">lag</span><span class="p">,</span> <span class="s2">&quot;días&quot;</span><span class="p">)</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Métricas detalladas</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        
        <span class="c1"># Mostrar reporte detallado del lag</span>
        <span class="n">lag_key</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;lag_</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">lag_key</span> <span class="ow">in</span> <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;reportes_detallados&#39;</span><span class="p">]:</span>
            <span class="n">display</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;reportes_detallados&#39;</span><span class="p">][</span><span class="n">lag_key</span><span class="p">])</span>
        
        <span class="c1"># Filtrar results_df para el lag actual</span>
        <span class="n">results_df_lag</span> <span class="o">=</span> <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;reporte_folds&#39;</span><span class="p">][</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;reporte_folds&#39;</span><span class="p">][</span><span class="s1">&#39;Lag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">lag</span><span class="p">]</span>
        
        <span class="c1"># Llamar a la función de gráficos solo para este lag</span>
        <span class="n">graficos</span><span class="p">(</span>
            <span class="n">lags_list</span><span class="o">=</span><span class="p">[</span><span class="n">lag</span><span class="p">],</span>
            <span class="n">results_all</span><span class="o">=</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;results_all&#39;</span><span class="p">],</span>
            <span class="n">results_df</span><span class="o">=</span><span class="n">results_df_lag</span><span class="p">,</span>
            <span class="n">n_steps_forecast</span><span class="o">=</span><span class="n">n_steps_forecast</span><span class="p">,</span>
            <span class="n">n_steps_jump</span><span class="o">=</span><span class="n">n_steps_jump</span><span class="p">,</span>
            <span class="n">volatilidad</span><span class="o">=</span><span class="n">volatilidad</span>
        <span class="p">)</span>
        
        <span class="c1"># Análisis RMSE para este lag</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Análisis de RMSE para Lag </span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
        <span class="n">df_detallado</span> <span class="o">=</span> <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;reportes_detallados&#39;</span><span class="p">][</span><span class="sa">f</span><span class="s1">&#39;lag_</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>
        <span class="n">results_df_lag</span> <span class="o">=</span> <span class="n">rmsehorizonte</span><span class="p">(</span><span class="n">df_detallado</span><span class="p">,</span> <span class="n">n_steps_forecast</span><span class="p">)</span>  
            
        <span class="n">rmse_fold</span><span class="p">,</span> <span class="n">rmse_horizonte</span> <span class="o">=</span> <span class="n">rmsegraficos</span><span class="p">(</span>
            <span class="n">results_df_lag</span><span class="p">,</span> 
            <span class="n">nombre_experimento</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Volatilidad </span><span class="si">{</span><span class="n">volatilidad</span><span class="si">}</span><span class="s2">d - Lag </span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Resumen final para la volatilidad de </span><span class="si">{</span><span class="n">volatilidad</span><span class="si">}</span><span class="s2"> días:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Comparación de todos los lags:&quot;</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;reporte_resumen&#39;</span><span class="p">])</span>
    
    <span class="k">return</span> <span class="n">resultados</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="modelos-de-prediccion-por-volatilidad">
<h2><strong>Modelos de predicción por volatilidad</strong><a class="headerlink" href="#modelos-de-prediccion-por-volatilidad" title="Link to this heading">#</a></h2>
<section id="volatilidad-de-la-ventana-de-7-dias">
<h3><strong>Volatilidad de la ventana de 7 días</strong><a class="headerlink" href="#volatilidad-de-la-ventana-de-7-dias" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Para volatilidad de 7 días</span>
<span class="n">resultados_7d</span> <span class="o">=</span> <span class="n">resultadosventana</span><span class="p">(</span>
    <span class="n">volatilidad</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
    <span class="n">lags_list</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">28</span><span class="p">],</span>
    <span class="n">n_steps_forecast</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
    <span class="n">n_steps_jump</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados para la ventana de volatilidad de 7 días

 El mejor modelo para la volatilidad de 7 días está en el lag de 7 días. (RMSE promedio: 0.2531)

Dentro del lag 7, el mejor fold es el Fold 1 con RMSE: 0.2083

Análisis para el lag de 7 días

 Métricas detalladas
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BDS_pvalue_H1</th>
      <th>(H1, MAPE)</th>
      <th>(H1, MAE)</th>
      <th>(H1, RMSE)</th>
      <th>(H1, MSE)</th>
      <th>(H2, MAPE)</th>
      <th>(H2, MAE)</th>
      <th>(H2, RMSE)</th>
      <th>(H2, MSE)</th>
      <th>(H3, MAPE)</th>
      <th>...</th>
      <th>(H5, RMSE)</th>
      <th>(H5, MSE)</th>
      <th>(H6, MAPE)</th>
      <th>(H6, MAE)</th>
      <th>(H6, RMSE)</th>
      <th>(H6, MSE)</th>
      <th>(H7, MAPE)</th>
      <th>(H7, MAE)</th>
      <th>(H7, RMSE)</th>
      <th>(H7, MSE)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Fold 1</th>
      <td>0.3573422471776194</td>
      <td>15.238803</td>
      <td>0.074771</td>
      <td>0.10365</td>
      <td>0.010743</td>
      <td>20.777234</td>
      <td>0.107749</td>
      <td>0.151557</td>
      <td>0.022969</td>
      <td>29.595715</td>
      <td>...</td>
      <td>0.234965</td>
      <td>0.055209</td>
      <td>51.363471</td>
      <td>0.214299</td>
      <td>0.266845</td>
      <td>0.071206</td>
      <td>51.854651</td>
      <td>0.206969</td>
      <td>0.267076</td>
      <td>0.07133</td>
    </tr>
    <tr>
      <th>Fold 2</th>
      <td>0.8723641689240013</td>
      <td>22.53021</td>
      <td>0.091687</td>
      <td>0.13942</td>
      <td>0.019438</td>
      <td>23.411413</td>
      <td>0.10522</td>
      <td>0.144791</td>
      <td>0.020965</td>
      <td>29.14856</td>
      <td>...</td>
      <td>0.244574</td>
      <td>0.059816</td>
      <td>44.967234</td>
      <td>0.197451</td>
      <td>0.247736</td>
      <td>0.061373</td>
      <td>56.974131</td>
      <td>0.226137</td>
      <td>0.275207</td>
      <td>0.075739</td>
    </tr>
    <tr>
      <th>Fold 3</th>
      <td>0.2917275983065136</td>
      <td>17.641918</td>
      <td>0.07268</td>
      <td>0.095009</td>
      <td>0.009027</td>
      <td>32.969449</td>
      <td>0.122193</td>
      <td>0.15458</td>
      <td>0.023895</td>
      <td>33.122934</td>
      <td>...</td>
      <td>0.267544</td>
      <td>0.07158</td>
      <td>45.217253</td>
      <td>0.204059</td>
      <td>0.295126</td>
      <td>0.087099</td>
      <td>52.93439</td>
      <td>0.22793</td>
      <td>0.296491</td>
      <td>0.087907</td>
    </tr>
    <tr>
      <th>Fold 4</th>
      <td>0.6078380304825228</td>
      <td>21.952029</td>
      <td>0.102976</td>
      <td>0.23958</td>
      <td>0.057399</td>
      <td>31.875664</td>
      <td>0.132362</td>
      <td>0.247882</td>
      <td>0.061445</td>
      <td>44.625223</td>
      <td>...</td>
      <td>0.257445</td>
      <td>0.066278</td>
      <td>50.989118</td>
      <td>0.218504</td>
      <td>0.270468</td>
      <td>0.073153</td>
      <td>50.761334</td>
      <td>0.216218</td>
      <td>0.26052</td>
      <td>0.067871</td>
    </tr>
    <tr>
      <th>Fold 5</th>
      <td>0.6347282357540948</td>
      <td>22.130944</td>
      <td>0.114576</td>
      <td>0.296114</td>
      <td>0.087684</td>
      <td>30.109371</td>
      <td>0.141644</td>
      <td>0.339554</td>
      <td>0.115297</td>
      <td>31.292934</td>
      <td>...</td>
      <td>0.38089</td>
      <td>0.145077</td>
      <td>45.081652</td>
      <td>0.223537</td>
      <td>0.407631</td>
      <td>0.166163</td>
      <td>47.322714</td>
      <td>0.244423</td>
      <td>0.43033</td>
      <td>0.185184</td>
    </tr>
    <tr>
      <th>Mean ± Std</th>
      <td>0.5528 ± 0.2089</td>
      <td>19.899 ± 2.930</td>
      <td>0.091 ± 0.016</td>
      <td>0.175 ± 0.079</td>
      <td>0.037 ± 0.031</td>
      <td>27.829 ± 4.842</td>
      <td>0.122 ± 0.014</td>
      <td>0.208 ± 0.076</td>
      <td>0.049 ± 0.036</td>
      <td>33.557 ± 5.709</td>
      <td>...</td>
      <td>0.277 ± 0.053</td>
      <td>0.080 ± 0.033</td>
      <td>47.524 ± 2.986</td>
      <td>0.212 ± 0.010</td>
      <td>0.298 ± 0.057</td>
      <td>0.092 ± 0.038</td>
      <td>51.969 ± 3.132</td>
      <td>0.224 ± 0.013</td>
      <td>0.306 ± 0.063</td>
      <td>0.098 ± 0.044</td>
    </tr>
  </tbody>
</table>
<p>6 rows × 29 columns</p>
</div></div><img alt="_images/6c088290e195de19631c33479c12ef02d6ad053efd766c710a9781ae5af6b5b2.png" src="_images/6c088290e195de19631c33479c12ef02d6ad053efd766c710a9781ae5af6b5b2.png" />
<img alt="_images/a865f89a1603aca03c447239e962f0538f8eaf1a891c69fee95d02cf744c50d0.png" src="_images/a865f89a1603aca03c447239e962f0538f8eaf1a891c69fee95d02cf744c50d0.png" />
<img alt="_images/1d14813943ee743a564cba93cc1b2d39f8ab116c548c56c357d73f129785bfb8.png" src="_images/1d14813943ee743a564cba93cc1b2d39f8ab116c548c56c357d73f129785bfb8.png" />
<img alt="_images/d31af81f82eaf8749b448e40a32e10ecd256f67e030801c05b6194bc7724b0d7.png" src="_images/d31af81f82eaf8749b448e40a32e10ecd256f67e030801c05b6194bc7724b0d7.png" />
<img alt="_images/3b8b4ac588cd97ea0fffdd45fa4da95e8eb8d7cfdcd6bee44e74fdfadd8abf69.png" src="_images/3b8b4ac588cd97ea0fffdd45fa4da95e8eb8d7cfdcd6bee44e74fdfadd8abf69.png" />
<img alt="_images/65339ac81fcf6fee3a5651666da61cf3e24fc8e581c69682f802bb077dea6f99.png" src="_images/65339ac81fcf6fee3a5651666da61cf3e24fc8e581c69682f802bb077dea6f99.png" />
<img alt="_images/1d895af7aebd548bc30a6418e54adef9abf26843c3868017560715496330f913.png" src="_images/1d895af7aebd548bc30a6418e54adef9abf26843c3868017560715496330f913.png" />
<img alt="_images/78cba0d116ec0d39643b0a3cbd76bc8e629f96a1ab702a8121838cc6cdbb003f.png" src="_images/78cba0d116ec0d39643b0a3cbd76bc8e629f96a1ab702a8121838cc6cdbb003f.png" />
<img alt="_images/057fe8945742219683a106e72332147d02c02b085bff75bc55c58db116c09644.png" src="_images/057fe8945742219683a106e72332147d02c02b085bff75bc55c58db116c09644.png" />
<img alt="_images/0b23a8aaffe1314f08c7e7e326473ba915397f8effa04fe23d2cf0d69053141b.png" src="_images/0b23a8aaffe1314f08c7e7e326473ba915397f8effa04fe23d2cf0d69053141b.png" />
<img alt="_images/aca7775f010e0192a7afaa87bb3a8bc00a450dbdf521c7e0b50974226e7ac8da.png" src="_images/aca7775f010e0192a7afaa87bb3a8bc00a450dbdf521c7e0b50974226e7ac8da.png" />
<img alt="_images/9a4d050bdad91d2cc40fda90350d18a8c0bb53ccd4b75f96ba9f2bfedc773f45.png" src="_images/9a4d050bdad91d2cc40fda90350d18a8c0bb53ccd4b75f96ba9f2bfedc773f45.png" />
<img alt="_images/322cc77fcf365dcc6257ee2104df2a4a5a7716c49fbbb7945491b09754c1cc13.png" src="_images/322cc77fcf365dcc6257ee2104df2a4a5a7716c49fbbb7945491b09754c1cc13.png" />
<img alt="_images/81113b21b0d99fc1da9d35a840cf8cb292fe94d0d3765aa7e86c3a5289d8db70.png" src="_images/81113b21b0d99fc1da9d35a840cf8cb292fe94d0d3765aa7e86c3a5289d8db70.png" />
<img alt="_images/bc516587db2c51cb38907ff87512ac09ba73f58bda0dca60e9a8b0d90429a161.png" src="_images/bc516587db2c51cb38907ff87512ac09ba73f58bda0dca60e9a8b0d90429a161.png" />
<img alt="_images/2d41e5baafb171348ad11f810f45760a815179b51e156350af3e23b685676ced.png" src="_images/2d41e5baafb171348ad11f810f45760a815179b51e156350af3e23b685676ced.png" />
<img alt="_images/972e8d80e118221d6e616e04f87307c4fa3204125fb30a7a2f6685d2fe57d176.png" src="_images/972e8d80e118221d6e616e04f87307c4fa3204125fb30a7a2f6685d2fe57d176.png" />
<img alt="_images/46f837ed8e16d567c561a62d08f060e01ae7775be263115bb600e084fc1e9856.png" src="_images/46f837ed8e16d567c561a62d08f060e01ae7775be263115bb600e084fc1e9856.png" />
<img alt="_images/14d2ad897cb3cbb2e2eeed105312c6210ed3ef17982e438c656152ff5188e3bb.png" src="_images/14d2ad897cb3cbb2e2eeed105312c6210ed3ef17982e438c656152ff5188e3bb.png" />
<img alt="_images/1c1c09383f4d0c22510d93467cd8c4c6398acf2610f19efb951403c3c7946762.png" src="_images/1c1c09383f4d0c22510d93467cd8c4c6398acf2610f19efb951403c3c7946762.png" />
<img alt="_images/a8de548bc2553175f3142b7615e1ec655bdf991c1fccb08d00036c16f1995676.png" src="_images/a8de548bc2553175f3142b7615e1ec655bdf991c1fccb08d00036c16f1995676.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Análisis de RMSE para Lag 7:
</pre></div>
</div>
<img alt="_images/5830be6e5d55a62d3375ab07fc92722c260bbe45fc93621af30d25947ca79988.png" src="_images/5830be6e5d55a62d3375ab07fc92722c260bbe45fc93621af30d25947ca79988.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Análisis para el lag de 14 días

 Métricas detalladas
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BDS_pvalue_H1</th>
      <th>(H1, MAPE)</th>
      <th>(H1, MAE)</th>
      <th>(H1, RMSE)</th>
      <th>(H1, MSE)</th>
      <th>(H2, MAPE)</th>
      <th>(H2, MAE)</th>
      <th>(H2, RMSE)</th>
      <th>(H2, MSE)</th>
      <th>(H3, MAPE)</th>
      <th>...</th>
      <th>(H5, RMSE)</th>
      <th>(H5, MSE)</th>
      <th>(H6, MAPE)</th>
      <th>(H6, MAE)</th>
      <th>(H6, RMSE)</th>
      <th>(H6, MSE)</th>
      <th>(H7, MAPE)</th>
      <th>(H7, MAE)</th>
      <th>(H7, RMSE)</th>
      <th>(H7, MSE)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Fold 1</th>
      <td>0.786171706863334</td>
      <td>18.866746</td>
      <td>0.102671</td>
      <td>0.138047</td>
      <td>0.019057</td>
      <td>36.975347</td>
      <td>0.148065</td>
      <td>0.202267</td>
      <td>0.040912</td>
      <td>42.559154</td>
      <td>...</td>
      <td>0.367235</td>
      <td>0.134862</td>
      <td>58.516714</td>
      <td>0.228399</td>
      <td>0.294715</td>
      <td>0.086857</td>
      <td>59.398011</td>
      <td>0.208979</td>
      <td>0.264058</td>
      <td>0.069726</td>
    </tr>
    <tr>
      <th>Fold 2</th>
      <td>0.003875616376311665</td>
      <td>21.735307</td>
      <td>0.092579</td>
      <td>0.129508</td>
      <td>0.016772</td>
      <td>24.690337</td>
      <td>0.121276</td>
      <td>0.159888</td>
      <td>0.025564</td>
      <td>48.544126</td>
      <td>...</td>
      <td>0.3071</td>
      <td>0.094311</td>
      <td>66.733357</td>
      <td>0.268996</td>
      <td>0.330529</td>
      <td>0.10925</td>
      <td>64.52592</td>
      <td>0.262166</td>
      <td>0.311231</td>
      <td>0.096865</td>
    </tr>
    <tr>
      <th>Fold 3</th>
      <td>0.02555990912284071</td>
      <td>18.79625</td>
      <td>0.095731</td>
      <td>0.13487</td>
      <td>0.01819</td>
      <td>32.033766</td>
      <td>0.154456</td>
      <td>0.1954</td>
      <td>0.038181</td>
      <td>29.97592</td>
      <td>...</td>
      <td>0.291453</td>
      <td>0.084945</td>
      <td>62.846685</td>
      <td>0.255462</td>
      <td>0.305514</td>
      <td>0.093339</td>
      <td>66.765874</td>
      <td>0.264599</td>
      <td>0.319646</td>
      <td>0.102173</td>
    </tr>
    <tr>
      <th>Fold 4</th>
      <td>0.9669874749771399</td>
      <td>20.888126</td>
      <td>0.109981</td>
      <td>0.153645</td>
      <td>0.023607</td>
      <td>26.589719</td>
      <td>0.151692</td>
      <td>0.202859</td>
      <td>0.041152</td>
      <td>35.237551</td>
      <td>...</td>
      <td>0.324337</td>
      <td>0.105194</td>
      <td>63.113553</td>
      <td>0.26341</td>
      <td>0.335803</td>
      <td>0.112764</td>
      <td>63.616442</td>
      <td>0.264621</td>
      <td>0.32165</td>
      <td>0.103459</td>
    </tr>
    <tr>
      <th>Fold 5</th>
      <td>0.7229705913926121</td>
      <td>17.819611</td>
      <td>0.089363</td>
      <td>0.134614</td>
      <td>0.018121</td>
      <td>31.217012</td>
      <td>0.144032</td>
      <td>0.211978</td>
      <td>0.044935</td>
      <td>34.812741</td>
      <td>...</td>
      <td>0.332302</td>
      <td>0.110424</td>
      <td>46.585183</td>
      <td>0.256897</td>
      <td>0.366367</td>
      <td>0.134225</td>
      <td>52.50519</td>
      <td>0.275291</td>
      <td>0.38137</td>
      <td>0.145443</td>
    </tr>
    <tr>
      <th>Mean ± Std</th>
      <td>0.5011 ± 0.4052</td>
      <td>19.621 ± 1.454</td>
      <td>0.098 ± 0.007</td>
      <td>0.138 ± 0.008</td>
      <td>0.019 ± 0.002</td>
      <td>30.301 ± 4.328</td>
      <td>0.144 ± 0.012</td>
      <td>0.194 ± 0.018</td>
      <td>0.038 ± 0.007</td>
      <td>38.226 ± 6.540</td>
      <td>...</td>
      <td>0.324 ± 0.026</td>
      <td>0.106 ± 0.017</td>
      <td>59.559 ± 6.990</td>
      <td>0.255 ± 0.014</td>
      <td>0.327 ± 0.025</td>
      <td>0.107 ± 0.017</td>
      <td>61.362 ± 5.032</td>
      <td>0.255 ± 0.024</td>
      <td>0.320 ± 0.037</td>
      <td>0.104 ± 0.024</td>
    </tr>
  </tbody>
</table>
<p>6 rows × 29 columns</p>
</div></div><img alt="_images/97fbc030b88978610861c9b95c2992953f5239761b314486dcdf7e7c8abd79eb.png" src="_images/97fbc030b88978610861c9b95c2992953f5239761b314486dcdf7e7c8abd79eb.png" />
<img alt="_images/e7ce7157f57afb0e50f44cef49b88151f44afbcb5e7908037c6c45d68b068f5c.png" src="_images/e7ce7157f57afb0e50f44cef49b88151f44afbcb5e7908037c6c45d68b068f5c.png" />
<img alt="_images/15049e2553bd916137a2852f8c85db598e04f2055f48f5de5a071a5cdc79bb11.png" src="_images/15049e2553bd916137a2852f8c85db598e04f2055f48f5de5a071a5cdc79bb11.png" />
<img alt="_images/79a9f62877a8842ec31ddfc724eb529e0fe5026fcefa8f735c293e2f53f87074.png" src="_images/79a9f62877a8842ec31ddfc724eb529e0fe5026fcefa8f735c293e2f53f87074.png" />
<img alt="_images/fc2013c175b2e25d315167ccced87e7ce0e94b40fccd0c67d00e4ce2d90b3a40.png" src="_images/fc2013c175b2e25d315167ccced87e7ce0e94b40fccd0c67d00e4ce2d90b3a40.png" />
<img alt="_images/51ebccc329054b1518e6945c4aaa910ae5457fd3ba19f7d261ecdec604ca6150.png" src="_images/51ebccc329054b1518e6945c4aaa910ae5457fd3ba19f7d261ecdec604ca6150.png" />
<img alt="_images/9cc1583369516f140f8540df7631ca89bf478db0eb1c051a44ffe808abbb30e7.png" src="_images/9cc1583369516f140f8540df7631ca89bf478db0eb1c051a44ffe808abbb30e7.png" />
<img alt="_images/35f99dd74121442cc60455c7cd020f3d7db48da60dd169032c47abab37e4b4e9.png" src="_images/35f99dd74121442cc60455c7cd020f3d7db48da60dd169032c47abab37e4b4e9.png" />
<img alt="_images/bd8590ec3e1edde27667ce5f7dd26271e194005b27d0f7731ffaa59766c90673.png" src="_images/bd8590ec3e1edde27667ce5f7dd26271e194005b27d0f7731ffaa59766c90673.png" />
<img alt="_images/07b0aa1f13457c7c37a7268291a03ab3daca2e6ecdf00bc9ebfc8fd878a51270.png" src="_images/07b0aa1f13457c7c37a7268291a03ab3daca2e6ecdf00bc9ebfc8fd878a51270.png" />
<img alt="_images/be535a1e57fdbedd1a0d46c2e63fdf2fc921f54d449e04e3550d6a6069e6b367.png" src="_images/be535a1e57fdbedd1a0d46c2e63fdf2fc921f54d449e04e3550d6a6069e6b367.png" />
<img alt="_images/af84ee0f1ce2a7b63aeda9d94a7324d64ea4c529d6e47b51ab3502fabdfabe7e.png" src="_images/af84ee0f1ce2a7b63aeda9d94a7324d64ea4c529d6e47b51ab3502fabdfabe7e.png" />
<img alt="_images/3f8eae2a85d16d834e6ba94e1ee43cd3df087527ee89633613da8c2b517d6dd5.png" src="_images/3f8eae2a85d16d834e6ba94e1ee43cd3df087527ee89633613da8c2b517d6dd5.png" />
<img alt="_images/259dca046b281c926e2bd8313c2fafd045ac03fdb82dc11cd7f9071ce7da131c.png" src="_images/259dca046b281c926e2bd8313c2fafd045ac03fdb82dc11cd7f9071ce7da131c.png" />
<img alt="_images/edcead76a18ac9d01edc871a67054d1033e51691c089a491cd213963c556d848.png" src="_images/edcead76a18ac9d01edc871a67054d1033e51691c089a491cd213963c556d848.png" />
<img alt="_images/56ce6b2ac998c856920b1410ab26fb78aab6db68bd47e6e738d2575720619db3.png" src="_images/56ce6b2ac998c856920b1410ab26fb78aab6db68bd47e6e738d2575720619db3.png" />
<img alt="_images/8616e4f2af9ac8547cf277b16f7255289f25281e1ebde1baea73c4ee2733910c.png" src="_images/8616e4f2af9ac8547cf277b16f7255289f25281e1ebde1baea73c4ee2733910c.png" />
<img alt="_images/045ef7a3fdb46f2539e51902155271b55bacd0b87deca7474e7ec5e22b89fc37.png" src="_images/045ef7a3fdb46f2539e51902155271b55bacd0b87deca7474e7ec5e22b89fc37.png" />
<img alt="_images/bdb2ae82cc2ed064a9092f0ff7315d839575b37edbf3e5e316365b7ceef608bd.png" src="_images/bdb2ae82cc2ed064a9092f0ff7315d839575b37edbf3e5e316365b7ceef608bd.png" />
<img alt="_images/3a20e6d7e59e96619c9a5788cc6f4aaf53e25f7c904e747ff60f2cd9abedafe2.png" src="_images/3a20e6d7e59e96619c9a5788cc6f4aaf53e25f7c904e747ff60f2cd9abedafe2.png" />
<img alt="_images/7e9d3a5c9e3134ac3c89bc9206367c391116cc2706f6cf34a1df01231d5919f7.png" src="_images/7e9d3a5c9e3134ac3c89bc9206367c391116cc2706f6cf34a1df01231d5919f7.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Análisis de RMSE para Lag 14:
</pre></div>
</div>
<img alt="_images/24c4a4c7f286cc8e8d972f7e175735c2fd2eb2454d01a4392cb46873dd693422.png" src="_images/24c4a4c7f286cc8e8d972f7e175735c2fd2eb2454d01a4392cb46873dd693422.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Análisis para el lag de 21 días

 Métricas detalladas
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BDS_pvalue_H1</th>
      <th>(H1, MAPE)</th>
      <th>(H1, MAE)</th>
      <th>(H1, RMSE)</th>
      <th>(H1, MSE)</th>
      <th>(H2, MAPE)</th>
      <th>(H2, MAE)</th>
      <th>(H2, RMSE)</th>
      <th>(H2, MSE)</th>
      <th>(H3, MAPE)</th>
      <th>...</th>
      <th>(H5, RMSE)</th>
      <th>(H5, MSE)</th>
      <th>(H6, MAPE)</th>
      <th>(H6, MAE)</th>
      <th>(H6, RMSE)</th>
      <th>(H6, MSE)</th>
      <th>(H7, MAPE)</th>
      <th>(H7, MAE)</th>
      <th>(H7, RMSE)</th>
      <th>(H7, MSE)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Fold 1</th>
      <td>0.3087665670435271</td>
      <td>20.385181</td>
      <td>0.124406</td>
      <td>0.188472</td>
      <td>0.035522</td>
      <td>33.799101</td>
      <td>0.189254</td>
      <td>0.281072</td>
      <td>0.079001</td>
      <td>38.613467</td>
      <td>...</td>
      <td>0.278815</td>
      <td>0.077738</td>
      <td>54.465661</td>
      <td>0.25774</td>
      <td>0.321131</td>
      <td>0.103125</td>
      <td>56.749522</td>
      <td>0.25697</td>
      <td>0.324556</td>
      <td>0.105336</td>
    </tr>
    <tr>
      <th>Fold 2</th>
      <td>0.43066289269018243</td>
      <td>21.53363</td>
      <td>0.134695</td>
      <td>0.193087</td>
      <td>0.037283</td>
      <td>30.221228</td>
      <td>0.180406</td>
      <td>0.264838</td>
      <td>0.070139</td>
      <td>47.495294</td>
      <td>...</td>
      <td>0.386095</td>
      <td>0.14907</td>
      <td>59.809811</td>
      <td>0.301508</td>
      <td>0.388156</td>
      <td>0.150665</td>
      <td>61.249767</td>
      <td>0.312899</td>
      <td>0.400607</td>
      <td>0.160486</td>
    </tr>
    <tr>
      <th>Fold 3</th>
      <td>0.15384954575968998</td>
      <td>21.061054</td>
      <td>0.126334</td>
      <td>0.1887</td>
      <td>0.035608</td>
      <td>31.068133</td>
      <td>0.208848</td>
      <td>0.332663</td>
      <td>0.110665</td>
      <td>41.86436</td>
      <td>...</td>
      <td>0.365769</td>
      <td>0.133787</td>
      <td>60.520711</td>
      <td>0.299956</td>
      <td>0.413617</td>
      <td>0.171079</td>
      <td>60.601419</td>
      <td>0.302891</td>
      <td>0.361888</td>
      <td>0.130963</td>
    </tr>
    <tr>
      <th>Fold 4</th>
      <td>0.2667602188520407</td>
      <td>23.722238</td>
      <td>0.128517</td>
      <td>0.186549</td>
      <td>0.0348</td>
      <td>31.597065</td>
      <td>0.166575</td>
      <td>0.265638</td>
      <td>0.070563</td>
      <td>38.843671</td>
      <td>...</td>
      <td>0.414943</td>
      <td>0.172178</td>
      <td>59.542646</td>
      <td>0.27923</td>
      <td>0.357008</td>
      <td>0.127454</td>
      <td>60.248538</td>
      <td>0.287206</td>
      <td>0.385914</td>
      <td>0.14893</td>
    </tr>
    <tr>
      <th>Fold 5</th>
      <td>0.1634940329185175</td>
      <td>29.993014</td>
      <td>0.156845</td>
      <td>0.184957</td>
      <td>0.034209</td>
      <td>39.399579</td>
      <td>0.183586</td>
      <td>0.229062</td>
      <td>0.052469</td>
      <td>53.408962</td>
      <td>...</td>
      <td>0.281603</td>
      <td>0.0793</td>
      <td>64.36282</td>
      <td>0.212302</td>
      <td>0.269306</td>
      <td>0.072526</td>
      <td>61.049383</td>
      <td>0.194933</td>
      <td>0.240587</td>
      <td>0.057882</td>
    </tr>
    <tr>
      <th>Mean ± Std</th>
      <td>0.2647 ± 0.1020</td>
      <td>23.339 ± 3.510</td>
      <td>0.134 ± 0.012</td>
      <td>0.188 ± 0.003</td>
      <td>0.035 ± 0.001</td>
      <td>33.217 ± 3.310</td>
      <td>0.186 ± 0.014</td>
      <td>0.275 ± 0.034</td>
      <td>0.077 ± 0.019</td>
      <td>44.045 ± 5.673</td>
      <td>...</td>
      <td>0.345 ± 0.056</td>
      <td>0.122 ± 0.038</td>
      <td>59.740 ± 3.157</td>
      <td>0.270 ± 0.033</td>
      <td>0.350 ± 0.051</td>
      <td>0.125 ± 0.035</td>
      <td>59.980 ± 1.652</td>
      <td>0.271 ± 0.042</td>
      <td>0.343 ± 0.057</td>
      <td>0.121 ± 0.037</td>
    </tr>
  </tbody>
</table>
<p>6 rows × 29 columns</p>
</div></div><img alt="_images/fbab3099aeacc29002660d5b64ff1571a4e6b3798ce3995d4f6ec31c2811d31d.png" src="_images/fbab3099aeacc29002660d5b64ff1571a4e6b3798ce3995d4f6ec31c2811d31d.png" />
<img alt="_images/3bcb95f764399e275c604c1c15c1e2293abe4c5e18f4ef3abc105e15ebb8803e.png" src="_images/3bcb95f764399e275c604c1c15c1e2293abe4c5e18f4ef3abc105e15ebb8803e.png" />
<img alt="_images/529ce98ef2cbab58fd692bfcdefee1075e2cfa6d833c8a9283a56ee59f71f3bb.png" src="_images/529ce98ef2cbab58fd692bfcdefee1075e2cfa6d833c8a9283a56ee59f71f3bb.png" />
<img alt="_images/3bb7bcee2de46e439166a7d89c4148d1052ed6f5bd5aac7e99d4beeec575fece.png" src="_images/3bb7bcee2de46e439166a7d89c4148d1052ed6f5bd5aac7e99d4beeec575fece.png" />
<img alt="_images/d453a4ec930194c4e79bd87a40b66d32c5af4805a24c0a2f8615a771dd2f7f86.png" src="_images/d453a4ec930194c4e79bd87a40b66d32c5af4805a24c0a2f8615a771dd2f7f86.png" />
<img alt="_images/c5f0c2affe02e718adc49f81d76dcb11c64f420999b6b88f98afcbc3526a047f.png" src="_images/c5f0c2affe02e718adc49f81d76dcb11c64f420999b6b88f98afcbc3526a047f.png" />
<img alt="_images/ff62c4ed1bc27b8f05114cc2e45a757ffa29bd6e6da63a900f7695400c71c08e.png" src="_images/ff62c4ed1bc27b8f05114cc2e45a757ffa29bd6e6da63a900f7695400c71c08e.png" />
<img alt="_images/faa41213cced476fecb5acecdd99fcb921f2cf3cf9e1ebc53fa431d297bfa106.png" src="_images/faa41213cced476fecb5acecdd99fcb921f2cf3cf9e1ebc53fa431d297bfa106.png" />
<img alt="_images/fb45cf5464521e5b91e3ea0abe915224ffa503c37f67810d12cfdecbbbf4e96d.png" src="_images/fb45cf5464521e5b91e3ea0abe915224ffa503c37f67810d12cfdecbbbf4e96d.png" />
<img alt="_images/6598554152fcdce0a037fac7b2c37ff97ac8c7ec47fb991116e2782f15258594.png" src="_images/6598554152fcdce0a037fac7b2c37ff97ac8c7ec47fb991116e2782f15258594.png" />
<img alt="_images/265b37d8c73f97dde14f1cea43c45c0b389fbe106c673fe34958c3acb33687f6.png" src="_images/265b37d8c73f97dde14f1cea43c45c0b389fbe106c673fe34958c3acb33687f6.png" />
<img alt="_images/07a63f08ac144836f2d60009c38f459a029e68c4577fad297323b4df841691ec.png" src="_images/07a63f08ac144836f2d60009c38f459a029e68c4577fad297323b4df841691ec.png" />
<img alt="_images/9a196de1e724e58575118f42a7fd55926a364b12e6db33d93dd9e1a2622fa0fb.png" src="_images/9a196de1e724e58575118f42a7fd55926a364b12e6db33d93dd9e1a2622fa0fb.png" />
<img alt="_images/8d9c40c526ab033ca617483cd5b29a9e2531d5e9899dfb024fb413cf8de0bb1c.png" src="_images/8d9c40c526ab033ca617483cd5b29a9e2531d5e9899dfb024fb413cf8de0bb1c.png" />
<img alt="_images/697105d05e98dcdafe7ba1cc0ec36f777758ea69b8239a1144a2e5db6b38f17a.png" src="_images/697105d05e98dcdafe7ba1cc0ec36f777758ea69b8239a1144a2e5db6b38f17a.png" />
<img alt="_images/3b656d325871f6deabcd6b12ce4b192a8e36ba8d221eb32c294ab418abeae501.png" src="_images/3b656d325871f6deabcd6b12ce4b192a8e36ba8d221eb32c294ab418abeae501.png" />
<img alt="_images/4ab188399f947462d6d6af06bee0bfc1ef6f8dc63f6aa61e4a96f641d8259ba8.png" src="_images/4ab188399f947462d6d6af06bee0bfc1ef6f8dc63f6aa61e4a96f641d8259ba8.png" />
<img alt="_images/32e328163e8938aa35c92a090c34782b1e79b93ae24ff89d2414fb43200c6ec3.png" src="_images/32e328163e8938aa35c92a090c34782b1e79b93ae24ff89d2414fb43200c6ec3.png" />
<img alt="_images/3b609fe83e51dbb9da8d9568eb2c03a6e6405f16c15b49bf4e18c0bb228317ea.png" src="_images/3b609fe83e51dbb9da8d9568eb2c03a6e6405f16c15b49bf4e18c0bb228317ea.png" />
<img alt="_images/d18b759f76a8bc50785aecc3728d5204cf4fc0b4fcdc4e2eb5267f4dbb27cf3b.png" src="_images/d18b759f76a8bc50785aecc3728d5204cf4fc0b4fcdc4e2eb5267f4dbb27cf3b.png" />
<img alt="_images/a65bbaeab9c19365241517961587b36ff220231736fe7dad07e70dc99f101258.png" src="_images/a65bbaeab9c19365241517961587b36ff220231736fe7dad07e70dc99f101258.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Análisis de RMSE para Lag 21:
</pre></div>
</div>
<img alt="_images/667426d8d1c85de668c783fe2012bb4a1502ce3124f04460fd015c3c0b0b2e5c.png" src="_images/667426d8d1c85de668c783fe2012bb4a1502ce3124f04460fd015c3c0b0b2e5c.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Análisis para el lag de 28 días

 Métricas detalladas
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BDS_pvalue_H1</th>
      <th>(H1, MAPE)</th>
      <th>(H1, MAE)</th>
      <th>(H1, RMSE)</th>
      <th>(H1, MSE)</th>
      <th>(H2, MAPE)</th>
      <th>(H2, MAE)</th>
      <th>(H2, RMSE)</th>
      <th>(H2, MSE)</th>
      <th>(H3, MAPE)</th>
      <th>...</th>
      <th>(H5, RMSE)</th>
      <th>(H5, MSE)</th>
      <th>(H6, MAPE)</th>
      <th>(H6, MAE)</th>
      <th>(H6, RMSE)</th>
      <th>(H6, MSE)</th>
      <th>(H7, MAPE)</th>
      <th>(H7, MAE)</th>
      <th>(H7, RMSE)</th>
      <th>(H7, MSE)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Fold 1</th>
      <td>0.3752657816598237</td>
      <td>39.731798</td>
      <td>0.200782</td>
      <td>0.339214</td>
      <td>0.115066</td>
      <td>49.094874</td>
      <td>0.235103</td>
      <td>0.354728</td>
      <td>0.125832</td>
      <td>49.438777</td>
      <td>...</td>
      <td>0.548752</td>
      <td>0.301129</td>
      <td>48.978869</td>
      <td>0.325893</td>
      <td>0.402834</td>
      <td>0.162275</td>
      <td>49.456298</td>
      <td>0.330487</td>
      <td>0.442117</td>
      <td>0.195468</td>
    </tr>
    <tr>
      <th>Fold 2</th>
      <td>0.09902133053253061</td>
      <td>32.781468</td>
      <td>0.181306</td>
      <td>0.330438</td>
      <td>0.109189</td>
      <td>49.620749</td>
      <td>0.249215</td>
      <td>0.393799</td>
      <td>0.155078</td>
      <td>63.562157</td>
      <td>...</td>
      <td>0.538496</td>
      <td>0.289978</td>
      <td>49.450868</td>
      <td>0.368586</td>
      <td>0.597123</td>
      <td>0.356556</td>
      <td>54.846932</td>
      <td>0.366591</td>
      <td>0.487572</td>
      <td>0.237727</td>
    </tr>
    <tr>
      <th>Fold 3</th>
      <td>0.5727490996805245</td>
      <td>39.818873</td>
      <td>0.241477</td>
      <td>0.520496</td>
      <td>0.270916</td>
      <td>54.233254</td>
      <td>0.289024</td>
      <td>0.609196</td>
      <td>0.37112</td>
      <td>67.499022</td>
      <td>...</td>
      <td>0.726757</td>
      <td>0.528175</td>
      <td>51.631513</td>
      <td>0.368003</td>
      <td>0.713504</td>
      <td>0.509087</td>
      <td>54.771616</td>
      <td>0.388751</td>
      <td>0.725731</td>
      <td>0.526686</td>
    </tr>
    <tr>
      <th>Fold 4</th>
      <td>0.010084530495730206</td>
      <td>35.092381</td>
      <td>0.179159</td>
      <td>0.28524</td>
      <td>0.081362</td>
      <td>50.656134</td>
      <td>0.304723</td>
      <td>0.593859</td>
      <td>0.352669</td>
      <td>57.8489</td>
      <td>...</td>
      <td>0.747483</td>
      <td>0.558731</td>
      <td>80.681766</td>
      <td>0.472597</td>
      <td>0.776001</td>
      <td>0.602178</td>
      <td>61.590372</td>
      <td>0.438663</td>
      <td>0.796165</td>
      <td>0.633878</td>
    </tr>
    <tr>
      <th>Fold 5</th>
      <td>9.768429453868598e-05</td>
      <td>52.367371</td>
      <td>0.250853</td>
      <td>0.304252</td>
      <td>0.092569</td>
      <td>70.080445</td>
      <td>0.32403</td>
      <td>0.432005</td>
      <td>0.186629</td>
      <td>83.396725</td>
      <td>...</td>
      <td>0.602719</td>
      <td>0.36327</td>
      <td>92.376372</td>
      <td>0.455028</td>
      <td>0.578395</td>
      <td>0.334541</td>
      <td>107.923964</td>
      <td>0.492309</td>
      <td>0.690567</td>
      <td>0.476883</td>
    </tr>
    <tr>
      <th>Mean ± Std</th>
      <td>0.2114 ± 0.2259</td>
      <td>39.958 ± 6.771</td>
      <td>0.211 ± 0.030</td>
      <td>0.356 ± 0.084</td>
      <td>0.134 ± 0.070</td>
      <td>54.737 ± 7.878</td>
      <td>0.280 ± 0.033</td>
      <td>0.477 ± 0.105</td>
      <td>0.238 ± 0.103</td>
      <td>64.349 ± 11.295</td>
      <td>...</td>
      <td>0.633 ± 0.088</td>
      <td>0.408 ± 0.114</td>
      <td>64.624 ± 18.286</td>
      <td>0.398 ± 0.056</td>
      <td>0.614 ± 0.128</td>
      <td>0.393 ± 0.152</td>
      <td>65.718 ± 21.451</td>
      <td>0.403 ± 0.057</td>
      <td>0.628 ± 0.139</td>
      <td>0.414 ± 0.170</td>
    </tr>
  </tbody>
</table>
<p>6 rows × 29 columns</p>
</div></div><img alt="_images/34ab21b48f8d2561f690eb6e1ebe11373a93a4d729d12c24fadaa82dfa1aeab4.png" src="_images/34ab21b48f8d2561f690eb6e1ebe11373a93a4d729d12c24fadaa82dfa1aeab4.png" />
<img alt="_images/dad680e1de388f6f2164d0819ba7d4a153df9a6a799423ef9f714352febbb560.png" src="_images/dad680e1de388f6f2164d0819ba7d4a153df9a6a799423ef9f714352febbb560.png" />
<img alt="_images/141af127431d49cd9eb3067addc63d2ef166896071bb762704e79281004dc0d4.png" src="_images/141af127431d49cd9eb3067addc63d2ef166896071bb762704e79281004dc0d4.png" />
<img alt="_images/9e10f3c1fbbf6943bf641b1b7cf7f566831ced8063e3af9dc9fe8c994c86bd4d.png" src="_images/9e10f3c1fbbf6943bf641b1b7cf7f566831ced8063e3af9dc9fe8c994c86bd4d.png" />
<img alt="_images/645df9c3b04d3fac09353a6742b86eff678759fadee1037af4173d7e954f8dbd.png" src="_images/645df9c3b04d3fac09353a6742b86eff678759fadee1037af4173d7e954f8dbd.png" />
<img alt="_images/c2eef815dfb883a5ffcb3a4881f0af4f0221e47bc1caebb1077138a9a20a5ae7.png" src="_images/c2eef815dfb883a5ffcb3a4881f0af4f0221e47bc1caebb1077138a9a20a5ae7.png" />
<img alt="_images/c5f071077ced46e4eeddf1b44f7b1c65d2a5122eca0e8061397044801f46299e.png" src="_images/c5f071077ced46e4eeddf1b44f7b1c65d2a5122eca0e8061397044801f46299e.png" />
<img alt="_images/720816d35dbd2d5b6988464f21294a2c75666f38de2a90a47a0a4e8fc1ac3b4a.png" src="_images/720816d35dbd2d5b6988464f21294a2c75666f38de2a90a47a0a4e8fc1ac3b4a.png" />
<img alt="_images/684ec781f2be600c5384927f8d4ab14570f52f206edeb78d0a6509315571c530.png" src="_images/684ec781f2be600c5384927f8d4ab14570f52f206edeb78d0a6509315571c530.png" />
<img alt="_images/23e43cf744187a8f9e58ce77e96c1d143277239d7792688fc80349fe629bdbe0.png" src="_images/23e43cf744187a8f9e58ce77e96c1d143277239d7792688fc80349fe629bdbe0.png" />
<img alt="_images/3b40ad8a2543ab2c3479bd2703f672f7b854ddf08aa36b34c3441b2054aeec88.png" src="_images/3b40ad8a2543ab2c3479bd2703f672f7b854ddf08aa36b34c3441b2054aeec88.png" />
<img alt="_images/9860b313cb1ba86e601848bd65a6010f865103cc2493262011d86031d1a01c74.png" src="_images/9860b313cb1ba86e601848bd65a6010f865103cc2493262011d86031d1a01c74.png" />
<img alt="_images/b5ef534b78b04336e4eba5f70be235e2968497fb0510fc6e459d642a151e6e59.png" src="_images/b5ef534b78b04336e4eba5f70be235e2968497fb0510fc6e459d642a151e6e59.png" />
<img alt="_images/3f9898b9c320d8409bc286d703669039e271b9b6f2464d31652aff7d90e1c12a.png" src="_images/3f9898b9c320d8409bc286d703669039e271b9b6f2464d31652aff7d90e1c12a.png" />
<img alt="_images/f0dd88ff9da26221f5335556a1a4a185b8f6ac555d74c97eeb601611d9509ecc.png" src="_images/f0dd88ff9da26221f5335556a1a4a185b8f6ac555d74c97eeb601611d9509ecc.png" />
<img alt="_images/4dac453abea7dd8f2dc08b22c9a0dbd9a91082258d5c82c32965926275193898.png" src="_images/4dac453abea7dd8f2dc08b22c9a0dbd9a91082258d5c82c32965926275193898.png" />
<img alt="_images/91ecdd8a3ebc5570d39f6277ec76a30f82cd64bcfd42124ed66764b5d3aeecb3.png" src="_images/91ecdd8a3ebc5570d39f6277ec76a30f82cd64bcfd42124ed66764b5d3aeecb3.png" />
<img alt="_images/ea40f072f1494c9cc0a954f09f01172e15da472fac4f6985e9ac1f786dc64a10.png" src="_images/ea40f072f1494c9cc0a954f09f01172e15da472fac4f6985e9ac1f786dc64a10.png" />
<img alt="_images/d7a6bc268ab0399cb5e90137a9f47ecbeeb8d6334607b064e9f95b807e61a924.png" src="_images/d7a6bc268ab0399cb5e90137a9f47ecbeeb8d6334607b064e9f95b807e61a924.png" />
<img alt="_images/97363e06960bfc8376e1cbde1734a63970b9c868710e93b7ce190189124b81de.png" src="_images/97363e06960bfc8376e1cbde1734a63970b9c868710e93b7ce190189124b81de.png" />
<img alt="_images/579e5cd7a8bbebf8ece4353581819b8e98b555c3663bef1319d083c01c4e784c.png" src="_images/579e5cd7a8bbebf8ece4353581819b8e98b555c3663bef1319d083c01c4e784c.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Análisis de RMSE para Lag 28:
</pre></div>
</div>
<img alt="_images/26d9a26fe286ff281446a622a63401f6b51548966a4f2ce5074f230b0ef8f640.png" src="_images/26d9a26fe286ff281446a622a63401f6b51548966a4f2ce5074f230b0ef8f640.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Resumen final para la volatilidad de 7 días:

 Comparación de todos los lags:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAPE_Promedio</th>
      <th>MAE_Promedio</th>
      <th>RMSE_Promedio</th>
      <th>MSE_Promedio</th>
      <th>BDS_pvalue_Promedio</th>
    </tr>
    <tr>
      <th>Lag</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>36.943658</td>
      <td>0.166657</td>
      <td>0.253073</td>
      <td>0.070197</td>
      <td>0.552800</td>
    </tr>
    <tr>
      <th>14</th>
      <td>44.207137</td>
      <td>0.197667</td>
      <td>0.261609</td>
      <td>0.073887</td>
      <td>0.501113</td>
    </tr>
    <tr>
      <th>21</th>
      <td>46.923649</td>
      <td>0.227720</td>
      <td>0.315340</td>
      <td>0.106469</td>
      <td>0.264707</td>
    </tr>
    <tr>
      <th>28</th>
      <td>60.498948</td>
      <td>0.341295</td>
      <td>0.540169</td>
      <td>0.313305</td>
      <td>0.211444</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="interpretaciones">
<h4><strong>Interpretaciones</strong><a class="headerlink" href="#interpretaciones" title="Link to this heading">#</a></h4>
<section id="lag-7-dias">
<h5><strong>Lag 7 días</strong><a class="headerlink" href="#lag-7-dias" title="Link to this heading">#</a></h5>
<p>Este lag presentó el mejor desempeño promedio entre las ventanas analizadas, con un RMSE promedio de <strong>0.2531</strong> para el modelo correspondiente a la volatilidad de 7 días. Su mejor Fold fue el 1, con un RMSE de <strong>0.2083</strong>. Se observa que el RMSE tiende a aumentar a medida que avanza el horizonte de predicción, indicando que el modelo predice con mayor precisión los días más cercanos. Asimismo, el RMSE promedio por Fold también aumenta progresivamente, siendo el Fold 1 el mejor del modelo en general.</p>
</section>
<section id="lag-14-dias">
<h5><strong>Lag 14 días</strong><a class="headerlink" href="#lag-14-dias" title="Link to this heading">#</a></h5>
<p>Los modelos para esta ventana obtuvieron un RMSE promedio de <strong>0.2616</strong>, posicionándose como el segundo mejor desempeño. El mejor Fold fue el 3, con un RMSE de <strong>0.246</strong>. Al igual que en el lag de 7 días, los RMSE tienden a aumentar a medida que avanzan los horizontes; sin embargo, en el último horizonte se observa una ligera disminución. Por Fold, los RMSE crecen en general, excepto en el Fold 3, que presentó el menor valor.</p>
</section>
<section id="lag-21-dias">
<h5><strong>Lag 21 días</strong><a class="headerlink" href="#lag-21-dias" title="Link to this heading">#</a></h5>
<p>Para esta ventana, el RMSE promedio se incrementó a <strong>0.3153</strong>, reflejando un rendimiento menor respecto a los lags anteriores. El mejor Fold fue el 5, con un RMSE de <strong>0.248</strong>. Analizando los RMSE por horizonte, se observa un aumento progresivo hasta el horizonte 4 el cual tuvo el peor desempeño, seguido de una ligera disminución y estabilidad en los horizontes restantes. Por Fold, el RMSE promedio aumenta significativamente del Fold 1 al Fold 2 (siendo este último el peor) y luego disminuye gradualmente en los Folds posteriores.</p>
</section>
<section id="lag-28-dias">
<h5><strong>Lag 28 días</strong><a class="headerlink" href="#lag-28-dias" title="Link to this heading">#</a></h5>
<p>El lag de 28 días presentó el peor desempeño entre los cuatro analizados, con un RMSE promedio de <strong>0.540</strong>. Su mejor Fold fue el 1, con un RMSE de <strong>0.413</strong>, lo que refleja una diferencia notable respecto a los demás <a class="reference external" href="http://Folds.Al">Folds.Al</a> analizar los promedios por Fold, se observa un aumento progresivo hasta el Fold 3, que fue el de peor desempeño, seguido de una ligera disminución en los Folds restantes. Por horizonte, el RMSE aumenta hasta alcanzar el peor valor en el horizonte 5, mientras que los demás horizontes muestran valores relativamente más bajos y estables.</p>
</section>
<section id="general">
<h5><strong>General</strong><a class="headerlink" href="#general" title="Link to this heading">#</a></h5>
<p>De manera general, se observa que los mejores Folds de cada lag lograron aproximarse de manera destacada a los valores reales, ya que las líneas predichas siguen en la mayoría de los casos los patrones de los datos. Por otro lado, los Folds con menor desempeño mostraron una capacidad de predicción más limitada, reflejándose en desviaciones más notables respecto a los valores observados.</p>
</section>
</section>
</section>
<section id="volatilidad-de-la-ventana-de-14-dias">
<h3><strong>Volatilidad de la ventana de 14 días</strong><a class="headerlink" href="#volatilidad-de-la-ventana-de-14-dias" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Para volatilidad de 14 días</span>
<span class="n">resultados_14d</span> <span class="o">=</span> <span class="n">resultadosventana</span><span class="p">(</span>
    <span class="n">volatilidad</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
    <span class="n">lags_list</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">28</span><span class="p">],</span>
    <span class="n">n_steps_forecast</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
    <span class="n">n_steps_jump</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados para la ventana de volatilidad de 14 días

 El mejor modelo para la volatilidad de 14 días está en el lag de 14 días. (RMSE promedio: 0.1609)

Dentro del lag 14, el mejor fold es el Fold 4 con RMSE: 0.1414

Análisis para el lag de 7 días

 Métricas detalladas
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BDS_pvalue_H1</th>
      <th>(H1, MAPE)</th>
      <th>(H1, MAE)</th>
      <th>(H1, RMSE)</th>
      <th>(H1, MSE)</th>
      <th>(H2, MAPE)</th>
      <th>(H2, MAE)</th>
      <th>(H2, RMSE)</th>
      <th>(H2, MSE)</th>
      <th>(H3, MAPE)</th>
      <th>...</th>
      <th>(H5, RMSE)</th>
      <th>(H5, MSE)</th>
      <th>(H6, MAPE)</th>
      <th>(H6, MAE)</th>
      <th>(H6, RMSE)</th>
      <th>(H6, MSE)</th>
      <th>(H7, MAPE)</th>
      <th>(H7, MAE)</th>
      <th>(H7, RMSE)</th>
      <th>(H7, MSE)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Fold 1</th>
      <td>0.8134647259870059</td>
      <td>6.585872</td>
      <td>0.034763</td>
      <td>0.049097</td>
      <td>0.002411</td>
      <td>11.04904</td>
      <td>0.058106</td>
      <td>0.082301</td>
      <td>0.006773</td>
      <td>13.820943</td>
      <td>...</td>
      <td>0.186155</td>
      <td>0.034654</td>
      <td>31.081754</td>
      <td>0.147794</td>
      <td>0.215712</td>
      <td>0.046532</td>
      <td>30.111905</td>
      <td>0.148932</td>
      <td>0.226375</td>
      <td>0.051246</td>
    </tr>
    <tr>
      <th>Fold 2</th>
      <td>0.8466033753753499</td>
      <td>8.155784</td>
      <td>0.044021</td>
      <td>0.067815</td>
      <td>0.004599</td>
      <td>11.269998</td>
      <td>0.059863</td>
      <td>0.081623</td>
      <td>0.006662</td>
      <td>14.365524</td>
      <td>...</td>
      <td>0.133394</td>
      <td>0.017794</td>
      <td>26.26791</td>
      <td>0.130726</td>
      <td>0.183152</td>
      <td>0.033545</td>
      <td>32.698687</td>
      <td>0.1545</td>
      <td>0.220181</td>
      <td>0.048479</td>
    </tr>
    <tr>
      <th>Fold 3</th>
      <td>0.5614002934907385</td>
      <td>7.106701</td>
      <td>0.038064</td>
      <td>0.052679</td>
      <td>0.002775</td>
      <td>11.727247</td>
      <td>0.062501</td>
      <td>0.090947</td>
      <td>0.008271</td>
      <td>14.536502</td>
      <td>...</td>
      <td>0.142874</td>
      <td>0.020413</td>
      <td>21.636803</td>
      <td>0.114803</td>
      <td>0.154204</td>
      <td>0.023779</td>
      <td>28.042863</td>
      <td>0.135105</td>
      <td>0.176935</td>
      <td>0.031306</td>
    </tr>
    <tr>
      <th>Fold 4</th>
      <td>0.6679694008667922</td>
      <td>9.989086</td>
      <td>0.064513</td>
      <td>0.16927</td>
      <td>0.028652</td>
      <td>12.440974</td>
      <td>0.076406</td>
      <td>0.18829</td>
      <td>0.035453</td>
      <td>15.939657</td>
      <td>...</td>
      <td>0.208485</td>
      <td>0.043466</td>
      <td>22.186751</td>
      <td>0.124021</td>
      <td>0.221349</td>
      <td>0.048995</td>
      <td>24.089635</td>
      <td>0.135344</td>
      <td>0.236011</td>
      <td>0.055701</td>
    </tr>
    <tr>
      <th>Fold 5</th>
      <td>0.4411816911257511</td>
      <td>10.042402</td>
      <td>0.066875</td>
      <td>0.206172</td>
      <td>0.042507</td>
      <td>14.503683</td>
      <td>0.087177</td>
      <td>0.228031</td>
      <td>0.051998</td>
      <td>17.023199</td>
      <td>...</td>
      <td>0.243087</td>
      <td>0.059091</td>
      <td>25.185154</td>
      <td>0.142038</td>
      <td>0.258366</td>
      <td>0.066753</td>
      <td>30.009206</td>
      <td>0.160061</td>
      <td>0.273606</td>
      <td>0.07486</td>
    </tr>
    <tr>
      <th>Mean ± Std</th>
      <td>0.6661 ± 0.1522</td>
      <td>8.376 ± 1.431</td>
      <td>0.050 ± 0.013</td>
      <td>0.109 ± 0.066</td>
      <td>0.016 ± 0.016</td>
      <td>12.198 ± 1.247</td>
      <td>0.069 ± 0.011</td>
      <td>0.134 ± 0.062</td>
      <td>0.022 ± 0.019</td>
      <td>15.137 ± 1.174</td>
      <td>...</td>
      <td>0.183 ± 0.041</td>
      <td>0.035 ± 0.015</td>
      <td>25.272 ± 3.391</td>
      <td>0.132 ± 0.012</td>
      <td>0.207 ± 0.035</td>
      <td>0.044 ± 0.015</td>
      <td>28.990 ± 2.862</td>
      <td>0.147 ± 0.010</td>
      <td>0.227 ± 0.031</td>
      <td>0.052 ± 0.014</td>
    </tr>
  </tbody>
</table>
<p>6 rows × 29 columns</p>
</div></div><img alt="_images/7c2da8574f43eac2bd0a911a4fae13bf2f98787ad1cd281df253396611f1682f.png" src="_images/7c2da8574f43eac2bd0a911a4fae13bf2f98787ad1cd281df253396611f1682f.png" />
<img alt="_images/a7ffc49e30cd2a043213a43a10b2e2ca1975d8bf4763be0d5dc9b106b2cc6576.png" src="_images/a7ffc49e30cd2a043213a43a10b2e2ca1975d8bf4763be0d5dc9b106b2cc6576.png" />
<img alt="_images/f3858a361318b594ce25d445a5444efaf99e36ed79514b65fb0dbc6f202868ba.png" src="_images/f3858a361318b594ce25d445a5444efaf99e36ed79514b65fb0dbc6f202868ba.png" />
<img alt="_images/371db389fc0be8abc11707b34b7e0c3efe62a81acfa7895ca16407b7bc93e584.png" src="_images/371db389fc0be8abc11707b34b7e0c3efe62a81acfa7895ca16407b7bc93e584.png" />
<img alt="_images/68673c1e3a98365ea99ff6599d5d1bb3200da2f0a2f93bc6db56220bfbcc0443.png" src="_images/68673c1e3a98365ea99ff6599d5d1bb3200da2f0a2f93bc6db56220bfbcc0443.png" />
<img alt="_images/8af1751d5cabff1771ee1e663cae5374dc6c01f6be5ec9bff6db1cf471435fca.png" src="_images/8af1751d5cabff1771ee1e663cae5374dc6c01f6be5ec9bff6db1cf471435fca.png" />
<img alt="_images/eb7a017f1545e72ecaaf32a7d861e64d2075d8a7f817c56ddc988d3dde17d45a.png" src="_images/eb7a017f1545e72ecaaf32a7d861e64d2075d8a7f817c56ddc988d3dde17d45a.png" />
<img alt="_images/131e569522d8d177b0b95e54109abe800a64bc91beb34da2c9d90a34cb483828.png" src="_images/131e569522d8d177b0b95e54109abe800a64bc91beb34da2c9d90a34cb483828.png" />
<img alt="_images/8c4bdf1e9b112e99b617be3a83b8db8ec98938de2a0e8829b1f68bbf290c7a19.png" src="_images/8c4bdf1e9b112e99b617be3a83b8db8ec98938de2a0e8829b1f68bbf290c7a19.png" />
<img alt="_images/7a17e0ba6be97b3406eeab126a4181db853cfa8e419f53e716ac132e96149ff4.png" src="_images/7a17e0ba6be97b3406eeab126a4181db853cfa8e419f53e716ac132e96149ff4.png" />
<img alt="_images/f52b5ca48e587507c87d2ac7f9a714134609024de7bbc8be9a1ce741b37596a2.png" src="_images/f52b5ca48e587507c87d2ac7f9a714134609024de7bbc8be9a1ce741b37596a2.png" />
<img alt="_images/9e23c8ef8ada585355b279376674dc4556f6a51c52345d502a2b60d3493f06a8.png" src="_images/9e23c8ef8ada585355b279376674dc4556f6a51c52345d502a2b60d3493f06a8.png" />
<img alt="_images/f0d5d052395fbb00f27494b2dd7ae5c9a7b47b1dd24e5def784d6ecd535d3ef6.png" src="_images/f0d5d052395fbb00f27494b2dd7ae5c9a7b47b1dd24e5def784d6ecd535d3ef6.png" />
<img alt="_images/f221297e70db9a1833b77b7060cc63cabf897ae7eed4ad40ea3938fb8917065b.png" src="_images/f221297e70db9a1833b77b7060cc63cabf897ae7eed4ad40ea3938fb8917065b.png" />
<img alt="_images/181a795bcc1fc53160e60d815d576b95bf1ddc774433700a87c5f00ba79bdd0a.png" src="_images/181a795bcc1fc53160e60d815d576b95bf1ddc774433700a87c5f00ba79bdd0a.png" />
<img alt="_images/f599b30928110aceab8ce8af2c96f7ef4bb1e6312d0332c100d9e02f6fd5f241.png" src="_images/f599b30928110aceab8ce8af2c96f7ef4bb1e6312d0332c100d9e02f6fd5f241.png" />
<img alt="_images/75025b294a96a91739c419d1f3ab4656fb2d9d100c5e72f101d587365a01ed84.png" src="_images/75025b294a96a91739c419d1f3ab4656fb2d9d100c5e72f101d587365a01ed84.png" />
<img alt="_images/098d2e799cd5bff6e4045d7bb1b47cfe013b1e59dbd007f1544ba4f46c4173bf.png" src="_images/098d2e799cd5bff6e4045d7bb1b47cfe013b1e59dbd007f1544ba4f46c4173bf.png" />
<img alt="_images/bb1d0a1c68869a821479c37cc7ed5b0768d7f7277df66d3cbf9df54471136a05.png" src="_images/bb1d0a1c68869a821479c37cc7ed5b0768d7f7277df66d3cbf9df54471136a05.png" />
<img alt="_images/e7d71c2b5ae3f53d04d48b58b46f23e8b71ce84c42c849228086dcb27369af05.png" src="_images/e7d71c2b5ae3f53d04d48b58b46f23e8b71ce84c42c849228086dcb27369af05.png" />
<img alt="_images/db1c562ec89c42897a6777ea6e512e6860d5534621ce3e8577373a9070ca0241.png" src="_images/db1c562ec89c42897a6777ea6e512e6860d5534621ce3e8577373a9070ca0241.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Análisis de RMSE para Lag 7:
</pre></div>
</div>
<img alt="_images/e31e85baf73e5952d7e9f76ad3f181975df51d727d77a712d205755dcdc2f4eb.png" src="_images/e31e85baf73e5952d7e9f76ad3f181975df51d727d77a712d205755dcdc2f4eb.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Análisis para el lag de 14 días

 Métricas detalladas
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BDS_pvalue_H1</th>
      <th>(H1, MAPE)</th>
      <th>(H1, MAE)</th>
      <th>(H1, RMSE)</th>
      <th>(H1, MSE)</th>
      <th>(H2, MAPE)</th>
      <th>(H2, MAE)</th>
      <th>(H2, RMSE)</th>
      <th>(H2, MSE)</th>
      <th>(H3, MAPE)</th>
      <th>...</th>
      <th>(H5, RMSE)</th>
      <th>(H5, MSE)</th>
      <th>(H6, MAPE)</th>
      <th>(H6, MAE)</th>
      <th>(H6, RMSE)</th>
      <th>(H6, MSE)</th>
      <th>(H7, MAPE)</th>
      <th>(H7, MAE)</th>
      <th>(H7, RMSE)</th>
      <th>(H7, MSE)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Fold 1</th>
      <td>0.8472455573861271</td>
      <td>11.530665</td>
      <td>0.063027</td>
      <td>0.099149</td>
      <td>0.009831</td>
      <td>15.598345</td>
      <td>0.077149</td>
      <td>0.10108</td>
      <td>0.010217</td>
      <td>21.366243</td>
      <td>...</td>
      <td>0.240786</td>
      <td>0.057978</td>
      <td>29.510358</td>
      <td>0.155305</td>
      <td>0.254632</td>
      <td>0.064837</td>
      <td>31.30154</td>
      <td>0.169885</td>
      <td>0.259575</td>
      <td>0.067379</td>
    </tr>
    <tr>
      <th>Fold 2</th>
      <td>0.11406323225537549</td>
      <td>11.742544</td>
      <td>0.062102</td>
      <td>0.098569</td>
      <td>0.009716</td>
      <td>15.384381</td>
      <td>0.079074</td>
      <td>0.116687</td>
      <td>0.013616</td>
      <td>19.983106</td>
      <td>...</td>
      <td>0.193766</td>
      <td>0.037545</td>
      <td>29.572779</td>
      <td>0.155452</td>
      <td>0.205665</td>
      <td>0.042298</td>
      <td>31.220578</td>
      <td>0.161327</td>
      <td>0.212604</td>
      <td>0.0452</td>
    </tr>
    <tr>
      <th>Fold 3</th>
      <td>0.9572961923226825</td>
      <td>10.41246</td>
      <td>0.057698</td>
      <td>0.087594</td>
      <td>0.007673</td>
      <td>14.712195</td>
      <td>0.080936</td>
      <td>0.126902</td>
      <td>0.016104</td>
      <td>17.790542</td>
      <td>...</td>
      <td>0.154702</td>
      <td>0.023933</td>
      <td>28.572262</td>
      <td>0.149245</td>
      <td>0.190985</td>
      <td>0.036475</td>
      <td>30.582995</td>
      <td>0.159644</td>
      <td>0.235505</td>
      <td>0.055462</td>
    </tr>
    <tr>
      <th>Fold 4</th>
      <td>0.15807113740669199</td>
      <td>11.13382</td>
      <td>0.056936</td>
      <td>0.079934</td>
      <td>0.00639</td>
      <td>13.507649</td>
      <td>0.073154</td>
      <td>0.104498</td>
      <td>0.01092</td>
      <td>18.314113</td>
      <td>...</td>
      <td>0.15963</td>
      <td>0.025482</td>
      <td>27.305465</td>
      <td>0.12918</td>
      <td>0.16602</td>
      <td>0.027563</td>
      <td>28.041882</td>
      <td>0.141557</td>
      <td>0.215091</td>
      <td>0.046264</td>
    </tr>
    <tr>
      <th>Fold 5</th>
      <td>0.42357914573162014</td>
      <td>9.194584</td>
      <td>0.050199</td>
      <td>0.076854</td>
      <td>0.005907</td>
      <td>14.577535</td>
      <td>0.083676</td>
      <td>0.127142</td>
      <td>0.016165</td>
      <td>19.695366</td>
      <td>...</td>
      <td>0.217955</td>
      <td>0.047505</td>
      <td>24.661376</td>
      <td>0.1421</td>
      <td>0.213237</td>
      <td>0.04547</td>
      <td>26.560619</td>
      <td>0.152362</td>
      <td>0.220697</td>
      <td>0.048707</td>
    </tr>
    <tr>
      <th>Mean ± Std</th>
      <td>0.5001 ± 0.3468</td>
      <td>10.803 ± 0.923</td>
      <td>0.058 ± 0.005</td>
      <td>0.088 ± 0.009</td>
      <td>0.008 ± 0.002</td>
      <td>14.756 ± 0.734</td>
      <td>0.079 ± 0.004</td>
      <td>0.115 ± 0.011</td>
      <td>0.013 ± 0.003</td>
      <td>19.430 ± 1.270</td>
      <td>...</td>
      <td>0.193 ± 0.033</td>
      <td>0.038 ± 0.013</td>
      <td>27.924 ± 1.827</td>
      <td>0.146 ± 0.010</td>
      <td>0.206 ± 0.029</td>
      <td>0.043 ± 0.012</td>
      <td>29.542 ± 1.905</td>
      <td>0.157 ± 0.010</td>
      <td>0.229 ± 0.017</td>
      <td>0.053 ± 0.008</td>
    </tr>
  </tbody>
</table>
<p>6 rows × 29 columns</p>
</div></div><img alt="_images/eb60fc08beb7e9b92b67dee4e455a5de2b1add3c2c49deddf173b969f47ca37e.png" src="_images/eb60fc08beb7e9b92b67dee4e455a5de2b1add3c2c49deddf173b969f47ca37e.png" />
<img alt="_images/dde39e84069219b2aca7a7e061b72fbc22c3689f3048072a11da38411b593d37.png" src="_images/dde39e84069219b2aca7a7e061b72fbc22c3689f3048072a11da38411b593d37.png" />
<img alt="_images/38cc80fd6409c97200ac8630454c31e85f48f26f33f545ba3aaad5d9edbd7e44.png" src="_images/38cc80fd6409c97200ac8630454c31e85f48f26f33f545ba3aaad5d9edbd7e44.png" />
<img alt="_images/2f3393e0b5fa41f205de28ff5660af3dc069441cebee2f9ccadf02da915e56d6.png" src="_images/2f3393e0b5fa41f205de28ff5660af3dc069441cebee2f9ccadf02da915e56d6.png" />
<img alt="_images/e8c35d1cbcd35b4f6878b77cb7df18670c1306cb1337a0ea2ec4c0619b6a8b06.png" src="_images/e8c35d1cbcd35b4f6878b77cb7df18670c1306cb1337a0ea2ec4c0619b6a8b06.png" />
<img alt="_images/e451fc8e6875d65606d134dae0ded510f6c66d0a6054fa51e4cf3d46ce0c153c.png" src="_images/e451fc8e6875d65606d134dae0ded510f6c66d0a6054fa51e4cf3d46ce0c153c.png" />
<img alt="_images/8a8b7054594d28113f451a660b4304ecd542dc5e3c923e38eb74a0de1d93b028.png" src="_images/8a8b7054594d28113f451a660b4304ecd542dc5e3c923e38eb74a0de1d93b028.png" />
<img alt="_images/ba21da58366ffcc31d6dc54641a0010e668358bb00130c917c7cb0da0515486a.png" src="_images/ba21da58366ffcc31d6dc54641a0010e668358bb00130c917c7cb0da0515486a.png" />
<img alt="_images/8c5f98bb0eff9809cc2cbde01760c137b9f81a38430bf6a4ad9e8bce9ee3a983.png" src="_images/8c5f98bb0eff9809cc2cbde01760c137b9f81a38430bf6a4ad9e8bce9ee3a983.png" />
<img alt="_images/36be38d5a3761e506767cb0e4e19f62bba74e3e7cae75a9d08e0839f8c858972.png" src="_images/36be38d5a3761e506767cb0e4e19f62bba74e3e7cae75a9d08e0839f8c858972.png" />
<img alt="_images/b4d927dc555317cbff14851fcab350a5af199c8dcc19910a9a6aef594c7dfbf1.png" src="_images/b4d927dc555317cbff14851fcab350a5af199c8dcc19910a9a6aef594c7dfbf1.png" />
<img alt="_images/f199fd73086c5847355a57eae77cf525c97b91f0638ea2e6b9a6a380bfebd2c7.png" src="_images/f199fd73086c5847355a57eae77cf525c97b91f0638ea2e6b9a6a380bfebd2c7.png" />
<img alt="_images/2f70560e2be3bf17b89796309c5ccde7da99fb0fb90a08ff80dbbe8e8e7e1570.png" src="_images/2f70560e2be3bf17b89796309c5ccde7da99fb0fb90a08ff80dbbe8e8e7e1570.png" />
<img alt="_images/2ac31c7000eb235a86e71859cf9ace72c8c66186cb3ebf85d7e00ee0a7f99998.png" src="_images/2ac31c7000eb235a86e71859cf9ace72c8c66186cb3ebf85d7e00ee0a7f99998.png" />
<img alt="_images/31a894264a207d45e62f98b28c75f83bd1480ea0f81ec46b613191f846696701.png" src="_images/31a894264a207d45e62f98b28c75f83bd1480ea0f81ec46b613191f846696701.png" />
<img alt="_images/69b58e17f985eff33aa405213f22631e709ab7c4f9535151b1cd3a7f12129b1e.png" src="_images/69b58e17f985eff33aa405213f22631e709ab7c4f9535151b1cd3a7f12129b1e.png" />
<img alt="_images/876ebe9ac9d36d958f9f5d50e20685c0f4f9ccb1557720c2e4a20dbec618cbda.png" src="_images/876ebe9ac9d36d958f9f5d50e20685c0f4f9ccb1557720c2e4a20dbec618cbda.png" />
<img alt="_images/3aa13b0408f2febdbed5ab23367d4e7f32a66b44ac530e74f023ea61e166c25d.png" src="_images/3aa13b0408f2febdbed5ab23367d4e7f32a66b44ac530e74f023ea61e166c25d.png" />
<img alt="_images/5f78dd3020443b82e93bc4441f38a2be7488f61e204729e6276c2dca6cca0843.png" src="_images/5f78dd3020443b82e93bc4441f38a2be7488f61e204729e6276c2dca6cca0843.png" />
<img alt="_images/ae1ee0519ec6649334b8b9c28683b348dd41ed9a76e621bd12f7a4153b77df0e.png" src="_images/ae1ee0519ec6649334b8b9c28683b348dd41ed9a76e621bd12f7a4153b77df0e.png" />
<img alt="_images/044ea703da27ffbf954ba69c5fd492121e7b4dbbb64c09e331b0dc2442e50c0a.png" src="_images/044ea703da27ffbf954ba69c5fd492121e7b4dbbb64c09e331b0dc2442e50c0a.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Análisis de RMSE para Lag 14:
</pre></div>
</div>
<img alt="_images/365810d675f9e50801362db471f89887ddc54cab9db9d7d00fc1330899261642.png" src="_images/365810d675f9e50801362db471f89887ddc54cab9db9d7d00fc1330899261642.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Análisis para el lag de 21 días

 Métricas detalladas
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BDS_pvalue_H1</th>
      <th>(H1, MAPE)</th>
      <th>(H1, MAE)</th>
      <th>(H1, RMSE)</th>
      <th>(H1, MSE)</th>
      <th>(H2, MAPE)</th>
      <th>(H2, MAE)</th>
      <th>(H2, RMSE)</th>
      <th>(H2, MSE)</th>
      <th>(H3, MAPE)</th>
      <th>...</th>
      <th>(H5, RMSE)</th>
      <th>(H5, MSE)</th>
      <th>(H6, MAPE)</th>
      <th>(H6, MAE)</th>
      <th>(H6, RMSE)</th>
      <th>(H6, MSE)</th>
      <th>(H7, MAPE)</th>
      <th>(H7, MAE)</th>
      <th>(H7, RMSE)</th>
      <th>(H7, MSE)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Fold 1</th>
      <td>0.30161219298552766</td>
      <td>13.670281</td>
      <td>0.077437</td>
      <td>0.112513</td>
      <td>0.012659</td>
      <td>16.486104</td>
      <td>0.092192</td>
      <td>0.139272</td>
      <td>0.019397</td>
      <td>14.21669</td>
      <td>...</td>
      <td>0.175406</td>
      <td>0.030767</td>
      <td>25.717116</td>
      <td>0.132819</td>
      <td>0.180872</td>
      <td>0.032715</td>
      <td>32.463018</td>
      <td>0.191431</td>
      <td>0.336208</td>
      <td>0.113036</td>
    </tr>
    <tr>
      <th>Fold 2</th>
      <td>0.6301479711661684</td>
      <td>14.095092</td>
      <td>0.089427</td>
      <td>0.179659</td>
      <td>0.032277</td>
      <td>19.259337</td>
      <td>0.113864</td>
      <td>0.194176</td>
      <td>0.037704</td>
      <td>22.825391</td>
      <td>...</td>
      <td>0.180994</td>
      <td>0.032759</td>
      <td>33.459284</td>
      <td>0.187305</td>
      <td>0.249391</td>
      <td>0.062196</td>
      <td>33.698144</td>
      <td>0.195921</td>
      <td>0.275097</td>
      <td>0.075678</td>
    </tr>
    <tr>
      <th>Fold 3</th>
      <td>0.07110398435072288</td>
      <td>10.410306</td>
      <td>0.0622</td>
      <td>0.083321</td>
      <td>0.006942</td>
      <td>15.295699</td>
      <td>0.081667</td>
      <td>0.1043</td>
      <td>0.010878</td>
      <td>23.272256</td>
      <td>...</td>
      <td>0.197121</td>
      <td>0.038857</td>
      <td>25.21816</td>
      <td>0.157368</td>
      <td>0.224592</td>
      <td>0.050442</td>
      <td>32.913414</td>
      <td>0.178516</td>
      <td>0.225928</td>
      <td>0.051044</td>
    </tr>
    <tr>
      <th>Fold 4</th>
      <td>0.14893564265851084</td>
      <td>10.057531</td>
      <td>0.059096</td>
      <td>0.080773</td>
      <td>0.006524</td>
      <td>13.061391</td>
      <td>0.072077</td>
      <td>0.096048</td>
      <td>0.009225</td>
      <td>20.257182</td>
      <td>...</td>
      <td>0.165214</td>
      <td>0.027296</td>
      <td>23.671549</td>
      <td>0.12741</td>
      <td>0.167186</td>
      <td>0.027951</td>
      <td>26.816208</td>
      <td>0.146855</td>
      <td>0.195773</td>
      <td>0.038327</td>
    </tr>
    <tr>
      <th>Fold 5</th>
      <td>0.437706154677341</td>
      <td>17.467656</td>
      <td>0.090159</td>
      <td>0.118135</td>
      <td>0.013956</td>
      <td>23.884004</td>
      <td>0.113139</td>
      <td>0.147416</td>
      <td>0.021732</td>
      <td>22.72685</td>
      <td>...</td>
      <td>0.163041</td>
      <td>0.026582</td>
      <td>33.126628</td>
      <td>0.141839</td>
      <td>0.189435</td>
      <td>0.035886</td>
      <td>34.688785</td>
      <td>0.146862</td>
      <td>0.184937</td>
      <td>0.034202</td>
    </tr>
    <tr>
      <th>Mean ± Std</th>
      <td>0.3179 ± 0.2008</td>
      <td>13.140 ± 2.716</td>
      <td>0.076 ± 0.013</td>
      <td>0.115 ± 0.036</td>
      <td>0.014 ± 0.009</td>
      <td>17.597 ± 3.725</td>
      <td>0.095 ± 0.017</td>
      <td>0.136 ± 0.035</td>
      <td>0.020 ± 0.010</td>
      <td>20.660 ± 3.390</td>
      <td>...</td>
      <td>0.176 ± 0.012</td>
      <td>0.031 ± 0.004</td>
      <td>28.239 ± 4.183</td>
      <td>0.149 ± 0.022</td>
      <td>0.202 ± 0.030</td>
      <td>0.042 ± 0.013</td>
      <td>32.116 ± 2.756</td>
      <td>0.172 ± 0.021</td>
      <td>0.244 ± 0.056</td>
      <td>0.062 ± 0.029</td>
    </tr>
  </tbody>
</table>
<p>6 rows × 29 columns</p>
</div></div><img alt="_images/67a42ef701a5e8fa333794e4816323602b6b410e2c6cfb5b36be91964b5e19c3.png" src="_images/67a42ef701a5e8fa333794e4816323602b6b410e2c6cfb5b36be91964b5e19c3.png" />
<img alt="_images/b5f520713730b19b8407cecd3278b6a974b0a2501b400db7bf38f19f5844cfb0.png" src="_images/b5f520713730b19b8407cecd3278b6a974b0a2501b400db7bf38f19f5844cfb0.png" />
<img alt="_images/be7e4d4f1abb6e2bb5d0c5d470585fb69d5b86a3e6fc4f57b15c008bb9e6a537.png" src="_images/be7e4d4f1abb6e2bb5d0c5d470585fb69d5b86a3e6fc4f57b15c008bb9e6a537.png" />
<img alt="_images/3a79ec452cf70fb3730e855c991bf6405fca4c61905daa849c25f8350486768b.png" src="_images/3a79ec452cf70fb3730e855c991bf6405fca4c61905daa849c25f8350486768b.png" />
<img alt="_images/616d46916d7a796c402bea8c6d180f4209cc7d8138755f11b1cb96f8e855c335.png" src="_images/616d46916d7a796c402bea8c6d180f4209cc7d8138755f11b1cb96f8e855c335.png" />
<img alt="_images/f6931baf59d9288f162035ae2df12c4f559ece4bbfdf425fbdc59aa057ae24c6.png" src="_images/f6931baf59d9288f162035ae2df12c4f559ece4bbfdf425fbdc59aa057ae24c6.png" />
<img alt="_images/f59291128189fa249a849d59536b6440c4989175328d515b8259233405b8df7b.png" src="_images/f59291128189fa249a849d59536b6440c4989175328d515b8259233405b8df7b.png" />
<img alt="_images/91b5bd75822d016b6986d6b9f777b1f4ecfe7c125822615a1c1cd71aad8634d7.png" src="_images/91b5bd75822d016b6986d6b9f777b1f4ecfe7c125822615a1c1cd71aad8634d7.png" />
<img alt="_images/db61c15746c17f411b859de4cc1396afb37560e8491cf26adb9493ac1cc76fec.png" src="_images/db61c15746c17f411b859de4cc1396afb37560e8491cf26adb9493ac1cc76fec.png" />
<img alt="_images/a90b2be5ae99415dd13d712e20aef0620cf92e799cf61b87e29ded76b023c723.png" src="_images/a90b2be5ae99415dd13d712e20aef0620cf92e799cf61b87e29ded76b023c723.png" />
<img alt="_images/ff448dec38b5e8f819a925edee9b32f56535d14a444ecb1f91273b649d9b4cf0.png" src="_images/ff448dec38b5e8f819a925edee9b32f56535d14a444ecb1f91273b649d9b4cf0.png" />
<img alt="_images/a0d55565ccf0770132f8cc1d9421e92cdacc6bb6c8da7fff73ec093527db1174.png" src="_images/a0d55565ccf0770132f8cc1d9421e92cdacc6bb6c8da7fff73ec093527db1174.png" />
<img alt="_images/a66ad0771f0e7d8fa9b5b2301525ec7aa88c3c64c75409f7beabd995fe992c8d.png" src="_images/a66ad0771f0e7d8fa9b5b2301525ec7aa88c3c64c75409f7beabd995fe992c8d.png" />
<img alt="_images/580fa2c93c1d3ef2d02cf89bb6359aba1cb691b54486984c999d36d17d51b4ba.png" src="_images/580fa2c93c1d3ef2d02cf89bb6359aba1cb691b54486984c999d36d17d51b4ba.png" />
<img alt="_images/bbfb198607f2ba3ada67ae5e47f46457a94c37779b9e29e64d5edaed3729e98b.png" src="_images/bbfb198607f2ba3ada67ae5e47f46457a94c37779b9e29e64d5edaed3729e98b.png" />
<img alt="_images/a959978896e3f3bcda32dea90eef1ec78c280970ea4ad1d6bffd699aa63c9879.png" src="_images/a959978896e3f3bcda32dea90eef1ec78c280970ea4ad1d6bffd699aa63c9879.png" />
<img alt="_images/b50e78f5251370f50dbd53fe9ea335a4c888e240f2db208f6b15684ed2e6f85b.png" src="_images/b50e78f5251370f50dbd53fe9ea335a4c888e240f2db208f6b15684ed2e6f85b.png" />
<img alt="_images/b88f497e11fa055ba950148ff1f12aba4e30d79cfe886255bc1df4ef6113b76d.png" src="_images/b88f497e11fa055ba950148ff1f12aba4e30d79cfe886255bc1df4ef6113b76d.png" />
<img alt="_images/f81a719f67d58eff2d0a2ee1f0bb7b09911778390d72a9d6f81dfff52287291a.png" src="_images/f81a719f67d58eff2d0a2ee1f0bb7b09911778390d72a9d6f81dfff52287291a.png" />
<img alt="_images/e9038bc5a77d531f39c70314040737e1598cda8e70166554d70b36a2d48c10f0.png" src="_images/e9038bc5a77d531f39c70314040737e1598cda8e70166554d70b36a2d48c10f0.png" />
<img alt="_images/f0b04bf7849b10f13c575559f81630dd9a45429f7b6356cd9472cdb9e9494ff0.png" src="_images/f0b04bf7849b10f13c575559f81630dd9a45429f7b6356cd9472cdb9e9494ff0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Análisis de RMSE para Lag 21:
</pre></div>
</div>
<img alt="_images/c196c0a3becb7c1e03896daed45db96fa9c1c2953860a02af0a5b08e95e7d6eb.png" src="_images/c196c0a3becb7c1e03896daed45db96fa9c1c2953860a02af0a5b08e95e7d6eb.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Análisis para el lag de 28 días

 Métricas detalladas
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BDS_pvalue_H1</th>
      <th>(H1, MAPE)</th>
      <th>(H1, MAE)</th>
      <th>(H1, RMSE)</th>
      <th>(H1, MSE)</th>
      <th>(H2, MAPE)</th>
      <th>(H2, MAE)</th>
      <th>(H2, RMSE)</th>
      <th>(H2, MSE)</th>
      <th>(H3, MAPE)</th>
      <th>...</th>
      <th>(H5, RMSE)</th>
      <th>(H5, MSE)</th>
      <th>(H6, MAPE)</th>
      <th>(H6, MAE)</th>
      <th>(H6, RMSE)</th>
      <th>(H6, MSE)</th>
      <th>(H7, MAPE)</th>
      <th>(H7, MAE)</th>
      <th>(H7, RMSE)</th>
      <th>(H7, MSE)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Fold 1</th>
      <td>0.8112287495568389</td>
      <td>20.430219</td>
      <td>0.125014</td>
      <td>0.205712</td>
      <td>0.042318</td>
      <td>25.648603</td>
      <td>0.155136</td>
      <td>0.253678</td>
      <td>0.064353</td>
      <td>28.440898</td>
      <td>...</td>
      <td>0.257834</td>
      <td>0.066479</td>
      <td>32.740178</td>
      <td>0.207446</td>
      <td>0.289952</td>
      <td>0.084072</td>
      <td>34.112737</td>
      <td>0.218841</td>
      <td>0.318408</td>
      <td>0.101383</td>
    </tr>
    <tr>
      <th>Fold 2</th>
      <td>0.4420934198016927</td>
      <td>16.153382</td>
      <td>0.119427</td>
      <td>0.24104</td>
      <td>0.0581</td>
      <td>25.653286</td>
      <td>0.151227</td>
      <td>0.247543</td>
      <td>0.061277</td>
      <td>29.283015</td>
      <td>...</td>
      <td>0.300247</td>
      <td>0.090148</td>
      <td>33.200119</td>
      <td>0.217492</td>
      <td>0.314575</td>
      <td>0.098958</td>
      <td>34.154926</td>
      <td>0.228067</td>
      <td>0.317481</td>
      <td>0.100794</td>
    </tr>
    <tr>
      <th>Fold 3</th>
      <td>0.8269309204317639</td>
      <td>15.265127</td>
      <td>0.136003</td>
      <td>0.359447</td>
      <td>0.129202</td>
      <td>22.241236</td>
      <td>0.181547</td>
      <td>0.402787</td>
      <td>0.162237</td>
      <td>29.472199</td>
      <td>...</td>
      <td>0.431125</td>
      <td>0.185869</td>
      <td>38.988783</td>
      <td>0.276276</td>
      <td>0.454493</td>
      <td>0.206563</td>
      <td>40.352217</td>
      <td>0.284488</td>
      <td>0.457988</td>
      <td>0.209753</td>
    </tr>
    <tr>
      <th>Fold 4</th>
      <td>0.006882576587561791</td>
      <td>14.646689</td>
      <td>0.078006</td>
      <td>0.157128</td>
      <td>0.024689</td>
      <td>17.45409</td>
      <td>0.155376</td>
      <td>0.386321</td>
      <td>0.149244</td>
      <td>21.8531</td>
      <td>...</td>
      <td>0.443546</td>
      <td>0.196733</td>
      <td>36.953006</td>
      <td>0.257865</td>
      <td>0.444886</td>
      <td>0.197923</td>
      <td>40.201061</td>
      <td>0.278931</td>
      <td>0.467316</td>
      <td>0.218385</td>
    </tr>
    <tr>
      <th>Fold 5</th>
      <td>0.6608578505708435</td>
      <td>25.994154</td>
      <td>0.150443</td>
      <td>0.191524</td>
      <td>0.036682</td>
      <td>36.367408</td>
      <td>0.208132</td>
      <td>0.262889</td>
      <td>0.06911</td>
      <td>39.671351</td>
      <td>...</td>
      <td>0.267118</td>
      <td>0.071352</td>
      <td>44.743458</td>
      <td>0.237722</td>
      <td>0.297141</td>
      <td>0.088293</td>
      <td>45.916401</td>
      <td>0.230849</td>
      <td>0.29784</td>
      <td>0.088709</td>
    </tr>
    <tr>
      <th>Mean ± Std</th>
      <td>0.5496 ± 0.3046</td>
      <td>18.498 ± 4.259</td>
      <td>0.122 ± 0.024</td>
      <td>0.231 ± 0.070</td>
      <td>0.058 ± 0.037</td>
      <td>25.473 ± 6.221</td>
      <td>0.170 ± 0.022</td>
      <td>0.311 ± 0.069</td>
      <td>0.101 ± 0.045</td>
      <td>29.744 ± 5.706</td>
      <td>...</td>
      <td>0.340 ± 0.081</td>
      <td>0.122 ± 0.057</td>
      <td>37.325 ± 4.381</td>
      <td>0.239 ± 0.025</td>
      <td>0.360 ± 0.074</td>
      <td>0.135 ± 0.055</td>
      <td>38.947 ± 4.437</td>
      <td>0.248 ± 0.028</td>
      <td>0.372 ± 0.075</td>
      <td>0.144 ± 0.058</td>
    </tr>
  </tbody>
</table>
<p>6 rows × 29 columns</p>
</div></div><img alt="_images/21d3cf0c07deba55327415ee3014f74a4ecaf6bacd06b3344cd0909e86c9ffdb.png" src="_images/21d3cf0c07deba55327415ee3014f74a4ecaf6bacd06b3344cd0909e86c9ffdb.png" />
<img alt="_images/58b82d6fd4de430b97e3e28835385ee903a4f8d706ae10bd657de243776204f9.png" src="_images/58b82d6fd4de430b97e3e28835385ee903a4f8d706ae10bd657de243776204f9.png" />
<img alt="_images/29c8074a50eda7482dcb48bdb0a75c736eb71716e771e062eeb1c7f048092ae9.png" src="_images/29c8074a50eda7482dcb48bdb0a75c736eb71716e771e062eeb1c7f048092ae9.png" />
<img alt="_images/1e2f0223bc1eac3598d65387574f84a09f4cc63ab587fd07ff4cf901bfdb54d6.png" src="_images/1e2f0223bc1eac3598d65387574f84a09f4cc63ab587fd07ff4cf901bfdb54d6.png" />
<img alt="_images/85eacc44960e60c1b810b84e4721946ae1bef53613e403854d707096e60a5eee.png" src="_images/85eacc44960e60c1b810b84e4721946ae1bef53613e403854d707096e60a5eee.png" />
<img alt="_images/61ef230554f0819109e823ffeaed121dabd6c965605762f6a97935d0f31540ba.png" src="_images/61ef230554f0819109e823ffeaed121dabd6c965605762f6a97935d0f31540ba.png" />
<img alt="_images/40fe03c9c8f0e5779c177ad04c1cabf6702e64ebc0f7ff7c45f549211f9e1652.png" src="_images/40fe03c9c8f0e5779c177ad04c1cabf6702e64ebc0f7ff7c45f549211f9e1652.png" />
<img alt="_images/9abe2caf2b997685dcca0ba8ec50f6adb6a6e8008813fb65313f71635ff67462.png" src="_images/9abe2caf2b997685dcca0ba8ec50f6adb6a6e8008813fb65313f71635ff67462.png" />
<img alt="_images/01bda0b08906ceb847594d6c5bcf6b1586476a195c154e1b18ede4db34126264.png" src="_images/01bda0b08906ceb847594d6c5bcf6b1586476a195c154e1b18ede4db34126264.png" />
<img alt="_images/7f3673355e4c81f7fd42bf0cbcedb28276893edd43b32fd0ae3e63382d065d42.png" src="_images/7f3673355e4c81f7fd42bf0cbcedb28276893edd43b32fd0ae3e63382d065d42.png" />
<img alt="_images/1e8aa1b4fafc712b5cc2816fcc78c91e6abaf66302c4b7e6f23e62573a0966fb.png" src="_images/1e8aa1b4fafc712b5cc2816fcc78c91e6abaf66302c4b7e6f23e62573a0966fb.png" />
<img alt="_images/9996b50e7d782d132d1ae8c32ba6ef771a379d3eaa14b5c7bdb420650a5f9017.png" src="_images/9996b50e7d782d132d1ae8c32ba6ef771a379d3eaa14b5c7bdb420650a5f9017.png" />
<img alt="_images/d3fbe8110972d880f82d54323e7c2748cae1780ddcd863b07b79c02ed18bd5c5.png" src="_images/d3fbe8110972d880f82d54323e7c2748cae1780ddcd863b07b79c02ed18bd5c5.png" />
<img alt="_images/3d18bfddec8ca3eedf412a10b1738a21674a069c472b81d9f55dc0fdc3a71e21.png" src="_images/3d18bfddec8ca3eedf412a10b1738a21674a069c472b81d9f55dc0fdc3a71e21.png" />
<img alt="_images/8b4fd7c4edf96146b68beb5a75771a4499be49e720607d40093df4369bfee6d2.png" src="_images/8b4fd7c4edf96146b68beb5a75771a4499be49e720607d40093df4369bfee6d2.png" />
<img alt="_images/d3270c3e77d4946f6f3c71e3319184839bcca49d67de8de5f8b712ee94163bc8.png" src="_images/d3270c3e77d4946f6f3c71e3319184839bcca49d67de8de5f8b712ee94163bc8.png" />
<img alt="_images/547ae32c649563cbad9e2b292fd8c9c13c355f2d17bf33368519ca24c7b56787.png" src="_images/547ae32c649563cbad9e2b292fd8c9c13c355f2d17bf33368519ca24c7b56787.png" />
<img alt="_images/6bc7dd046c096086357edb2c09bddedf3434afdfb3608cb4a52c48da0a9d4e38.png" src="_images/6bc7dd046c096086357edb2c09bddedf3434afdfb3608cb4a52c48da0a9d4e38.png" />
<img alt="_images/4e25ba1592d0b3d2dc84e44f31712a4523f8abfe1a80464695f3e5a5a2d002ce.png" src="_images/4e25ba1592d0b3d2dc84e44f31712a4523f8abfe1a80464695f3e5a5a2d002ce.png" />
<img alt="_images/1ad217d8011c26d5b53738cf34461735653eb2e33907ba17c0a4ea88b43bcafe.png" src="_images/1ad217d8011c26d5b53738cf34461735653eb2e33907ba17c0a4ea88b43bcafe.png" />
<img alt="_images/ce19ce4ae10df80acb737bac7bd8108acea9cfc5c29ff13719d02b9aa635c67e.png" src="_images/ce19ce4ae10df80acb737bac7bd8108acea9cfc5c29ff13719d02b9aa635c67e.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Análisis de RMSE para Lag 28:
</pre></div>
</div>
<img alt="_images/389586e83d42dcf2b1a409be3c61784d87c04c77afd6171b9748ba4931b910ea.png" src="_images/389586e83d42dcf2b1a409be3c61784d87c04c77afd6171b9748ba4931b910ea.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Resumen final para la volatilidad de 14 días:

 Comparación de todos los lags:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAPE_Promedio</th>
      <th>MAE_Promedio</th>
      <th>RMSE_Promedio</th>
      <th>MSE_Promedio</th>
      <th>BDS_pvalue_Promedio</th>
    </tr>
    <tr>
      <th>Lag</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>18.365440</td>
      <td>0.099180</td>
      <td>0.166955</td>
      <td>0.031869</td>
      <td>0.666124</td>
    </tr>
    <tr>
      <th>14</th>
      <td>21.532071</td>
      <td>0.113425</td>
      <td>0.160947</td>
      <td>0.028567</td>
      <td>0.500051</td>
    </tr>
    <tr>
      <th>21</th>
      <td>23.257486</td>
      <td>0.123568</td>
      <td>0.172282</td>
      <td>0.032482</td>
      <td>0.317901</td>
    </tr>
    <tr>
      <th>28</th>
      <td>30.893534</td>
      <td>0.199882</td>
      <td>0.324956</td>
      <td>0.113099</td>
      <td>0.549599</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="id1">
<h4><strong>Interpretaciones</strong><a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<section id="id2">
<h5><strong>Lag 7 días</strong><a class="headerlink" href="#id2" title="Link to this heading">#</a></h5>
<p>Este lag presentó un RMSE promedio de <strong>0.167</strong>. Su mejor Fold fue el 3, con un RMSE de <strong>0.1222</strong>. Se observa que el RMSE tiende a aumentar a medida que avanza el horizonte de predicción, lo que indica que el modelo predice con mayor precisión los días más cercanos. En cuanto al RMSE promedio por Fold, este disminuye levemente hasta el Fold 3, mientras que los restantes muestran valores ligeramente más altos.</p>
</section>
<section id="id3">
<h5><strong>Lag 14 días</strong><a class="headerlink" href="#id3" title="Link to this heading">#</a></h5>
<p>Este lag obtuvo un RMSE promedio de <strong>0.1609</strong>, siendo el mejor para la volatilidad de 14 días. Su mejor Fold fue el 4, con un RMSE de <strong>0.141</strong>, destacándose como el mejor Fold en general para esta volatilidad. Al igual que en el lag de 7 días, los RMSE tienden a aumentar a medida que avanzan los horizontes. Por Fold, los RMSE decrecen en general, excepto en el Fold 5, que presentó el valor más alto, es decir, fue el peor.</p>
</section>
<section id="id4">
<h5><strong>Lag 21 días</strong><a class="headerlink" href="#id4" title="Link to this heading">#</a></h5>
<p>Para esta ventana, el RMSE promedio fue de <strong>0.1722</strong>, mostrando un incremento leve respecto a los lags anteriores. El mejor Fold fue el 4, con un RMSE de <strong>0.150</strong>. Analizando los RMSE por horizonte, se observa un aumento progresivo a medida que transcurren los días, aunque los desempeños entre los horizontes 3 y 4 fueron muy cercanos. Por Fold, el RMSE promedio varía entre los 5 Folds, siendo el Fold 2 el de peor desempeño (<strong>0.209</strong>), mientras que los restantes presentan valores similares entre sí.</p>
</section>
<section id="id5">
<h5><strong>Lag 28 días</strong><a class="headerlink" href="#id5" title="Link to this heading">#</a></h5>
<p>El lag de 28 días presentó el peor desempeño entre los cuatro analizados, con un RMSE promedio de <strong>0.325</strong>. Su mejor Fold fue el 5, con un RMSE de <strong>0.259</strong>, mostrando una diferencia notable respecto a los demás Folds. Al analizar los promedios por Fold, se observa un aumento progresivo hasta el Fold 3, que fue el de peor desempeño, seguido de una ligera disminución en los Folds restantes. Por horizonte, el RMSE aumenta hasta alcanzar su valor máximo en el horizonte 3, disminuye en el horizonte 4 y vuelve a subir ligeramente, manteniéndose todos por encima de los valores de los horizontes anteriores.</p>
</section>
<section id="id6">
<h5><strong>General</strong><a class="headerlink" href="#id6" title="Link to this heading">#</a></h5>
<p>En términos generales, los mejores Folds de cada lag lograron que las líneas predichas siguieran de la mejor manera posible y en la mayoría de los casos los patrones observados. Por otro lado, los Folds con menor desempeño mostraron una capacidad de predicción más limitada, reflejándose en desviaciones más notables respecto a los valores reales.</p>
</section>
</section>
</section>
<section id="volatilidad-de-la-ventana-de-21-dias">
<h3><strong>Volatilidad de la ventana de 21 días</strong><a class="headerlink" href="#volatilidad-de-la-ventana-de-21-dias" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Para volatilidad de 21 días</span>
<span class="n">resultados_21d</span> <span class="o">=</span> <span class="n">resultadosventana</span><span class="p">(</span>
    <span class="n">volatilidad</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span>
    <span class="n">lags_list</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">28</span><span class="p">],</span>
    <span class="n">n_steps_forecast</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
    <span class="n">n_steps_jump</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados para la ventana de volatilidad de 21 días

 El mejor modelo para la volatilidad de 21 días está en el lag de 21 días. (RMSE promedio: 0.1167)

Dentro del lag 21, el mejor fold es el Fold 3 con RMSE: 0.1063

Análisis para el lag de 7 días

 Métricas detalladas
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BDS_pvalue_H1</th>
      <th>(H1, MAPE)</th>
      <th>(H1, MAE)</th>
      <th>(H1, RMSE)</th>
      <th>(H1, MSE)</th>
      <th>(H2, MAPE)</th>
      <th>(H2, MAE)</th>
      <th>(H2, RMSE)</th>
      <th>(H2, MSE)</th>
      <th>(H3, MAPE)</th>
      <th>...</th>
      <th>(H5, RMSE)</th>
      <th>(H5, MSE)</th>
      <th>(H6, MAPE)</th>
      <th>(H6, MAE)</th>
      <th>(H6, RMSE)</th>
      <th>(H6, MSE)</th>
      <th>(H7, MAPE)</th>
      <th>(H7, MAE)</th>
      <th>(H7, RMSE)</th>
      <th>(H7, MSE)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Fold 1</th>
      <td>0.18872600553559238</td>
      <td>5.534103</td>
      <td>0.025682</td>
      <td>0.039331</td>
      <td>0.001547</td>
      <td>7.726402</td>
      <td>0.042422</td>
      <td>0.062668</td>
      <td>0.003927</td>
      <td>11.229049</td>
      <td>...</td>
      <td>0.154308</td>
      <td>0.023811</td>
      <td>18.878071</td>
      <td>0.099775</td>
      <td>0.161031</td>
      <td>0.025931</td>
      <td>19.676619</td>
      <td>0.103176</td>
      <td>0.166562</td>
      <td>0.027743</td>
    </tr>
    <tr>
      <th>Fold 2</th>
      <td>0.9320620801682535</td>
      <td>5.579037</td>
      <td>0.029125</td>
      <td>0.047211</td>
      <td>0.002229</td>
      <td>9.060954</td>
      <td>0.042924</td>
      <td>0.061937</td>
      <td>0.003836</td>
      <td>11.048418</td>
      <td>...</td>
      <td>0.131636</td>
      <td>0.017328</td>
      <td>19.459963</td>
      <td>0.103787</td>
      <td>0.161298</td>
      <td>0.026017</td>
      <td>21.334016</td>
      <td>0.10808</td>
      <td>0.165662</td>
      <td>0.027444</td>
    </tr>
    <tr>
      <th>Fold 3</th>
      <td>0.6145129240246265</td>
      <td>5.318425</td>
      <td>0.025971</td>
      <td>0.038947</td>
      <td>0.001517</td>
      <td>8.548543</td>
      <td>0.043017</td>
      <td>0.060736</td>
      <td>0.003689</td>
      <td>11.131474</td>
      <td>...</td>
      <td>0.11747</td>
      <td>0.013799</td>
      <td>18.79128</td>
      <td>0.099792</td>
      <td>0.144282</td>
      <td>0.020817</td>
      <td>20.766867</td>
      <td>0.108753</td>
      <td>0.167156</td>
      <td>0.027941</td>
    </tr>
    <tr>
      <th>Fold 4</th>
      <td>0.788339189753413</td>
      <td>6.449323</td>
      <td>0.031743</td>
      <td>0.052494</td>
      <td>0.002756</td>
      <td>10.053233</td>
      <td>0.048793</td>
      <td>0.070426</td>
      <td>0.00496</td>
      <td>12.258516</td>
      <td>...</td>
      <td>0.101361</td>
      <td>0.010274</td>
      <td>18.760781</td>
      <td>0.096639</td>
      <td>0.127077</td>
      <td>0.016149</td>
      <td>21.591083</td>
      <td>0.111463</td>
      <td>0.15627</td>
      <td>0.02442</td>
    </tr>
    <tr>
      <th>Fold 5</th>
      <td>0.0010111397593644486</td>
      <td>6.668932</td>
      <td>0.048813</td>
      <td>0.157483</td>
      <td>0.024801</td>
      <td>8.98201</td>
      <td>0.063465</td>
      <td>0.178343</td>
      <td>0.031806</td>
      <td>9.760443</td>
      <td>...</td>
      <td>0.191123</td>
      <td>0.036528</td>
      <td>16.129288</td>
      <td>0.107114</td>
      <td>0.21588</td>
      <td>0.046604</td>
      <td>16.421058</td>
      <td>0.106989</td>
      <td>0.207305</td>
      <td>0.042975</td>
    </tr>
    <tr>
      <th>Mean ± Std</th>
      <td>0.5049 ± 0.3546</td>
      <td>5.910 ± 0.542</td>
      <td>0.032 ± 0.009</td>
      <td>0.067 ± 0.045</td>
      <td>0.007 ± 0.009</td>
      <td>8.874 ± 0.756</td>
      <td>0.048 ± 0.008</td>
      <td>0.087 ± 0.046</td>
      <td>0.010 ± 0.011</td>
      <td>11.086 ± 0.794</td>
      <td>...</td>
      <td>0.139 ± 0.031</td>
      <td>0.020 ± 0.009</td>
      <td>18.404 ± 1.165</td>
      <td>0.101 ± 0.004</td>
      <td>0.162 ± 0.030</td>
      <td>0.027 ± 0.010</td>
      <td>19.958 ± 1.887</td>
      <td>0.108 ± 0.003</td>
      <td>0.173 ± 0.018</td>
      <td>0.030 ± 0.007</td>
    </tr>
  </tbody>
</table>
<p>6 rows × 29 columns</p>
</div></div><img alt="_images/2dab74235672299a59b93fb32d5236e747f46c17566928ff117f746126452acb.png" src="_images/2dab74235672299a59b93fb32d5236e747f46c17566928ff117f746126452acb.png" />
<img alt="_images/ce091e333548e47fbe9b0dc24ba68b833d0210f6a6974008f9465208f4683e01.png" src="_images/ce091e333548e47fbe9b0dc24ba68b833d0210f6a6974008f9465208f4683e01.png" />
<img alt="_images/1969657cdc3714b6f125ea121d6f42c71ea1977b1d749dbff7b8d0b2b6b92228.png" src="_images/1969657cdc3714b6f125ea121d6f42c71ea1977b1d749dbff7b8d0b2b6b92228.png" />
<img alt="_images/67b7c535159088c5deebb36f884de7c6555a0c5efefb7ea028db47ea24331e8a.png" src="_images/67b7c535159088c5deebb36f884de7c6555a0c5efefb7ea028db47ea24331e8a.png" />
<img alt="_images/82ef4c5372406a04c15a8179f3be38822fa41460f984390923bb2b15693f5c71.png" src="_images/82ef4c5372406a04c15a8179f3be38822fa41460f984390923bb2b15693f5c71.png" />
<img alt="_images/84d7dbaaa178e4e4d311fd9d5a3cf32adf07f7ab037a4d821503e66989fb40ae.png" src="_images/84d7dbaaa178e4e4d311fd9d5a3cf32adf07f7ab037a4d821503e66989fb40ae.png" />
<img alt="_images/1ca0df8b229f0affb3e534cd6d4f1dce0d654a8f1aff6ad1b07e55b15ccc6ac4.png" src="_images/1ca0df8b229f0affb3e534cd6d4f1dce0d654a8f1aff6ad1b07e55b15ccc6ac4.png" />
<img alt="_images/0a1c23c3f95c9264ac63219892ee413830e08d05dc1352bf3c775c8cff2237bc.png" src="_images/0a1c23c3f95c9264ac63219892ee413830e08d05dc1352bf3c775c8cff2237bc.png" />
<img alt="_images/5168ad7aaa947c3448fd4cb86a9ebcabaebb590b64251ff8d132129109f15cc2.png" src="_images/5168ad7aaa947c3448fd4cb86a9ebcabaebb590b64251ff8d132129109f15cc2.png" />
<img alt="_images/075dff5d8952b01c18e96ec10b6d5b4e426e2175735898f733fe61f9fb331fd4.png" src="_images/075dff5d8952b01c18e96ec10b6d5b4e426e2175735898f733fe61f9fb331fd4.png" />
<img alt="_images/60240c54d38f911e2c63a991555903ee2456f10a8d5272a9b2ed4c47c6af9ae1.png" src="_images/60240c54d38f911e2c63a991555903ee2456f10a8d5272a9b2ed4c47c6af9ae1.png" />
<img alt="_images/4ed5943bae3f8344a4aada97256d1fc013ffcf3d97d93a94053fc084cd5a8799.png" src="_images/4ed5943bae3f8344a4aada97256d1fc013ffcf3d97d93a94053fc084cd5a8799.png" />
<img alt="_images/abea08e4eef7e37186b122dfbbb1a7818f95e31a6cdc90ab535f4e82bc1ab1e4.png" src="_images/abea08e4eef7e37186b122dfbbb1a7818f95e31a6cdc90ab535f4e82bc1ab1e4.png" />
<img alt="_images/474e0e010e52d731612731625335662eb806845b282c666683e0a31888fcef67.png" src="_images/474e0e010e52d731612731625335662eb806845b282c666683e0a31888fcef67.png" />
<img alt="_images/ec20414fca4a3f3b5a292444f1053359c6b21421d85314c79dd284f6eab51f08.png" src="_images/ec20414fca4a3f3b5a292444f1053359c6b21421d85314c79dd284f6eab51f08.png" />
<img alt="_images/76504c57efe69a6340baf4d01f36ee18cd088cdb7ea1c76cc7106df87e8c2c1f.png" src="_images/76504c57efe69a6340baf4d01f36ee18cd088cdb7ea1c76cc7106df87e8c2c1f.png" />
<img alt="_images/bec10e148f823aebfe1bb9c1d2a03be5f3a507a6f53e9a04b643565c00d3fdcd.png" src="_images/bec10e148f823aebfe1bb9c1d2a03be5f3a507a6f53e9a04b643565c00d3fdcd.png" />
<img alt="_images/92fde752e985582e61b098c55f6a180d8814e4acf8726c901900add048bf779e.png" src="_images/92fde752e985582e61b098c55f6a180d8814e4acf8726c901900add048bf779e.png" />
<img alt="_images/8329396bb7fb3480d2d6ffe32f3884d2879d03ab3eee69e8ff28971f64411d7a.png" src="_images/8329396bb7fb3480d2d6ffe32f3884d2879d03ab3eee69e8ff28971f64411d7a.png" />
<img alt="_images/dc629ed49335f12bfe8e74303d1b0eb1faecdbe63101d5b3e301b86c9c4e22c5.png" src="_images/dc629ed49335f12bfe8e74303d1b0eb1faecdbe63101d5b3e301b86c9c4e22c5.png" />
<img alt="_images/18bb998f3fc4b39ef579f35a7a300005e6da859df63d326165254c84821ff43a.png" src="_images/18bb998f3fc4b39ef579f35a7a300005e6da859df63d326165254c84821ff43a.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Análisis de RMSE para Lag 7:
</pre></div>
</div>
<img alt="_images/9ba370698e2cbd5ad4da958a6440ddfbd28a8a7f04b9ffbbec1220d65005d808.png" src="_images/9ba370698e2cbd5ad4da958a6440ddfbd28a8a7f04b9ffbbec1220d65005d808.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Análisis para el lag de 14 días

 Métricas detalladas
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BDS_pvalue_H1</th>
      <th>(H1, MAPE)</th>
      <th>(H1, MAE)</th>
      <th>(H1, RMSE)</th>
      <th>(H1, MSE)</th>
      <th>(H2, MAPE)</th>
      <th>(H2, MAE)</th>
      <th>(H2, RMSE)</th>
      <th>(H2, MSE)</th>
      <th>(H3, MAPE)</th>
      <th>...</th>
      <th>(H5, RMSE)</th>
      <th>(H5, MSE)</th>
      <th>(H6, MAPE)</th>
      <th>(H6, MAE)</th>
      <th>(H6, RMSE)</th>
      <th>(H6, MSE)</th>
      <th>(H7, MAPE)</th>
      <th>(H7, MAE)</th>
      <th>(H7, RMSE)</th>
      <th>(H7, MSE)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Fold 1</th>
      <td>0.5949221551283437</td>
      <td>6.467553</td>
      <td>0.03716</td>
      <td>0.060451</td>
      <td>0.003654</td>
      <td>13.923576</td>
      <td>0.079884</td>
      <td>0.201762</td>
      <td>0.040708</td>
      <td>14.373294</td>
      <td>...</td>
      <td>0.246683</td>
      <td>0.060853</td>
      <td>18.525389</td>
      <td>0.109966</td>
      <td>0.253391</td>
      <td>0.064207</td>
      <td>21.086344</td>
      <td>0.12512</td>
      <td>0.269923</td>
      <td>0.072858</td>
    </tr>
    <tr>
      <th>Fold 2</th>
      <td>0.280972695072475</td>
      <td>5.659138</td>
      <td>0.032715</td>
      <td>0.043423</td>
      <td>0.001886</td>
      <td>9.112243</td>
      <td>0.049538</td>
      <td>0.0717</td>
      <td>0.005141</td>
      <td>15.402207</td>
      <td>...</td>
      <td>0.243816</td>
      <td>0.059446</td>
      <td>16.575399</td>
      <td>0.103778</td>
      <td>0.25911</td>
      <td>0.067138</td>
      <td>18.245043</td>
      <td>0.112668</td>
      <td>0.267509</td>
      <td>0.071561</td>
    </tr>
    <tr>
      <th>Fold 3</th>
      <td>0.1473078880355856</td>
      <td>7.365965</td>
      <td>0.03258</td>
      <td>0.04708</td>
      <td>0.002217</td>
      <td>11.170993</td>
      <td>0.054893</td>
      <td>0.070411</td>
      <td>0.004958</td>
      <td>12.363943</td>
      <td>...</td>
      <td>0.240989</td>
      <td>0.058076</td>
      <td>21.231989</td>
      <td>0.122996</td>
      <td>0.252496</td>
      <td>0.063754</td>
      <td>18.522892</td>
      <td>0.112614</td>
      <td>0.23982</td>
      <td>0.057514</td>
    </tr>
    <tr>
      <th>Fold 4</th>
      <td>0.04582293646203889</td>
      <td>5.428687</td>
      <td>0.02869</td>
      <td>0.039426</td>
      <td>0.001554</td>
      <td>8.743142</td>
      <td>0.045447</td>
      <td>0.061606</td>
      <td>0.003795</td>
      <td>11.422942</td>
      <td>...</td>
      <td>0.17863</td>
      <td>0.031909</td>
      <td>20.534968</td>
      <td>0.107823</td>
      <td>0.210667</td>
      <td>0.04438</td>
      <td>19.914169</td>
      <td>0.112619</td>
      <td>0.215091</td>
      <td>0.046264</td>
    </tr>
    <tr>
      <th>Fold 5</th>
      <td>0.00510373233059793</td>
      <td>8.992726</td>
      <td>0.050192</td>
      <td>0.072561</td>
      <td>0.005265</td>
      <td>9.882953</td>
      <td>0.071245</td>
      <td>0.138271</td>
      <td>0.019119</td>
      <td>11.964784</td>
      <td>...</td>
      <td>0.169262</td>
      <td>0.02865</td>
      <td>17.124839</td>
      <td>0.107564</td>
      <td>0.161141</td>
      <td>0.025966</td>
      <td>19.075003</td>
      <td>0.118784</td>
      <td>0.172731</td>
      <td>0.029836</td>
    </tr>
    <tr>
      <th>Mean ± Std</th>
      <td>0.2148 ± 0.2126</td>
      <td>6.783 ± 1.298</td>
      <td>0.036 ± 0.007</td>
      <td>0.053 ± 0.012</td>
      <td>0.003 ± 0.001</td>
      <td>10.567 ± 1.873</td>
      <td>0.060 ± 0.013</td>
      <td>0.109 ± 0.054</td>
      <td>0.015 ± 0.014</td>
      <td>13.105 ± 1.521</td>
      <td>...</td>
      <td>0.216 ± 0.034</td>
      <td>0.048 ± 0.014</td>
      <td>18.799 ± 1.831</td>
      <td>0.110 ± 0.007</td>
      <td>0.227 ± 0.037</td>
      <td>0.053 ± 0.016</td>
      <td>19.369 ± 1.031</td>
      <td>0.116 ± 0.005</td>
      <td>0.233 ± 0.036</td>
      <td>0.056 ± 0.016</td>
    </tr>
  </tbody>
</table>
<p>6 rows × 29 columns</p>
</div></div><img alt="_images/097e2e7e152a6ee92f85ebda754b23e63e01d1a44704fcf459252e37fc9e69d8.png" src="_images/097e2e7e152a6ee92f85ebda754b23e63e01d1a44704fcf459252e37fc9e69d8.png" />
<img alt="_images/c488cb42f08e08044a90ad661ebc46cb8e9afb4c6055346c54bc455e7f229f8a.png" src="_images/c488cb42f08e08044a90ad661ebc46cb8e9afb4c6055346c54bc455e7f229f8a.png" />
<img alt="_images/f0a318f804c9689f43cfa7e8f7f5a56ea3517e35ba480caaf5f1a874ea3cc1cd.png" src="_images/f0a318f804c9689f43cfa7e8f7f5a56ea3517e35ba480caaf5f1a874ea3cc1cd.png" />
<img alt="_images/1f7ab6bbb5324066556d1bc2d196266c2bba2f6ce47130058e2fe339fd32c156.png" src="_images/1f7ab6bbb5324066556d1bc2d196266c2bba2f6ce47130058e2fe339fd32c156.png" />
<img alt="_images/29794747216f92be934077ae7f06846bea6d70b8b068ace4c4cf1e5d77074b9c.png" src="_images/29794747216f92be934077ae7f06846bea6d70b8b068ace4c4cf1e5d77074b9c.png" />
<img alt="_images/0e9629fe4852297376fe127e1990dab346cb29be9887279a73e87489e42897df.png" src="_images/0e9629fe4852297376fe127e1990dab346cb29be9887279a73e87489e42897df.png" />
<img alt="_images/815c4b740f2365e0af4e86ffdd6b4812b4abb7b89a65344868e754f4fbdcc985.png" src="_images/815c4b740f2365e0af4e86ffdd6b4812b4abb7b89a65344868e754f4fbdcc985.png" />
<img alt="_images/83f8991ef4cb92ba7f1860498183c3e0a6b4d0ca43d8a9e9defb8d1f54ac3649.png" src="_images/83f8991ef4cb92ba7f1860498183c3e0a6b4d0ca43d8a9e9defb8d1f54ac3649.png" />
<img alt="_images/48840c12291a74360ed5c0d5b93f23c7130c1f8200c69ed255c7ea62e608706e.png" src="_images/48840c12291a74360ed5c0d5b93f23c7130c1f8200c69ed255c7ea62e608706e.png" />
<img alt="_images/714e0bd6f65bbb07562b83c901b4ca6e69a6a2a10cd616b97aba9abbde9ffc23.png" src="_images/714e0bd6f65bbb07562b83c901b4ca6e69a6a2a10cd616b97aba9abbde9ffc23.png" />
<img alt="_images/5f5ba26820b642756b6d279d9f18ac1027a372082247f86a06f1745e295508fd.png" src="_images/5f5ba26820b642756b6d279d9f18ac1027a372082247f86a06f1745e295508fd.png" />
<img alt="_images/373ce164890fdb2fe79e9ad612e20408756bc8ed56c5f12cdbf3d742a070115f.png" src="_images/373ce164890fdb2fe79e9ad612e20408756bc8ed56c5f12cdbf3d742a070115f.png" />
<img alt="_images/c2120cf304a926e1e25e6e264c6c1d5d1ff16a8016a49c5d5a84e863c491e744.png" src="_images/c2120cf304a926e1e25e6e264c6c1d5d1ff16a8016a49c5d5a84e863c491e744.png" />
<img alt="_images/4a8d3dea2e6843e8715efb704f4409fcd031ba96ebcc6716509d981a0148434f.png" src="_images/4a8d3dea2e6843e8715efb704f4409fcd031ba96ebcc6716509d981a0148434f.png" />
<img alt="_images/2545414d05242365e72bd9ae72cdad6b9c56a9b8a947177c09784b90160804ab.png" src="_images/2545414d05242365e72bd9ae72cdad6b9c56a9b8a947177c09784b90160804ab.png" />
<img alt="_images/1042efeaa6252c4e18d37d517aa654a30d24980139fbda4910a76df4f743a242.png" src="_images/1042efeaa6252c4e18d37d517aa654a30d24980139fbda4910a76df4f743a242.png" />
<img alt="_images/690e19f734199db79b48bc4432408925c6199b551eea574c8f3b07c51da061be.png" src="_images/690e19f734199db79b48bc4432408925c6199b551eea574c8f3b07c51da061be.png" />
<img alt="_images/1148baa5f21e0f47b0480f0900332a81bf147e116053c743876d4743eee9a758.png" src="_images/1148baa5f21e0f47b0480f0900332a81bf147e116053c743876d4743eee9a758.png" />
<img alt="_images/fd47e0b52166f44e3a752d972294e5e0d7aeb17e682addc40547836424e9314c.png" src="_images/fd47e0b52166f44e3a752d972294e5e0d7aeb17e682addc40547836424e9314c.png" />
<img alt="_images/52437fc92c4781877940c74c791cfbe2b3b27b10a0c87ad00bedf22f4964dfc5.png" src="_images/52437fc92c4781877940c74c791cfbe2b3b27b10a0c87ad00bedf22f4964dfc5.png" />
<img alt="_images/3f6bbd8802628067eba8a9161143b19fc1320f2e207d74623009d55f0bb9ee9a.png" src="_images/3f6bbd8802628067eba8a9161143b19fc1320f2e207d74623009d55f0bb9ee9a.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Análisis de RMSE para Lag 14:
</pre></div>
</div>
<img alt="_images/ed69e5ef44ff63c65101d1d8c6b19eef75ae5549a7eeffab68d1d457ac509b85.png" src="_images/ed69e5ef44ff63c65101d1d8c6b19eef75ae5549a7eeffab68d1d457ac509b85.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Análisis para el lag de 21 días

 Métricas detalladas
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BDS_pvalue_H1</th>
      <th>(H1, MAPE)</th>
      <th>(H1, MAE)</th>
      <th>(H1, RMSE)</th>
      <th>(H1, MSE)</th>
      <th>(H2, MAPE)</th>
      <th>(H2, MAE)</th>
      <th>(H2, RMSE)</th>
      <th>(H2, MSE)</th>
      <th>(H3, MAPE)</th>
      <th>...</th>
      <th>(H5, RMSE)</th>
      <th>(H5, MSE)</th>
      <th>(H6, MAPE)</th>
      <th>(H6, MAE)</th>
      <th>(H6, RMSE)</th>
      <th>(H6, MSE)</th>
      <th>(H7, MAPE)</th>
      <th>(H7, MAE)</th>
      <th>(H7, RMSE)</th>
      <th>(H7, MSE)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Fold 1</th>
      <td>0.2758464233078627</td>
      <td>7.770165</td>
      <td>0.049515</td>
      <td>0.076598</td>
      <td>0.005867</td>
      <td>11.04607</td>
      <td>0.074344</td>
      <td>0.126042</td>
      <td>0.015887</td>
      <td>13.342252</td>
      <td>...</td>
      <td>0.120748</td>
      <td>0.01458</td>
      <td>18.308701</td>
      <td>0.106709</td>
      <td>0.140246</td>
      <td>0.019669</td>
      <td>19.219756</td>
      <td>0.115058</td>
      <td>0.166986</td>
      <td>0.027884</td>
    </tr>
    <tr>
      <th>Fold 2</th>
      <td>0.07180481449858457</td>
      <td>9.597182</td>
      <td>0.052383</td>
      <td>0.067227</td>
      <td>0.00452</td>
      <td>10.608325</td>
      <td>0.077018</td>
      <td>0.137099</td>
      <td>0.018796</td>
      <td>12.750174</td>
      <td>...</td>
      <td>0.144849</td>
      <td>0.020981</td>
      <td>19.52679</td>
      <td>0.127347</td>
      <td>0.198697</td>
      <td>0.03948</td>
      <td>20.53456</td>
      <td>0.127213</td>
      <td>0.174508</td>
      <td>0.030453</td>
    </tr>
    <tr>
      <th>Fold 3</th>
      <td>0.6527340508319626</td>
      <td>9.535148</td>
      <td>0.044265</td>
      <td>0.055203</td>
      <td>0.003047</td>
      <td>13.055139</td>
      <td>0.062671</td>
      <td>0.077159</td>
      <td>0.005954</td>
      <td>14.345814</td>
      <td>...</td>
      <td>0.121907</td>
      <td>0.014861</td>
      <td>17.116975</td>
      <td>0.092233</td>
      <td>0.109867</td>
      <td>0.012071</td>
      <td>21.662885</td>
      <td>0.117588</td>
      <td>0.145045</td>
      <td>0.021038</td>
    </tr>
    <tr>
      <th>Fold 4</th>
      <td>0.02100040441277664</td>
      <td>7.820204</td>
      <td>0.045696</td>
      <td>0.062474</td>
      <td>0.003903</td>
      <td>9.43157</td>
      <td>0.04687</td>
      <td>0.058801</td>
      <td>0.003458</td>
      <td>13.309925</td>
      <td>...</td>
      <td>0.123137</td>
      <td>0.015163</td>
      <td>19.878943</td>
      <td>0.104313</td>
      <td>0.130189</td>
      <td>0.016949</td>
      <td>19.523335</td>
      <td>0.110729</td>
      <td>0.14123</td>
      <td>0.019946</td>
    </tr>
    <tr>
      <th>Fold 5</th>
      <td>0.036775425488456234</td>
      <td>11.687793</td>
      <td>0.062002</td>
      <td>0.085382</td>
      <td>0.00729</td>
      <td>11.916331</td>
      <td>0.066468</td>
      <td>0.094372</td>
      <td>0.008906</td>
      <td>13.808449</td>
      <td>...</td>
      <td>0.127147</td>
      <td>0.016166</td>
      <td>22.843351</td>
      <td>0.11083</td>
      <td>0.141331</td>
      <td>0.019974</td>
      <td>23.040831</td>
      <td>0.105237</td>
      <td>0.124839</td>
      <td>0.015585</td>
    </tr>
    <tr>
      <th>Mean ± Std</th>
      <td>0.2116 ± 0.2388</td>
      <td>9.282 ± 1.440</td>
      <td>0.051 ± 0.006</td>
      <td>0.069 ± 0.011</td>
      <td>0.005 ± 0.001</td>
      <td>11.211 ± 1.221</td>
      <td>0.065 ± 0.011</td>
      <td>0.099 ± 0.029</td>
      <td>0.011 ± 0.006</td>
      <td>13.511 ± 0.535</td>
      <td>...</td>
      <td>0.128 ± 0.009</td>
      <td>0.016 ± 0.002</td>
      <td>19.535 ± 1.919</td>
      <td>0.108 ± 0.011</td>
      <td>0.144 ± 0.030</td>
      <td>0.022 ± 0.009</td>
      <td>20.796 ± 1.412</td>
      <td>0.115 ± 0.007</td>
      <td>0.151 ± 0.018</td>
      <td>0.023 ± 0.005</td>
    </tr>
  </tbody>
</table>
<p>6 rows × 29 columns</p>
</div></div><img alt="_images/a2d1871c78c0ef135d7b3788c8bd3e9a0e6216de082bb745696d128a085b2d01.png" src="_images/a2d1871c78c0ef135d7b3788c8bd3e9a0e6216de082bb745696d128a085b2d01.png" />
<img alt="_images/5814f689e2d1416dfa2ab82389d5557c38c970993b7245f8c317f50b9be9cd22.png" src="_images/5814f689e2d1416dfa2ab82389d5557c38c970993b7245f8c317f50b9be9cd22.png" />
<img alt="_images/62c10b0e15c517c88577cdd6c06556ab2245424171dcb087bae9e9956fff333a.png" src="_images/62c10b0e15c517c88577cdd6c06556ab2245424171dcb087bae9e9956fff333a.png" />
<img alt="_images/f9a0a1fba93b32d8cd8c7484d552867991bf876c5b5f459dab27b6b1dbb6c40b.png" src="_images/f9a0a1fba93b32d8cd8c7484d552867991bf876c5b5f459dab27b6b1dbb6c40b.png" />
<img alt="_images/82d7d2f4ba00a0c11a2b208c55384a8b4afd3411de6fb66b6e8a0c9fe8df6804.png" src="_images/82d7d2f4ba00a0c11a2b208c55384a8b4afd3411de6fb66b6e8a0c9fe8df6804.png" />
<img alt="_images/a2869754b3773cf1f3dfd50238138daaf98f6846ccf352be4297ef23c1daa264.png" src="_images/a2869754b3773cf1f3dfd50238138daaf98f6846ccf352be4297ef23c1daa264.png" />
<img alt="_images/9d0ff511d3a57149f8c07f0aac30452205e943dc76988242474faca39f7e3a15.png" src="_images/9d0ff511d3a57149f8c07f0aac30452205e943dc76988242474faca39f7e3a15.png" />
<img alt="_images/cf3c7e9c2461807fe91dd7aef9b19352fc831f3eecce7785486a4c5c279ada7a.png" src="_images/cf3c7e9c2461807fe91dd7aef9b19352fc831f3eecce7785486a4c5c279ada7a.png" />
<img alt="_images/121063c970b57d2f4b2d936405a571224ccc664107610c44c17a627fd8a5dfdd.png" src="_images/121063c970b57d2f4b2d936405a571224ccc664107610c44c17a627fd8a5dfdd.png" />
<img alt="_images/25f0019401fe5046ea88c9f14fb488f870dddedde1a7be6cebea79f6531f09e1.png" src="_images/25f0019401fe5046ea88c9f14fb488f870dddedde1a7be6cebea79f6531f09e1.png" />
<img alt="_images/d88c995166ad2ccc624c7bbad9853452faa7f1472a1f77da1b760921c21ddfcb.png" src="_images/d88c995166ad2ccc624c7bbad9853452faa7f1472a1f77da1b760921c21ddfcb.png" />
<img alt="_images/17c705a793eaeea541dc718747cd4f9479ba899981df571903e50f6631ef529c.png" src="_images/17c705a793eaeea541dc718747cd4f9479ba899981df571903e50f6631ef529c.png" />
<img alt="_images/beaf9c4bbfabf67a61c95981fe3a8be37de568518a3cb15aa2313a6210ff4afa.png" src="_images/beaf9c4bbfabf67a61c95981fe3a8be37de568518a3cb15aa2313a6210ff4afa.png" />
<img alt="_images/b14ef038be7babf711059b358eb480a16f2f4a438dc32839fcfdd0cfd6db1d38.png" src="_images/b14ef038be7babf711059b358eb480a16f2f4a438dc32839fcfdd0cfd6db1d38.png" />
<img alt="_images/dd388869329c8a26d6a3de895ae32457895563fced1b8fbc3190572aeddf9bf6.png" src="_images/dd388869329c8a26d6a3de895ae32457895563fced1b8fbc3190572aeddf9bf6.png" />
<img alt="_images/de2643f6831c20dc58300362d8d9deae8c9db1e0d595f81df2cf9cdfa37a48c9.png" src="_images/de2643f6831c20dc58300362d8d9deae8c9db1e0d595f81df2cf9cdfa37a48c9.png" />
<img alt="_images/d05ed409d6b633b028a1beba871412682d2c283cce0e16d6c31ea161e34da568.png" src="_images/d05ed409d6b633b028a1beba871412682d2c283cce0e16d6c31ea161e34da568.png" />
<img alt="_images/48de9e1503ee0596f5c3b5716568f172fdfc68129ec7f4fa1bb2e4f9123e3dde.png" src="_images/48de9e1503ee0596f5c3b5716568f172fdfc68129ec7f4fa1bb2e4f9123e3dde.png" />
<img alt="_images/549cb5ad514ebff0ac0d59e0be099ad03bb48de187ab500ba61fd376c841cebe.png" src="_images/549cb5ad514ebff0ac0d59e0be099ad03bb48de187ab500ba61fd376c841cebe.png" />
<img alt="_images/5359d950b5edd0dcfe87604c014422702730aa373df7b8ecdc687babafc2bc15.png" src="_images/5359d950b5edd0dcfe87604c014422702730aa373df7b8ecdc687babafc2bc15.png" />
<img alt="_images/4680a465299243a87e379bfcaf927b825b9fc6462d37ff65f0d98eb7de3836ac.png" src="_images/4680a465299243a87e379bfcaf927b825b9fc6462d37ff65f0d98eb7de3836ac.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Análisis de RMSE para Lag 21:
</pre></div>
</div>
<img alt="_images/c5e682712b913e709ddcff888671af0ca4c45fcff168d0db3ad21dcafeebafb9.png" src="_images/c5e682712b913e709ddcff888671af0ca4c45fcff168d0db3ad21dcafeebafb9.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Análisis para el lag de 28 días

 Métricas detalladas
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BDS_pvalue_H1</th>
      <th>(H1, MAPE)</th>
      <th>(H1, MAE)</th>
      <th>(H1, RMSE)</th>
      <th>(H1, MSE)</th>
      <th>(H2, MAPE)</th>
      <th>(H2, MAE)</th>
      <th>(H2, RMSE)</th>
      <th>(H2, MSE)</th>
      <th>(H3, MAPE)</th>
      <th>...</th>
      <th>(H5, RMSE)</th>
      <th>(H5, MSE)</th>
      <th>(H6, MAPE)</th>
      <th>(H6, MAE)</th>
      <th>(H6, RMSE)</th>
      <th>(H6, MSE)</th>
      <th>(H7, MAPE)</th>
      <th>(H7, MAE)</th>
      <th>(H7, RMSE)</th>
      <th>(H7, MSE)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Fold 1</th>
      <td>0.6768963170879734</td>
      <td>12.881138</td>
      <td>0.084516</td>
      <td>0.180345</td>
      <td>0.032524</td>
      <td>19.299933</td>
      <td>0.11789</td>
      <td>0.212412</td>
      <td>0.045119</td>
      <td>18.631846</td>
      <td>...</td>
      <td>0.200358</td>
      <td>0.040143</td>
      <td>20.836959</td>
      <td>0.148239</td>
      <td>0.227051</td>
      <td>0.051552</td>
      <td>22.424438</td>
      <td>0.169055</td>
      <td>0.280978</td>
      <td>0.078949</td>
    </tr>
    <tr>
      <th>Fold 2</th>
      <td>0.8269309204317639</td>
      <td>11.659002</td>
      <td>0.08322</td>
      <td>0.196714</td>
      <td>0.038697</td>
      <td>16.700735</td>
      <td>0.099775</td>
      <td>0.20803</td>
      <td>0.043276</td>
      <td>22.316277</td>
      <td>...</td>
      <td>0.262401</td>
      <td>0.068855</td>
      <td>21.709211</td>
      <td>0.151627</td>
      <td>0.260293</td>
      <td>0.067752</td>
      <td>23.899242</td>
      <td>0.169259</td>
      <td>0.271502</td>
      <td>0.073713</td>
    </tr>
    <tr>
      <th>Fold 3</th>
      <td>0.8269309204317639</td>
      <td>11.818449</td>
      <td>0.109467</td>
      <td>0.294574</td>
      <td>0.086774</td>
      <td>16.072699</td>
      <td>0.130205</td>
      <td>0.316982</td>
      <td>0.100478</td>
      <td>20.765254</td>
      <td>...</td>
      <td>0.344665</td>
      <td>0.118794</td>
      <td>22.987134</td>
      <td>0.173938</td>
      <td>0.348725</td>
      <td>0.121609</td>
      <td>25.770315</td>
      <td>0.197669</td>
      <td>0.360154</td>
      <td>0.129711</td>
    </tr>
    <tr>
      <th>Fold 4</th>
      <td>0.018229722043402525</td>
      <td>10.085104</td>
      <td>0.065964</td>
      <td>0.129049</td>
      <td>0.016654</td>
      <td>12.137605</td>
      <td>0.112892</td>
      <td>0.29795</td>
      <td>0.088774</td>
      <td>16.843556</td>
      <td>...</td>
      <td>0.346342</td>
      <td>0.119953</td>
      <td>25.431989</td>
      <td>0.184777</td>
      <td>0.34799</td>
      <td>0.121097</td>
      <td>24.876656</td>
      <td>0.186707</td>
      <td>0.363845</td>
      <td>0.132384</td>
    </tr>
    <tr>
      <th>Fold 5</th>
      <td>0.24375316152760895</td>
      <td>20.725447</td>
      <td>0.127618</td>
      <td>0.194849</td>
      <td>0.037966</td>
      <td>34.251884</td>
      <td>0.209195</td>
      <td>0.288626</td>
      <td>0.083305</td>
      <td>31.9435</td>
      <td>...</td>
      <td>0.329088</td>
      <td>0.108299</td>
      <td>38.729769</td>
      <td>0.229437</td>
      <td>0.335595</td>
      <td>0.112624</td>
      <td>40.746374</td>
      <td>0.241634</td>
      <td>0.372639</td>
      <td>0.13886</td>
    </tr>
    <tr>
      <th>Mean ± Std</th>
      <td>0.5185 ± 0.3290</td>
      <td>13.434 ± 3.754</td>
      <td>0.094 ± 0.022</td>
      <td>0.199 ± 0.054</td>
      <td>0.043 ± 0.024</td>
      <td>19.693 ± 7.632</td>
      <td>0.134 ± 0.039</td>
      <td>0.265 ± 0.046</td>
      <td>0.072 ± 0.024</td>
      <td>22.100 ± 5.261</td>
      <td>...</td>
      <td>0.297 ± 0.057</td>
      <td>0.091 ± 0.032</td>
      <td>25.939 ± 6.580</td>
      <td>0.178 ± 0.029</td>
      <td>0.304 ± 0.051</td>
      <td>0.095 ± 0.029</td>
      <td>27.543 ± 6.694</td>
      <td>0.193 ± 0.027</td>
      <td>0.330 ± 0.044</td>
      <td>0.111 ± 0.028</td>
    </tr>
  </tbody>
</table>
<p>6 rows × 29 columns</p>
</div></div><img alt="_images/e7decb680d191e2d5250e480b74b274740870afabd3a112b4696270e058248b4.png" src="_images/e7decb680d191e2d5250e480b74b274740870afabd3a112b4696270e058248b4.png" />
<img alt="_images/1244e5df50308ec096839e6190206a2b980ef5213f7a7fe460acc8a461fa0404.png" src="_images/1244e5df50308ec096839e6190206a2b980ef5213f7a7fe460acc8a461fa0404.png" />
<img alt="_images/b43e560423cd8729eae36b0674b22bcbed60e14ac46e2d1827cad36817f86b0a.png" src="_images/b43e560423cd8729eae36b0674b22bcbed60e14ac46e2d1827cad36817f86b0a.png" />
<img alt="_images/b2dc42232257692705e5571113da1ddf47239d25358db7d98e29b7e4c56fbdb5.png" src="_images/b2dc42232257692705e5571113da1ddf47239d25358db7d98e29b7e4c56fbdb5.png" />
<img alt="_images/4db956e02a92031dfbb662b44602176d1dcac19ce07fee54e08f926604042c38.png" src="_images/4db956e02a92031dfbb662b44602176d1dcac19ce07fee54e08f926604042c38.png" />
<img alt="_images/7d6018a889336d0bd32940663b5319f656b616dca6c69cd68bf0da3171430491.png" src="_images/7d6018a889336d0bd32940663b5319f656b616dca6c69cd68bf0da3171430491.png" />
<img alt="_images/e8062f4f5945f558f481e466ba0afdaf849c0bc60cef32a1069d0f46a0d98260.png" src="_images/e8062f4f5945f558f481e466ba0afdaf849c0bc60cef32a1069d0f46a0d98260.png" />
<img alt="_images/61c11b5545bd3a085e82021e111674ba9d19d2e4eabc6ca796a4b501f88d0c18.png" src="_images/61c11b5545bd3a085e82021e111674ba9d19d2e4eabc6ca796a4b501f88d0c18.png" />
<img alt="_images/2a677d2e0927b3e262e39a67ca91a80cb19efda9a4578eda9774460590471ea0.png" src="_images/2a677d2e0927b3e262e39a67ca91a80cb19efda9a4578eda9774460590471ea0.png" />
<img alt="_images/62e8781193fce374cc2c94319eef925cfe7f8dc03a9d1363a39d3aa36cb24f69.png" src="_images/62e8781193fce374cc2c94319eef925cfe7f8dc03a9d1363a39d3aa36cb24f69.png" />
<img alt="_images/eab267b549add1a0d19aaeec8519f56cc1b3a67eeb4118884077ede465acb0dc.png" src="_images/eab267b549add1a0d19aaeec8519f56cc1b3a67eeb4118884077ede465acb0dc.png" />
<img alt="_images/82b3dc90ba679dddb53483dba96fd67f548cbff75d39f5d21c71473e405956ab.png" src="_images/82b3dc90ba679dddb53483dba96fd67f548cbff75d39f5d21c71473e405956ab.png" />
<img alt="_images/2599db7d057a7fe4b4eb26aa71705ed29829080899875bdd4a60185840fbecc1.png" src="_images/2599db7d057a7fe4b4eb26aa71705ed29829080899875bdd4a60185840fbecc1.png" />
<img alt="_images/40f907642b2784925f0fd8add4c2e5cf217712ce0f54249ba9ae3d669ee05ffd.png" src="_images/40f907642b2784925f0fd8add4c2e5cf217712ce0f54249ba9ae3d669ee05ffd.png" />
<img alt="_images/31cd0c9505a37339f0bb43783fd8b79d1f8c6e9a4f51656349e1d326107422b6.png" src="_images/31cd0c9505a37339f0bb43783fd8b79d1f8c6e9a4f51656349e1d326107422b6.png" />
<img alt="_images/3a48c5fd39126b0bf6aa2727dac455f3c38f8ae7b556f6cded189ab9909566a6.png" src="_images/3a48c5fd39126b0bf6aa2727dac455f3c38f8ae7b556f6cded189ab9909566a6.png" />
<img alt="_images/b07ed7a3e55209c5118acf581169e8cba03db3f187a9dfbee8726910687ae5ed.png" src="_images/b07ed7a3e55209c5118acf581169e8cba03db3f187a9dfbee8726910687ae5ed.png" />
<img alt="_images/3718da793407c2caffee29461923900b8859f76e7286f55c54d5d8d2b50d4221.png" src="_images/3718da793407c2caffee29461923900b8859f76e7286f55c54d5d8d2b50d4221.png" />
<img alt="_images/ffd563c550736461f72d73a37ffe813a93a8413f13b42f1adf598ec7fe0c0d04.png" src="_images/ffd563c550736461f72d73a37ffe813a93a8413f13b42f1adf598ec7fe0c0d04.png" />
<img alt="_images/511658258dc7dbf253372817895f75126c8cd719563a8e49d75da9699e2e57fd.png" src="_images/511658258dc7dbf253372817895f75126c8cd719563a8e49d75da9699e2e57fd.png" />
<img alt="_images/bcfc96c5c8bd2fc38353f188857aa6aaf3de8cad1b37cb87e62f2104fddcd07a.png" src="_images/bcfc96c5c8bd2fc38353f188857aa6aaf3de8cad1b37cb87e62f2104fddcd07a.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Análisis de RMSE para Lag 28:
</pre></div>
</div>
<img alt="_images/b4d7bc0b60fc988a82a5eefbd2379cc5460967cf263b91293cce36177f83d132.png" src="_images/b4d7bc0b60fc988a82a5eefbd2379cc5460967cf263b91293cce36177f83d132.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Resumen final para la volatilidad de 21 días:

 Comparación de todos los lags:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAPE_Promedio</th>
      <th>MAE_Promedio</th>
      <th>RMSE_Promedio</th>
      <th>MSE_Promedio</th>
      <th>BDS_pvalue_Promedio</th>
    </tr>
    <tr>
      <th>Lag</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>13.329198</td>
      <td>0.072941</td>
      <td>0.121197</td>
      <td>0.017359</td>
      <td>0.504930</td>
    </tr>
    <tr>
      <th>14</th>
      <td>14.348404</td>
      <td>0.083830</td>
      <td>0.165358</td>
      <td>0.033355</td>
      <td>0.214826</td>
    </tr>
    <tr>
      <th>21</th>
      <td>15.355218</td>
      <td>0.085854</td>
      <td>0.116717</td>
      <td>0.014655</td>
      <td>0.211632</td>
    </tr>
    <tr>
      <th>28</th>
      <td>22.431339</td>
      <td>0.152506</td>
      <td>0.278785</td>
      <td>0.081827</td>
      <td>0.518548</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="id7">
<h4><strong>Interpretaciones</strong><a class="headerlink" href="#id7" title="Link to this heading">#</a></h4>
<section id="id8">
<h5><strong>Lag 7 días</strong><a class="headerlink" href="#id8" title="Link to this heading">#</a></h5>
<p>La ventana de 7 días para la volatilidad de 21 días presentó un RMSE promedio de <strong>0.1211</strong>, siendo el segundo mejor entre los lags analizados. Su mejor Fold fue el 4, con un RMSE de <strong>0.097</strong>, muy cercano al Fold 3 (<strong>0.099</strong>). Se observa que el RMSE tiende a aumentar a medida que avanza el horizonte de predicción, lo que indica que el modelo predice con mayor precisión los días más cercanos. En cuanto al RMSE promedio por Fold, los primeros cuatro Folds se mantienen en un rango estrecho entre <strong>0.097 y 0.114</strong>, mientras que el Fold 5 presentó el peor desempeño con un RMSE de <strong>0.189</strong>.</p>
</section>
<section id="id9">
<h5><strong>Lag 14 días</strong><a class="headerlink" href="#id9" title="Link to this heading">#</a></h5>
<p>Este lag obtuvo un RMSE promedio de <strong>0.1653</strong>. El mejor Fold fue el 4, con un RMSE de <strong>0.123</strong>. Los RMSE promedio tienden a aumentar a medida que avanzan los horizontes. Por Fold, los RMSE decrecen hasta el Fold 4, y luego el Fold 5 aumenta ligeramente. El peor Fold fue el 1, con un RMSE de <strong>0.215</strong>.</p>
</section>
<section id="id10">
<h5><strong>Lag 21 días</strong><a class="headerlink" href="#id10" title="Link to this heading">#</a></h5>
<p>Esta ventana presentó el mejor desempeño para esta volatilidad, con un RMSE promedio de <strong>0.1167</strong>. El mejor Fold fue el 3, con un RMSE de <strong>0.1063</strong>. Analizando los RMSE por horizonte, se observa un aumento progresivo a medida que avanzan los días, aunque el rendimiento entre los horizontes 3 y 4 fue muy similar (siendo el horizonte 4 ligeramente menor), mientras que los horizontes 5, 6 y 7 muestran valores superiores. Por Fold, el RMSE aumenta ligeramente del Fold 1 al Fold 2 (este último fue el peor con <strong>0.136</strong>) y luego se mantiene estable en los Folds 3 a 5, con incrementos muy leves.</p>
</section>
<section id="id11">
<h5><strong>Lag 28 días</strong><a class="headerlink" href="#id11" title="Link to this heading">#</a></h5>
<p>El lag de 28 días presentó el peor desempeño entre los cuatro analizados, con un RMSE promedio de <strong>0.2788</strong>, considerablemente mayor que los demás. Su mejor Fold fue el 1, con un RMSE de <strong>0.221</strong>. Por Fold, se observa un aumento hasta el Fold 3, que fue el de peor desempeño, seguido de una ligera disminución en los Folds restantes. Por horizonte, el RMSE aumenta hasta alcanzar su valor máximo en el horizonte 3, disminuye en el horizonte 4 y vuelve a subir ligeramente, manteniéndose todos los valores por encima de los cuatro primeros horizontes.</p>
</section>
<section id="id12">
<h5><strong>General</strong><a class="headerlink" href="#id12" title="Link to this heading">#</a></h5>
<p>De manera general, los mejores Folds de cada lag lograron un desempeño destacado, ya que las líneas predichas siguen de manera consistente los patrones observados en los datos. Por otro lado, los Folds con menor desempeño mostraron una capacidad de predicción más limitada, reflejándose en desviaciones más notables respecto a los valores reales.</p>
</section>
</section>
</section>
<section id="volatilidad-de-la-ventana-de-28-dias">
<h3><strong>Volatilidad de la ventana de 28 días</strong><a class="headerlink" href="#volatilidad-de-la-ventana-de-28-dias" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Para volatilidad de 28 días</span>
<span class="n">resultados_7d</span> <span class="o">=</span> <span class="n">resultadosventana</span><span class="p">(</span>
    <span class="n">volatilidad</span><span class="o">=</span><span class="mi">28</span><span class="p">,</span>
    <span class="n">lags_list</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">28</span><span class="p">],</span>
    <span class="n">n_steps_forecast</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
    <span class="n">n_steps_jump</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados para la ventana de volatilidad de 28 días

 El mejor modelo para la volatilidad de 28 días está en el lag de 14 días. (RMSE promedio: 0.0868)

Dentro del lag 14, el mejor fold es el Fold 4 con RMSE: 0.0740

Análisis para el lag de 7 días

 Métricas detalladas
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BDS_pvalue_H1</th>
      <th>(H1, MAPE)</th>
      <th>(H1, MAE)</th>
      <th>(H1, RMSE)</th>
      <th>(H1, MSE)</th>
      <th>(H2, MAPE)</th>
      <th>(H2, MAE)</th>
      <th>(H2, RMSE)</th>
      <th>(H2, MSE)</th>
      <th>(H3, MAPE)</th>
      <th>...</th>
      <th>(H5, RMSE)</th>
      <th>(H5, MSE)</th>
      <th>(H6, MAPE)</th>
      <th>(H6, MAE)</th>
      <th>(H6, RMSE)</th>
      <th>(H6, MSE)</th>
      <th>(H7, MAPE)</th>
      <th>(H7, MAE)</th>
      <th>(H7, RMSE)</th>
      <th>(H7, MSE)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Fold 1</th>
      <td>0.8430857727062696</td>
      <td>3.551199</td>
      <td>0.020914</td>
      <td>0.031083</td>
      <td>0.000966</td>
      <td>5.647444</td>
      <td>0.033058</td>
      <td>0.054856</td>
      <td>0.003009</td>
      <td>7.391876</td>
      <td>...</td>
      <td>0.089132</td>
      <td>0.007945</td>
      <td>13.432942</td>
      <td>0.066719</td>
      <td>0.092997</td>
      <td>0.008649</td>
      <td>14.454319</td>
      <td>0.07437</td>
      <td>0.098406</td>
      <td>0.009684</td>
    </tr>
    <tr>
      <th>Fold 2</th>
      <td>0.9983962731836822</td>
      <td>3.430849</td>
      <td>0.019832</td>
      <td>0.031128</td>
      <td>0.000969</td>
      <td>5.291158</td>
      <td>0.030401</td>
      <td>0.04541</td>
      <td>0.002062</td>
      <td>7.856364</td>
      <td>...</td>
      <td>0.082667</td>
      <td>0.006834</td>
      <td>13.050263</td>
      <td>0.067936</td>
      <td>0.096651</td>
      <td>0.009341</td>
      <td>14.154608</td>
      <td>0.070467</td>
      <td>0.097705</td>
      <td>0.009546</td>
    </tr>
    <tr>
      <th>Fold 3</th>
      <td>0.21414431149984103</td>
      <td>3.994313</td>
      <td>0.022357</td>
      <td>0.042421</td>
      <td>0.0018</td>
      <td>5.42885</td>
      <td>0.031808</td>
      <td>0.077854</td>
      <td>0.006061</td>
      <td>7.180123</td>
      <td>...</td>
      <td>0.097686</td>
      <td>0.009543</td>
      <td>10.905022</td>
      <td>0.05932</td>
      <td>0.085142</td>
      <td>0.007249</td>
      <td>13.892891</td>
      <td>0.073062</td>
      <td>0.107585</td>
      <td>0.011574</td>
    </tr>
    <tr>
      <th>Fold 4</th>
      <td>0.40227999172479223</td>
      <td>4.087478</td>
      <td>0.02515</td>
      <td>0.041239</td>
      <td>0.001701</td>
      <td>5.397626</td>
      <td>0.032053</td>
      <td>0.057088</td>
      <td>0.003259</td>
      <td>6.782435</td>
      <td>...</td>
      <td>0.081764</td>
      <td>0.006685</td>
      <td>11.768396</td>
      <td>0.066961</td>
      <td>0.104242</td>
      <td>0.010866</td>
      <td>12.760575</td>
      <td>0.070892</td>
      <td>0.107855</td>
      <td>0.011633</td>
    </tr>
    <tr>
      <th>Fold 5</th>
      <td>0.6998234729448399</td>
      <td>5.516303</td>
      <td>0.04042</td>
      <td>0.130414</td>
      <td>0.017008</td>
      <td>7.078282</td>
      <td>0.051453</td>
      <td>0.14208</td>
      <td>0.020187</td>
      <td>7.994468</td>
      <td>...</td>
      <td>0.156185</td>
      <td>0.024394</td>
      <td>15.33882</td>
      <td>0.097751</td>
      <td>0.200093</td>
      <td>0.040037</td>
      <td>16.837353</td>
      <td>0.106653</td>
      <td>0.212722</td>
      <td>0.045251</td>
    </tr>
    <tr>
      <th>Mean ± Std</th>
      <td>0.6315 ± 0.2866</td>
      <td>4.116 ± 0.744</td>
      <td>0.026 ± 0.008</td>
      <td>0.055 ± 0.038</td>
      <td>0.004 ± 0.006</td>
      <td>5.769 ± 0.665</td>
      <td>0.036 ± 0.008</td>
      <td>0.075 ± 0.035</td>
      <td>0.007 ± 0.007</td>
      <td>7.441 ± 0.443</td>
      <td>...</td>
      <td>0.101 ± 0.028</td>
      <td>0.011 ± 0.007</td>
      <td>12.899 ± 1.518</td>
      <td>0.072 ± 0.013</td>
      <td>0.116 ± 0.043</td>
      <td>0.015 ± 0.012</td>
      <td>14.420 ± 1.338</td>
      <td>0.079 ± 0.014</td>
      <td>0.125 ± 0.044</td>
      <td>0.018 ± 0.014</td>
    </tr>
  </tbody>
</table>
<p>6 rows × 29 columns</p>
</div></div><img alt="_images/50ee53ad4d1aee81c3730c2523247a62c83e27aeacfd8c3b9f183ec238931d0f.png" src="_images/50ee53ad4d1aee81c3730c2523247a62c83e27aeacfd8c3b9f183ec238931d0f.png" />
<img alt="_images/465a52cc236dc8f93d2ed1e6447e40d9a06f1ee2c7f7b3814ccd23d9988a1554.png" src="_images/465a52cc236dc8f93d2ed1e6447e40d9a06f1ee2c7f7b3814ccd23d9988a1554.png" />
<img alt="_images/7839ac5330e20d655d9d712af669fe3ead2009e4bca6d21831be05c6bca119c9.png" src="_images/7839ac5330e20d655d9d712af669fe3ead2009e4bca6d21831be05c6bca119c9.png" />
<img alt="_images/038fa4b803fb0355fc00132b884d81d0625cb3ef14d2805f8d8ecdd56f660b02.png" src="_images/038fa4b803fb0355fc00132b884d81d0625cb3ef14d2805f8d8ecdd56f660b02.png" />
<img alt="_images/2e207b22da39e166acd8a6c65a50980ca1f17bbbfc7feef5c38ee65e9d59c813.png" src="_images/2e207b22da39e166acd8a6c65a50980ca1f17bbbfc7feef5c38ee65e9d59c813.png" />
<img alt="_images/3a9385486786431cb8d2e0066f9a84e14760672afa9aefd78fe626e31d0f5c6d.png" src="_images/3a9385486786431cb8d2e0066f9a84e14760672afa9aefd78fe626e31d0f5c6d.png" />
<img alt="_images/6473902ff464c427d56840b955a18d407201aa6b713cc207ef6ecb667c1a0ce1.png" src="_images/6473902ff464c427d56840b955a18d407201aa6b713cc207ef6ecb667c1a0ce1.png" />
<img alt="_images/082afcce5c7a2657188c11e351f67345271d64ab349a87d12d1774b245d92017.png" src="_images/082afcce5c7a2657188c11e351f67345271d64ab349a87d12d1774b245d92017.png" />
<img alt="_images/b792f7457f1c5a174d3ac026ffbeb7afa0a2551089aded12548c0023080ea00c.png" src="_images/b792f7457f1c5a174d3ac026ffbeb7afa0a2551089aded12548c0023080ea00c.png" />
<img alt="_images/d5f07bba6062015e994bf4fefb43326884073dd861047be68bdbc115a76d40d0.png" src="_images/d5f07bba6062015e994bf4fefb43326884073dd861047be68bdbc115a76d40d0.png" />
<img alt="_images/b8bfea806b3e7574e697ab327b1dca419635bab325806100ef3f09070f749357.png" src="_images/b8bfea806b3e7574e697ab327b1dca419635bab325806100ef3f09070f749357.png" />
<img alt="_images/11f3bca8f5f0d30e87839e2e9020f1cba79497edba26bd7e45cb5a4d84e5617b.png" src="_images/11f3bca8f5f0d30e87839e2e9020f1cba79497edba26bd7e45cb5a4d84e5617b.png" />
<img alt="_images/e66d731f579eb38ce5342cefbb6ddfdce094826ef275d34ce6b666a1376d32e7.png" src="_images/e66d731f579eb38ce5342cefbb6ddfdce094826ef275d34ce6b666a1376d32e7.png" />
<img alt="_images/7fec04a264f9f24ca0a62dee7bb221cfeeea0fb21cc94d29606d19cdf3142dfc.png" src="_images/7fec04a264f9f24ca0a62dee7bb221cfeeea0fb21cc94d29606d19cdf3142dfc.png" />
<img alt="_images/6478b1d84707db574dfe69fbd6831065654a1841a7e930a862a14de8b3a91ed7.png" src="_images/6478b1d84707db574dfe69fbd6831065654a1841a7e930a862a14de8b3a91ed7.png" />
<img alt="_images/bfeaf5e433819688b606a12c4d5b2c8d4f8517e0ae100be9c4c7298d73325ab3.png" src="_images/bfeaf5e433819688b606a12c4d5b2c8d4f8517e0ae100be9c4c7298d73325ab3.png" />
<img alt="_images/d20adabae67612bbba35f9f89952d4d0e4e2087fe26a66ac5be59538e0b608f4.png" src="_images/d20adabae67612bbba35f9f89952d4d0e4e2087fe26a66ac5be59538e0b608f4.png" />
<img alt="_images/d5cee4fd9135f6cf8113ebb73857504d164f6ae0d285f2fb856c97b2861c07c0.png" src="_images/d5cee4fd9135f6cf8113ebb73857504d164f6ae0d285f2fb856c97b2861c07c0.png" />
<img alt="_images/a3913b1cbb6b27b177fbb1020e568d3f9b3fc1267b00597f4fd0de26701ce5e4.png" src="_images/a3913b1cbb6b27b177fbb1020e568d3f9b3fc1267b00597f4fd0de26701ce5e4.png" />
<img alt="_images/38c2b99ace57443403bee133d8321b69253fe320c7b3d14e61f5373dd9fe27f5.png" src="_images/38c2b99ace57443403bee133d8321b69253fe320c7b3d14e61f5373dd9fe27f5.png" />
<img alt="_images/eefe1e474984e0dc11c05285fed76098bdcdb8dd230717a9fc974aa25ae37a40.png" src="_images/eefe1e474984e0dc11c05285fed76098bdcdb8dd230717a9fc974aa25ae37a40.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Análisis de RMSE para Lag 7:
</pre></div>
</div>
<img alt="_images/b23c1d061a7d8070d6c5531c5f4dd70e4aad1101fcbe18ac1534af9203410239.png" src="_images/b23c1d061a7d8070d6c5531c5f4dd70e4aad1101fcbe18ac1534af9203410239.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Análisis para el lag de 14 días

 Métricas detalladas
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BDS_pvalue_H1</th>
      <th>(H1, MAPE)</th>
      <th>(H1, MAE)</th>
      <th>(H1, RMSE)</th>
      <th>(H1, MSE)</th>
      <th>(H2, MAPE)</th>
      <th>(H2, MAE)</th>
      <th>(H2, RMSE)</th>
      <th>(H2, MSE)</th>
      <th>(H3, MAPE)</th>
      <th>...</th>
      <th>(H5, RMSE)</th>
      <th>(H5, MSE)</th>
      <th>(H6, MAPE)</th>
      <th>(H6, MAE)</th>
      <th>(H6, RMSE)</th>
      <th>(H6, MSE)</th>
      <th>(H7, MAPE)</th>
      <th>(H7, MAE)</th>
      <th>(H7, RMSE)</th>
      <th>(H7, MSE)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Fold 1</th>
      <td>0.18088880445815725</td>
      <td>5.741278</td>
      <td>0.030465</td>
      <td>0.040628</td>
      <td>0.001651</td>
      <td>8.905849</td>
      <td>0.048013</td>
      <td>0.066794</td>
      <td>0.004461</td>
      <td>10.446261</td>
      <td>...</td>
      <td>0.096416</td>
      <td>0.009296</td>
      <td>14.421837</td>
      <td>0.082462</td>
      <td>0.10877</td>
      <td>0.011831</td>
      <td>14.649819</td>
      <td>0.086083</td>
      <td>0.112795</td>
      <td>0.012723</td>
    </tr>
    <tr>
      <th>Fold 2</th>
      <td>0.43068156302450045</td>
      <td>5.706902</td>
      <td>0.029655</td>
      <td>0.043422</td>
      <td>0.001885</td>
      <td>7.75627</td>
      <td>0.042312</td>
      <td>0.05593</td>
      <td>0.003128</td>
      <td>10.505949</td>
      <td>...</td>
      <td>0.086807</td>
      <td>0.007535</td>
      <td>14.15674</td>
      <td>0.079296</td>
      <td>0.101466</td>
      <td>0.010295</td>
      <td>15.331774</td>
      <td>0.085427</td>
      <td>0.111352</td>
      <td>0.012399</td>
    </tr>
    <tr>
      <th>Fold 3</th>
      <td>0.17939959078125056</td>
      <td>5.666582</td>
      <td>0.03233</td>
      <td>0.0421</td>
      <td>0.001772</td>
      <td>7.942567</td>
      <td>0.047401</td>
      <td>0.066794</td>
      <td>0.004461</td>
      <td>9.346725</td>
      <td>...</td>
      <td>0.089132</td>
      <td>0.007944</td>
      <td>14.041622</td>
      <td>0.077049</td>
      <td>0.098081</td>
      <td>0.00962</td>
      <td>15.315735</td>
      <td>0.084286</td>
      <td>0.10963</td>
      <td>0.012019</td>
    </tr>
    <tr>
      <th>Fold 4</th>
      <td>0.9586437812573544</td>
      <td>5.031404</td>
      <td>0.028578</td>
      <td>0.036892</td>
      <td>0.001361</td>
      <td>7.699059</td>
      <td>0.044917</td>
      <td>0.056926</td>
      <td>0.003241</td>
      <td>9.068358</td>
      <td>...</td>
      <td>0.081807</td>
      <td>0.006692</td>
      <td>14.417447</td>
      <td>0.077584</td>
      <td>0.097728</td>
      <td>0.009551</td>
      <td>14.92709</td>
      <td>0.080832</td>
      <td>0.100524</td>
      <td>0.010105</td>
    </tr>
    <tr>
      <th>Fold 5</th>
      <td>0.8979330619974721</td>
      <td>6.660026</td>
      <td>0.035991</td>
      <td>0.053137</td>
      <td>0.002824</td>
      <td>7.80568</td>
      <td>0.05471</td>
      <td>0.116258</td>
      <td>0.013516</td>
      <td>10.40671</td>
      <td>...</td>
      <td>0.143248</td>
      <td>0.02052</td>
      <td>13.444514</td>
      <td>0.085537</td>
      <td>0.137156</td>
      <td>0.018812</td>
      <td>13.74896</td>
      <td>0.088779</td>
      <td>0.135756</td>
      <td>0.01843</td>
    </tr>
    <tr>
      <th>Mean ± Std</th>
      <td>0.5295 ± 0.3388</td>
      <td>5.761 ± 0.520</td>
      <td>0.031 ± 0.003</td>
      <td>0.043 ± 0.005</td>
      <td>0.002 ± 0.000</td>
      <td>8.022 ± 0.449</td>
      <td>0.047 ± 0.004</td>
      <td>0.073 ± 0.022</td>
      <td>0.006 ± 0.004</td>
      <td>9.955 ± 0.617</td>
      <td>...</td>
      <td>0.099 ± 0.022</td>
      <td>0.010 ± 0.005</td>
      <td>14.096 ± 0.358</td>
      <td>0.080 ± 0.003</td>
      <td>0.109 ± 0.015</td>
      <td>0.012 ± 0.003</td>
      <td>14.795 ± 0.582</td>
      <td>0.085 ± 0.003</td>
      <td>0.114 ± 0.012</td>
      <td>0.013 ± 0.003</td>
    </tr>
  </tbody>
</table>
<p>6 rows × 29 columns</p>
</div></div><img alt="_images/5fa43b1ef2b86b593e9ff79c41c54b13be29e77eae848a9d4159dcbf6bac8997.png" src="_images/5fa43b1ef2b86b593e9ff79c41c54b13be29e77eae848a9d4159dcbf6bac8997.png" />
<img alt="_images/e8e2fc3cc0dee1839906de981ac037036f349ec1ce0683b1512dfc37bb1ad97a.png" src="_images/e8e2fc3cc0dee1839906de981ac037036f349ec1ce0683b1512dfc37bb1ad97a.png" />
<img alt="_images/6ccef9e9a1c99df052841f41f5b481f11696cb1efc0266498a9ca7a4a62fa37d.png" src="_images/6ccef9e9a1c99df052841f41f5b481f11696cb1efc0266498a9ca7a4a62fa37d.png" />
<img alt="_images/b5d6efe461ffb70066811067ba1d953af7429a32753271fbb0e586eb3229f84e.png" src="_images/b5d6efe461ffb70066811067ba1d953af7429a32753271fbb0e586eb3229f84e.png" />
<img alt="_images/c604c82fc2650d44445066c9446e6ade6ba259911e65b26abc974273cdc61f3c.png" src="_images/c604c82fc2650d44445066c9446e6ade6ba259911e65b26abc974273cdc61f3c.png" />
<img alt="_images/c2cab38bc9d444d43ef4268dff16f5b712241be4f5f2d3a06f20e793ad27c660.png" src="_images/c2cab38bc9d444d43ef4268dff16f5b712241be4f5f2d3a06f20e793ad27c660.png" />
<img alt="_images/2850f68ac5f9d66d33c59369a9c24d437b567954406251b10ccf65166959f1e4.png" src="_images/2850f68ac5f9d66d33c59369a9c24d437b567954406251b10ccf65166959f1e4.png" />
<img alt="_images/d13cfc753c448a0c3280e34adc07efb61c746afec36f3b3eb5bcd52c9dda2f2b.png" src="_images/d13cfc753c448a0c3280e34adc07efb61c746afec36f3b3eb5bcd52c9dda2f2b.png" />
<img alt="_images/0697d3b27851abb7b7c5c0eda16d4731d445009d4eb37a4b3e74c3e8996228af.png" src="_images/0697d3b27851abb7b7c5c0eda16d4731d445009d4eb37a4b3e74c3e8996228af.png" />
<img alt="_images/7e7cd6cbc20766a7f3efc2eeda9865bdfe58529641c1b304ae9cfeff00ac4a1a.png" src="_images/7e7cd6cbc20766a7f3efc2eeda9865bdfe58529641c1b304ae9cfeff00ac4a1a.png" />
<img alt="_images/13f432583428aebebd0174d0c023a70f73b64785add7fbb2265ba1ffef74b501.png" src="_images/13f432583428aebebd0174d0c023a70f73b64785add7fbb2265ba1ffef74b501.png" />
<img alt="_images/f0cc00c3404621bde57badba45cb4ac5ab2eade85a59a4ca9764071e2450d8ff.png" src="_images/f0cc00c3404621bde57badba45cb4ac5ab2eade85a59a4ca9764071e2450d8ff.png" />
<img alt="_images/2b83f06403e0a52de3de844f675b8dbdbb83805ac1ca7f58f34f65a4ca5b0686.png" src="_images/2b83f06403e0a52de3de844f675b8dbdbb83805ac1ca7f58f34f65a4ca5b0686.png" />
<img alt="_images/ad991119562e6780807772cb9d53ab250b05431b469a5b0f62cd7d813cca34d1.png" src="_images/ad991119562e6780807772cb9d53ab250b05431b469a5b0f62cd7d813cca34d1.png" />
<img alt="_images/cbc08c9fd7a31ebf716d1995018f84a37f5ae266cafe9f0f0db11b486ad1eff5.png" src="_images/cbc08c9fd7a31ebf716d1995018f84a37f5ae266cafe9f0f0db11b486ad1eff5.png" />
<img alt="_images/6cc8e696f280cda8ed31c0ae7880e9a0dfd81875cfef26c474e5de5037743b48.png" src="_images/6cc8e696f280cda8ed31c0ae7880e9a0dfd81875cfef26c474e5de5037743b48.png" />
<img alt="_images/1dfd85fcf5bf94eb7d020265776cd49975b25231035ea6fa96c7d284a99dee10.png" src="_images/1dfd85fcf5bf94eb7d020265776cd49975b25231035ea6fa96c7d284a99dee10.png" />
<img alt="_images/e5acf456123a7371387d9961aad1af2ff4230431d290f954d574628c68b4db7f.png" src="_images/e5acf456123a7371387d9961aad1af2ff4230431d290f954d574628c68b4db7f.png" />
<img alt="_images/22a02412a2534f66ba6cfc65c93a1b73e6ef728cef89a0e82cc059569574e4b7.png" src="_images/22a02412a2534f66ba6cfc65c93a1b73e6ef728cef89a0e82cc059569574e4b7.png" />
<img alt="_images/9a8b4b293b19cbd0d8f68f9b9d2e257d10e276760f5adc989bbce7f1078533a8.png" src="_images/9a8b4b293b19cbd0d8f68f9b9d2e257d10e276760f5adc989bbce7f1078533a8.png" />
<img alt="_images/a2497c304ccb77675648c7e0a0a517c425389fdce666b64f9e3653e917282114.png" src="_images/a2497c304ccb77675648c7e0a0a517c425389fdce666b64f9e3653e917282114.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Análisis de RMSE para Lag 14:
</pre></div>
</div>
<img alt="_images/54c29bb9a2cb9cae9a384a426598fc31630f0b07287657e8618134a96b7b5672.png" src="_images/54c29bb9a2cb9cae9a384a426598fc31630f0b07287657e8618134a96b7b5672.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Análisis para el lag de 21 días

 Métricas detalladas
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BDS_pvalue_H1</th>
      <th>(H1, MAPE)</th>
      <th>(H1, MAE)</th>
      <th>(H1, RMSE)</th>
      <th>(H1, MSE)</th>
      <th>(H2, MAPE)</th>
      <th>(H2, MAE)</th>
      <th>(H2, RMSE)</th>
      <th>(H2, MSE)</th>
      <th>(H3, MAPE)</th>
      <th>...</th>
      <th>(H5, RMSE)</th>
      <th>(H5, MSE)</th>
      <th>(H6, MAPE)</th>
      <th>(H6, MAE)</th>
      <th>(H6, RMSE)</th>
      <th>(H6, MSE)</th>
      <th>(H7, MAPE)</th>
      <th>(H7, MAE)</th>
      <th>(H7, RMSE)</th>
      <th>(H7, MSE)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Fold 1</th>
      <td>0.6309252823940946</td>
      <td>9.866699</td>
      <td>0.068609</td>
      <td>0.140078</td>
      <td>0.019622</td>
      <td>11.601105</td>
      <td>0.063872</td>
      <td>0.094705</td>
      <td>0.008969</td>
      <td>11.814194</td>
      <td>...</td>
      <td>0.111284</td>
      <td>0.012384</td>
      <td>15.54724</td>
      <td>0.082797</td>
      <td>0.105628</td>
      <td>0.011157</td>
      <td>15.402587</td>
      <td>0.081248</td>
      <td>0.100711</td>
      <td>0.010143</td>
    </tr>
    <tr>
      <th>Fold 2</th>
      <td>0.8237810255306508</td>
      <td>8.509808</td>
      <td>0.072096</td>
      <td>0.204829</td>
      <td>0.041955</td>
      <td>14.391833</td>
      <td>0.103521</td>
      <td>0.245839</td>
      <td>0.060437</td>
      <td>14.645318</td>
      <td>...</td>
      <td>0.184613</td>
      <td>0.034082</td>
      <td>17.569012</td>
      <td>0.116582</td>
      <td>0.237349</td>
      <td>0.056335</td>
      <td>19.130804</td>
      <td>0.12198</td>
      <td>0.223981</td>
      <td>0.050167</td>
    </tr>
    <tr>
      <th>Fold 3</th>
      <td>0.6803933449808055</td>
      <td>5.788133</td>
      <td>0.051655</td>
      <td>0.143016</td>
      <td>0.020453</td>
      <td>7.035798</td>
      <td>0.054127</td>
      <td>0.144628</td>
      <td>0.020917</td>
      <td>13.994992</td>
      <td>...</td>
      <td>0.251355</td>
      <td>0.063179</td>
      <td>16.883683</td>
      <td>0.118608</td>
      <td>0.255975</td>
      <td>0.065523</td>
      <td>17.933384</td>
      <td>0.111412</td>
      <td>0.1991</td>
      <td>0.039641</td>
    </tr>
    <tr>
      <th>Fold 4</th>
      <td>0.6767598634564012</td>
      <td>6.491221</td>
      <td>0.039599</td>
      <td>0.062841</td>
      <td>0.003949</td>
      <td>6.420979</td>
      <td>0.046061</td>
      <td>0.094567</td>
      <td>0.008943</td>
      <td>8.035045</td>
      <td>...</td>
      <td>0.125921</td>
      <td>0.015856</td>
      <td>14.791254</td>
      <td>0.086315</td>
      <td>0.126783</td>
      <td>0.016074</td>
      <td>15.7915</td>
      <td>0.092755</td>
      <td>0.132576</td>
      <td>0.017576</td>
    </tr>
    <tr>
      <th>Fold 5</th>
      <td>0.5758088266871255</td>
      <td>8.729281</td>
      <td>0.049441</td>
      <td>0.066944</td>
      <td>0.004482</td>
      <td>9.297302</td>
      <td>0.055606</td>
      <td>0.076936</td>
      <td>0.005919</td>
      <td>9.863389</td>
      <td>...</td>
      <td>0.110806</td>
      <td>0.012278</td>
      <td>14.188814</td>
      <td>0.074384</td>
      <td>0.098749</td>
      <td>0.009751</td>
      <td>15.575397</td>
      <td>0.084123</td>
      <td>0.103249</td>
      <td>0.01066</td>
    </tr>
    <tr>
      <th>Mean ± Std</th>
      <td>0.6775 ± 0.0824</td>
      <td>7.877 ± 1.508</td>
      <td>0.056 ± 0.012</td>
      <td>0.124 ± 0.053</td>
      <td>0.018 ± 0.014</td>
      <td>9.749 ± 2.954</td>
      <td>0.065 ± 0.020</td>
      <td>0.131 ± 0.062</td>
      <td>0.021 ± 0.020</td>
      <td>11.671 ± 2.480</td>
      <td>...</td>
      <td>0.157 ± 0.055</td>
      <td>0.028 ± 0.020</td>
      <td>15.796 ± 1.263</td>
      <td>0.096 ± 0.018</td>
      <td>0.165 ± 0.068</td>
      <td>0.032 ± 0.024</td>
      <td>16.767 ± 1.495</td>
      <td>0.098 ± 0.016</td>
      <td>0.152 ± 0.051</td>
      <td>0.026 ± 0.016</td>
    </tr>
  </tbody>
</table>
<p>6 rows × 29 columns</p>
</div></div><img alt="_images/b668fdd42cc8760f32a349c76d9c741b42f50a475b7fbfbdf56bdac37dd73bd4.png" src="_images/b668fdd42cc8760f32a349c76d9c741b42f50a475b7fbfbdf56bdac37dd73bd4.png" />
<img alt="_images/58769e34f53469490136622e861848dc7f7544d1ddb54b496a91610aa1eaa20a.png" src="_images/58769e34f53469490136622e861848dc7f7544d1ddb54b496a91610aa1eaa20a.png" />
<img alt="_images/90d482de24deb90bbb175be9cb0691be64855487b81aa2cc721107e3fc0e10aa.png" src="_images/90d482de24deb90bbb175be9cb0691be64855487b81aa2cc721107e3fc0e10aa.png" />
<img alt="_images/50e26ab98e3ecd21c12030289165dfbbafa4b86eb33dc289a67da299fe5d0333.png" src="_images/50e26ab98e3ecd21c12030289165dfbbafa4b86eb33dc289a67da299fe5d0333.png" />
<img alt="_images/f426fd59539afd81258d4ae028acacb67b62e44c183ac13ab3e70acc7af31d37.png" src="_images/f426fd59539afd81258d4ae028acacb67b62e44c183ac13ab3e70acc7af31d37.png" />
<img alt="_images/57266fafcf36f8db1cb00651440865aac24f1601002188a298061d977d3b2fa0.png" src="_images/57266fafcf36f8db1cb00651440865aac24f1601002188a298061d977d3b2fa0.png" />
<img alt="_images/4c6fceeac304fc4b73d71bc0d639e64c9d3c3b1cdc872250ad08f581c846b02f.png" src="_images/4c6fceeac304fc4b73d71bc0d639e64c9d3c3b1cdc872250ad08f581c846b02f.png" />
<img alt="_images/c3290872d75999ef4f4fd12e85fb432a1303fb2cb8210fd5556bf6a3d0b2c9e4.png" src="_images/c3290872d75999ef4f4fd12e85fb432a1303fb2cb8210fd5556bf6a3d0b2c9e4.png" />
<img alt="_images/efc0136e6e528972f9470c979b7c71d09d831fb2431687327ec5a89984ab4c61.png" src="_images/efc0136e6e528972f9470c979b7c71d09d831fb2431687327ec5a89984ab4c61.png" />
<img alt="_images/c2f29f36d4b9eafd1eca25067330dc03b0aa6f0f9f28d7094e279c84c130d83f.png" src="_images/c2f29f36d4b9eafd1eca25067330dc03b0aa6f0f9f28d7094e279c84c130d83f.png" />
<img alt="_images/e667aaa38efba3b26b898d4c0eacf3f556dd47acd772bb427d15af4e47b43c5f.png" src="_images/e667aaa38efba3b26b898d4c0eacf3f556dd47acd772bb427d15af4e47b43c5f.png" />
<img alt="_images/a2c59b6e3111dc4e1ab40a456456b81342ab91561843f0385db3420f4add2a46.png" src="_images/a2c59b6e3111dc4e1ab40a456456b81342ab91561843f0385db3420f4add2a46.png" />
<img alt="_images/c0e389b0d0238da3951b6367c69859f59f295c92b8d95c4d2166c6b1fe11ab6d.png" src="_images/c0e389b0d0238da3951b6367c69859f59f295c92b8d95c4d2166c6b1fe11ab6d.png" />
<img alt="_images/4eb4481eea2965b996282df1a3c411b927f99e988360020068e40c5f9f180baf.png" src="_images/4eb4481eea2965b996282df1a3c411b927f99e988360020068e40c5f9f180baf.png" />
<img alt="_images/319520fd5cc42a1be6f897230b09b0ac568d9c65bc03b2cff69a364b59aacd59.png" src="_images/319520fd5cc42a1be6f897230b09b0ac568d9c65bc03b2cff69a364b59aacd59.png" />
<img alt="_images/4dbeea11b3d8dce003a7d2556cea0194750b3c9f92baa2d53ac1a1d803cfb430.png" src="_images/4dbeea11b3d8dce003a7d2556cea0194750b3c9f92baa2d53ac1a1d803cfb430.png" />
<img alt="_images/973e2f3b6e55bc86943329961015e32fdec08860c603178c6001769c9c45ab04.png" src="_images/973e2f3b6e55bc86943329961015e32fdec08860c603178c6001769c9c45ab04.png" />
<img alt="_images/3572baa21f14af59ef9b56fe3c00b55310fcf71fefc69355ad8a9c828e3c7801.png" src="_images/3572baa21f14af59ef9b56fe3c00b55310fcf71fefc69355ad8a9c828e3c7801.png" />
<img alt="_images/2826b874790d79127c09fd4a473935edc3d0ad1290237b792689e6006d86b3cf.png" src="_images/2826b874790d79127c09fd4a473935edc3d0ad1290237b792689e6006d86b3cf.png" />
<img alt="_images/ec03bf4ce22063186b1faf7bc60035568bb6d0b1cec5e2451dcd490111790636.png" src="_images/ec03bf4ce22063186b1faf7bc60035568bb6d0b1cec5e2451dcd490111790636.png" />
<img alt="_images/1fc69af64ddceb49ace12d0c849f777636015ee49b6a41ab0763352420875db7.png" src="_images/1fc69af64ddceb49ace12d0c849f777636015ee49b6a41ab0763352420875db7.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Análisis de RMSE para Lag 21:
</pre></div>
</div>
<img alt="_images/e0581a1b0e47c1b4670810c1f35f17d5d497b12c92c75b39323b424542e1ed4a.png" src="_images/e0581a1b0e47c1b4670810c1f35f17d5d497b12c92c75b39323b424542e1ed4a.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Análisis para el lag de 28 días

 Métricas detalladas
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BDS_pvalue_H1</th>
      <th>(H1, MAPE)</th>
      <th>(H1, MAE)</th>
      <th>(H1, RMSE)</th>
      <th>(H1, MSE)</th>
      <th>(H2, MAPE)</th>
      <th>(H2, MAE)</th>
      <th>(H2, RMSE)</th>
      <th>(H2, MSE)</th>
      <th>(H3, MAPE)</th>
      <th>...</th>
      <th>(H5, RMSE)</th>
      <th>(H5, MSE)</th>
      <th>(H6, MAPE)</th>
      <th>(H6, MAE)</th>
      <th>(H6, RMSE)</th>
      <th>(H6, MSE)</th>
      <th>(H7, MAPE)</th>
      <th>(H7, MAE)</th>
      <th>(H7, RMSE)</th>
      <th>(H7, MSE)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Fold 1</th>
      <td>0.30945037619228155</td>
      <td>10.388902</td>
      <td>0.074289</td>
      <td>0.13395</td>
      <td>0.017943</td>
      <td>12.047356</td>
      <td>0.084228</td>
      <td>0.133516</td>
      <td>0.017826</td>
      <td>14.937984</td>
      <td>...</td>
      <td>0.183477</td>
      <td>0.033664</td>
      <td>20.736797</td>
      <td>0.135974</td>
      <td>0.178905</td>
      <td>0.032007</td>
      <td>20.588292</td>
      <td>0.145816</td>
      <td>0.225403</td>
      <td>0.050806</td>
    </tr>
    <tr>
      <th>Fold 2</th>
      <td>0.6096616822677274</td>
      <td>6.695467</td>
      <td>0.053618</td>
      <td>0.10755</td>
      <td>0.011567</td>
      <td>10.477708</td>
      <td>0.073786</td>
      <td>0.126997</td>
      <td>0.016128</td>
      <td>14.058382</td>
      <td>...</td>
      <td>0.222014</td>
      <td>0.04929</td>
      <td>21.306632</td>
      <td>0.147006</td>
      <td>0.21469</td>
      <td>0.046092</td>
      <td>21.805549</td>
      <td>0.152024</td>
      <td>0.224264</td>
      <td>0.050294</td>
    </tr>
    <tr>
      <th>Fold 3</th>
      <td>0.8269309204317639</td>
      <td>8.57803</td>
      <td>0.079833</td>
      <td>0.23319</td>
      <td>0.054378</td>
      <td>12.636452</td>
      <td>0.110011</td>
      <td>0.265091</td>
      <td>0.070273</td>
      <td>14.645082</td>
      <td>...</td>
      <td>0.290892</td>
      <td>0.084618</td>
      <td>21.784313</td>
      <td>0.164832</td>
      <td>0.29394</td>
      <td>0.086401</td>
      <td>25.507434</td>
      <td>0.186504</td>
      <td>0.306693</td>
      <td>0.094061</td>
    </tr>
    <tr>
      <th>Fold 4</th>
      <td>0.004872187820404572</td>
      <td>9.564359</td>
      <td>0.056859</td>
      <td>0.097879</td>
      <td>0.00958</td>
      <td>11.110725</td>
      <td>0.096121</td>
      <td>0.254051</td>
      <td>0.064542</td>
      <td>15.974436</td>
      <td>...</td>
      <td>0.300317</td>
      <td>0.090191</td>
      <td>20.109663</td>
      <td>0.162596</td>
      <td>0.309214</td>
      <td>0.095613</td>
      <td>21.570908</td>
      <td>0.164697</td>
      <td>0.306134</td>
      <td>0.093718</td>
    </tr>
    <tr>
      <th>Fold 5</th>
      <td>0.30288529656678764</td>
      <td>16.915423</td>
      <td>0.103516</td>
      <td>0.155938</td>
      <td>0.024317</td>
      <td>28.703295</td>
      <td>0.169451</td>
      <td>0.267984</td>
      <td>0.071815</td>
      <td>26.608836</td>
      <td>...</td>
      <td>0.277004</td>
      <td>0.076731</td>
      <td>29.52998</td>
      <td>0.176912</td>
      <td>0.274913</td>
      <td>0.075577</td>
      <td>27.108522</td>
      <td>0.160107</td>
      <td>0.28512</td>
      <td>0.081294</td>
    </tr>
    <tr>
      <th>Mean ± Std</th>
      <td>0.4108 ± 0.2826</td>
      <td>10.428 ± 3.470</td>
      <td>0.074 ± 0.018</td>
      <td>0.146 ± 0.048</td>
      <td>0.024 ± 0.016</td>
      <td>14.995 ± 6.894</td>
      <td>0.107 ± 0.034</td>
      <td>0.210 ± 0.065</td>
      <td>0.048 ± 0.026</td>
      <td>17.245 ± 4.723</td>
      <td>...</td>
      <td>0.255 ± 0.045</td>
      <td>0.067 ± 0.022</td>
      <td>22.693 ± 3.464</td>
      <td>0.157 ± 0.014</td>
      <td>0.254 ± 0.050</td>
      <td>0.067 ± 0.024</td>
      <td>23.316 ± 2.528</td>
      <td>0.162 ± 0.014</td>
      <td>0.270 ± 0.037</td>
      <td>0.074 ± 0.020</td>
    </tr>
  </tbody>
</table>
<p>6 rows × 29 columns</p>
</div></div><img alt="_images/b15f4e7c7bea82a4b1355f4ef6cbcd677b709f4e3e9162cb975a614b558d6985.png" src="_images/b15f4e7c7bea82a4b1355f4ef6cbcd677b709f4e3e9162cb975a614b558d6985.png" />
<img alt="_images/1552052c2ce9e67553d3c743f5670eca3fb79a7d301bf076365929188d4a02b8.png" src="_images/1552052c2ce9e67553d3c743f5670eca3fb79a7d301bf076365929188d4a02b8.png" />
<img alt="_images/0c85a5956fc118ba4592dffdfcec717217cd8722412c5076f4d723fcb9cc5241.png" src="_images/0c85a5956fc118ba4592dffdfcec717217cd8722412c5076f4d723fcb9cc5241.png" />
<img alt="_images/3520ef20ee6e843e8cb792413ea05c321c65c6f253be4cfb792465cb86aa6659.png" src="_images/3520ef20ee6e843e8cb792413ea05c321c65c6f253be4cfb792465cb86aa6659.png" />
<img alt="_images/968b687b725c602f15c4bf02239bc7fd36a1f138c93cf22617c1202156c5d3e5.png" src="_images/968b687b725c602f15c4bf02239bc7fd36a1f138c93cf22617c1202156c5d3e5.png" />
<img alt="_images/381516748a78f04c103071f9c6c3b6d8fd3e7e4aecd7f2c461cc1338b3acc520.png" src="_images/381516748a78f04c103071f9c6c3b6d8fd3e7e4aecd7f2c461cc1338b3acc520.png" />
<img alt="_images/0fe7fb65dd6a4e03105415562df78199ec7e1e19a470ecb80cdd151b20b96aac.png" src="_images/0fe7fb65dd6a4e03105415562df78199ec7e1e19a470ecb80cdd151b20b96aac.png" />
<img alt="_images/528f0e53d38e11da2baf27652d66f5dfae252ce1de3f72e95fe8cf56688d5b22.png" src="_images/528f0e53d38e11da2baf27652d66f5dfae252ce1de3f72e95fe8cf56688d5b22.png" />
<img alt="_images/fa51d4e055928059092bae2ba6e6c7fe41af8a2da09c73b57be068dca5e5ce8d.png" src="_images/fa51d4e055928059092bae2ba6e6c7fe41af8a2da09c73b57be068dca5e5ce8d.png" />
<img alt="_images/f8fac2945eb0d240cf9b388183243fe5931bc0bb435e31a7f75c127fc4603655.png" src="_images/f8fac2945eb0d240cf9b388183243fe5931bc0bb435e31a7f75c127fc4603655.png" />
<img alt="_images/42bae70e4220d9cb09cea3dae8cbea7a9b52d3b78f0a98d0f94cf939bccad891.png" src="_images/42bae70e4220d9cb09cea3dae8cbea7a9b52d3b78f0a98d0f94cf939bccad891.png" />
<img alt="_images/1db86b5487e61457a7d1d1c13ba210aa64f7e184f00602ff84387f036ecd08ca.png" src="_images/1db86b5487e61457a7d1d1c13ba210aa64f7e184f00602ff84387f036ecd08ca.png" />
<img alt="_images/c494cf4d4b12f3f3147c8a187f173cf9c5948b2ac08caed1d7893bf2abba6228.png" src="_images/c494cf4d4b12f3f3147c8a187f173cf9c5948b2ac08caed1d7893bf2abba6228.png" />
<img alt="_images/122b0babcc7a044fff9e841bfc9a85652944ec089063c202274dbedefea1aaa4.png" src="_images/122b0babcc7a044fff9e841bfc9a85652944ec089063c202274dbedefea1aaa4.png" />
<img alt="_images/ad95144b35fd849afea6ff46214cb01d61386102ac740f3140993edd9f5ebeaf.png" src="_images/ad95144b35fd849afea6ff46214cb01d61386102ac740f3140993edd9f5ebeaf.png" />
<img alt="_images/b7a4d82012570dfd5d9499e82869bc795d387f52df89367dd37f78e836d13c18.png" src="_images/b7a4d82012570dfd5d9499e82869bc795d387f52df89367dd37f78e836d13c18.png" />
<img alt="_images/e255d180efe12cd2b79d2f58552cdc050ff1fa3e302d17d801faee386ff3d5e6.png" src="_images/e255d180efe12cd2b79d2f58552cdc050ff1fa3e302d17d801faee386ff3d5e6.png" />
<img alt="_images/04dc953f5aeb8d1de5d46451024f47e202b9a19fa94840da6ebfb66ec120544e.png" src="_images/04dc953f5aeb8d1de5d46451024f47e202b9a19fa94840da6ebfb66ec120544e.png" />
<img alt="_images/48bd1259419b7a1591cf74408cf1eef30192fa6f4fc26350ccbde019b1748bc4.png" src="_images/48bd1259419b7a1591cf74408cf1eef30192fa6f4fc26350ccbde019b1748bc4.png" />
<img alt="_images/68840313746b5fa677a1e70e0dbd435973c5b8d3da30bb4d6d5cc5de49abec6f.png" src="_images/68840313746b5fa677a1e70e0dbd435973c5b8d3da30bb4d6d5cc5de49abec6f.png" />
<img alt="_images/d72a79fbe6ebebda4b2ec3dda6f92801e57df772376dce379b8fec69d9942053.png" src="_images/d72a79fbe6ebebda4b2ec3dda6f92801e57df772376dce379b8fec69d9942053.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Análisis de RMSE para Lag 28:
</pre></div>
</div>
<img alt="_images/76de58a2482753b6c83f8803d3101ec1a0f584d21e3d803ca1cd71b664e62c24.png" src="_images/76de58a2482753b6c83f8803d3101ec1a0f584d21e3d803ca1cd71b664e62c24.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Resumen final para la volatilidad de 28 días:

 Comparación de todos los lags:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAPE_Promedio</th>
      <th>MAE_Promedio</th>
      <th>RMSE_Promedio</th>
      <th>MSE_Promedio</th>
      <th>BDS_pvalue_Promedio</th>
    </tr>
    <tr>
      <th>Lag</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>9.223429</td>
      <td>0.053341</td>
      <td>0.092399</td>
      <td>0.010326</td>
      <td>0.631546</td>
    </tr>
    <tr>
      <th>14</th>
      <td>10.937598</td>
      <td>0.062132</td>
      <td>0.086792</td>
      <td>0.008319</td>
      <td>0.529509</td>
    </tr>
    <tr>
      <th>21</th>
      <td>12.872050</td>
      <td>0.080446</td>
      <td>0.142232</td>
      <td>0.023842</td>
      <td>0.677534</td>
    </tr>
    <tr>
      <th>28</th>
      <td>18.233170</td>
      <td>0.128350</td>
      <td>0.227783</td>
      <td>0.055912</td>
      <td>0.410760</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="id13">
<h4><strong>Interpretaciones</strong><a class="headerlink" href="#id13" title="Link to this heading">#</a></h4>
<section id="id14">
<h5><strong>Lag 7 días</strong><a class="headerlink" href="#id14" title="Link to this heading">#</a></h5>
<p>La ventana de 7 días presentó un RMSE promedio de <strong>0.0924</strong>, siendo el segundo mejor entre los lags analizados. Su mejor Fold fue el 2, con un RMSE de <strong>0.071</strong>, muy cercano a los demás Folds (rango <strong>0.073–0.079</strong>), excepto el Fold 5, que fue el peor con <strong>0.163</strong>. Se observa que el RMSE tiende a aumentar a medida que avanza el horizonte de predicción, indicando que el modelo predice con mayor precisión los días más cercanos.</p>
</section>
<section id="id15">
<h5><strong>Lag 14 días</strong><a class="headerlink" href="#id15" title="Link to this heading">#</a></h5>
<p>Este lag obtuvo un RMSE promedio de <strong>0.0868</strong>, siendo el mejor entre los cuatro lags. Su mejor Fold fue el 4, con un RMSE de <strong>0.074</strong>, destacándose como el mejor en general. Los RMSE promedio tienden a aumentar ligeramente a medida que avanzan los horizontes. Por Fold, los Folds 1, 2 y 3 se mantienen muy cercanos (<strong>0.083, 0.080 y 0.080</strong>), mientras que el peor fue el Fold 5 con <strong>0.117</strong>.</p>
</section>
<section id="id16">
<h5><strong>Lag 21 días</strong><a class="headerlink" href="#id16" title="Link to this heading">#</a></h5>
<p>Esta ventana presentó un RMSE promedio de <strong>0.1422</strong>. El mejor Fold fue el 5, con un RMSE de <strong>0.089</strong>. Analizando los RMSE por horizonte, se observa un ligero aumento del horizonte 1 al 2, seguido de una leve disminución del 2 al 3, un incremento progresivo hasta el horizonte 6 y una pequeña caída en el horizonte 7. Por Fold, el RMSE aumenta considerablemente del Fold 1 al Fold 2 (<strong>0.210</strong>), luego disminuye ligeramente al Fold 3 (<strong>0.204</strong>), baja más al Fold 4 y finalmente alcanza su mejor valor en el Fold 5.</p>
</section>
<section id="id17">
<h5><strong>Lag 28 días</strong><a class="headerlink" href="#id17" title="Link to this heading">#</a></h5>
<p>El lag de 28 días presentó el peor desempeño entre los cuatro analizados, con un RMSE promedio de <strong>0.2278</strong>. Su mejor Fold fue el 1, con un RMSE de <strong>0.169</strong>. Por Fold, se observa un aumento hasta el Fold 3, que fue el de peor desempeño, seguido de una ligera disminución en los Folds restantes. Por horizonte, el RMSE aumenta progresivamente a lo largo de los días.</p>
</section>
<section id="id18">
<h5><strong>General</strong><a class="headerlink" href="#id18" title="Link to this heading">#</a></h5>
<p>De manera general, los mejores Folds de cada lag lograron un desempeño destacado, ya que las líneas predichas siguen de manera consistente los patrones observados en los datos. Por otro lado, los Folds con menor desempeño mostraron una capacidad de predicción más limitada, reflejándose en desviaciones más notables respecto a los valores reales.</p>
</section>
</section>
</section>
<section id="analisis-general">
<h3><strong>Análisis general</strong><a class="headerlink" href="#analisis-general" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">BASE_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
<span class="n">results_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s1">&#39;results&#39;</span><span class="p">)</span>

<span class="c1"># Lista de volatilidades y sus archivos</span>
<span class="n">volatilidades</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">28</span><span class="p">]</span>
<span class="n">archivos_resumen</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;vol</span><span class="si">{</span><span class="n">vol</span><span class="si">}</span><span class="s1">_reporte_resumen_promedio.csv&#39;</span> <span class="k">for</span> <span class="n">vol</span> <span class="ow">in</span> <span class="n">volatilidades</span><span class="p">]</span>

<span class="n">mejores_lags</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">vol</span><span class="p">,</span> <span class="n">archivo</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">volatilidades</span><span class="p">,</span> <span class="n">archivos_resumen</span><span class="p">):</span>
    <span class="c1"># Leer CSV desde la carpeta results</span>
    <span class="n">resumen</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">results_path</span><span class="p">,</span> <span class="n">archivo</span><span class="p">),</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    
    <span class="c1"># Mejor lag según menor RMSE_Promedio</span>
    <span class="n">mejor_lag</span> <span class="o">=</span> <span class="n">resumen</span><span class="p">[</span><span class="s1">&#39;RMSE_Promedio&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
    <span class="n">metrics</span> <span class="o">=</span> <span class="n">resumen</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mejor_lag</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;MAPE_Promedio&#39;</span><span class="p">,</span> <span class="s1">&#39;MAE_Promedio&#39;</span><span class="p">,</span> <span class="s1">&#39;RMSE_Promedio&#39;</span><span class="p">,</span> <span class="s1">&#39;MSE_Promedio&#39;</span><span class="p">,</span> <span class="s1">&#39;BDS_pvalue_Promedio&#39;</span><span class="p">]]</span>
    
    <span class="c1"># Guardar la info</span>
    <span class="n">mejores_lags</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Volatilidad&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">vol</span><span class="si">}</span><span class="s1"> días&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Mejor Lag&#39;</span><span class="p">:</span> <span class="n">mejor_lag</span><span class="p">,</span>
        <span class="s1">&#39;MAPE_Promedio&#39;</span><span class="p">:</span> <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;MAPE_Promedio&#39;</span><span class="p">],</span>
        <span class="s1">&#39;MAE_Promedio&#39;</span><span class="p">:</span> <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;MAE_Promedio&#39;</span><span class="p">],</span>
        <span class="s1">&#39;RMSE_Promedio&#39;</span><span class="p">:</span> <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;RMSE_Promedio&#39;</span><span class="p">],</span>
        <span class="s1">&#39;MSE_Promedio&#39;</span><span class="p">:</span> <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;MSE_Promedio&#39;</span><span class="p">],</span>
        <span class="s1">&#39;BDS_pvalue_Promedio&#39;</span><span class="p">:</span> <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;BDS_pvalue_Promedio&#39;</span><span class="p">]</span>
    <span class="p">})</span>

<span class="c1"># Crear DataFrame comparativo final</span>
<span class="n">df_mejores_lags</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">mejores_lags</span><span class="p">)</span>
<span class="n">df_mejores_lags</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Volatilidad</th>
      <th>Mejor Lag</th>
      <th>MAPE_Promedio</th>
      <th>MAE_Promedio</th>
      <th>RMSE_Promedio</th>
      <th>MSE_Promedio</th>
      <th>BDS_pvalue_Promedio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7 días</td>
      <td>7</td>
      <td>36.943658</td>
      <td>0.166657</td>
      <td>0.253073</td>
      <td>0.070197</td>
      <td>0.552800</td>
    </tr>
    <tr>
      <th>1</th>
      <td>14 días</td>
      <td>14</td>
      <td>21.532071</td>
      <td>0.113425</td>
      <td>0.160947</td>
      <td>0.028567</td>
      <td>0.500051</td>
    </tr>
    <tr>
      <th>2</th>
      <td>21 días</td>
      <td>21</td>
      <td>15.355218</td>
      <td>0.085854</td>
      <td>0.116717</td>
      <td>0.014655</td>
      <td>0.211632</td>
    </tr>
    <tr>
      <th>3</th>
      <td>28 días</td>
      <td>14</td>
      <td>10.937598</td>
      <td>0.062132</td>
      <td>0.086792</td>
      <td>0.008319</td>
      <td>0.529509</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">BASE_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
<span class="n">model_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="s1">&#39;app&#39;</span><span class="p">,</span> <span class="s1">&#39;modelos_finales&#39;</span><span class="p">)</span>
<span class="n">figs_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s1">&#39;figs&#39;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">figs_path</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Crear carpeta figs si no existe</span>

<span class="n">volatilidades</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">28</span><span class="p">]</span>
<span class="n">colores</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#0096c7&#39;</span><span class="p">,</span> <span class="s1">&#39;#ff6d00&#39;</span><span class="p">,</span> <span class="s1">&#39;#6a4c93&#39;</span><span class="p">,</span> <span class="s1">&#39;#00b159&#39;</span><span class="p">]</span> 
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s1"> días&#39;</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">volatilidades</span><span class="p">]</span>

<span class="c1"># Diccionario para guardar RMSE por horizonte</span>
<span class="n">rmse_por_horizonte</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># Cargar modelos y calcular RMSE por horizonte</span>
<span class="k">for</span> <span class="n">vol</span> <span class="ow">in</span> <span class="n">volatilidades</span><span class="p">:</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">model_path</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;mejor_modelo_vol</span><span class="si">{</span><span class="n">vol</span><span class="si">}</span><span class="s1">d.joblib&#39;</span><span class="p">)</span>
    <span class="n">modelo_data</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    
    <span class="n">residuos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">modelo_data</span><span class="p">[</span><span class="s1">&#39;residuos_mejor_fold&#39;</span><span class="p">])</span>  <span class="c1"># shape: (n_samples, n_steps_forecast)</span>
    
    <span class="c1"># RMSE por horizonte</span>
    <span class="n">rmse_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">residuos</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
    <span class="n">rmse_por_horizonte</span><span class="p">[</span><span class="n">vol</span><span class="p">]</span> <span class="o">=</span> <span class="n">rmse_h</span>

<span class="c1"># Crear DataFrame para graficar</span>
<span class="n">rmse_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rmse_por_horizonte</span><span class="p">)</span>
<span class="n">rmse_df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;H</span><span class="si">{</span><span class="n">h</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rmse_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>

<span class="c1"># Graficar</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">vol</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">volatilidades</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rmse_df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">rmse_df</span><span class="p">[</span><span class="n">vol</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colores</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">vol</span><span class="si">}</span><span class="s1"> días&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;RMSE por Horizonte de Predicción (4 volatilidades)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Horizonte (pasos de tiempo)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;RMSE&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Volatilidad&quot;</span><span class="p">)</span>

<span class="c1"># Guardar la figura en figs</span>
<span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">figs_path</span><span class="p">,</span> <span class="s1">&#39;rmse_horizontes_4_volatilidades.png&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0365ecc23ca61c4cdd311b7817e3380a83bb765a0c802eb42909c87e5ff3c40d.png" src="_images/0365ecc23ca61c4cdd311b7817e3380a83bb765a0c802eb42909c87e5ff3c40d.png" />
</div>
</div>
<p>Al analizar los RMSE promedio de cada volatilidad, se observa una tendencia clara: a medida que aumenta la ventana de volatilidad, el error disminuye de manera consistente. La volatilidad de 7 días presenta el RMSE más alto, con <strong>0.253</strong>, mientras que la de 28 días alcanza el más bajo, con <strong>0.087</strong>. Entre estos extremos, la volatilidad de 14 días muestra un RMSE de <strong>0.161</strong> y la de 21 días de <strong>0.117</strong>. Esto indica que las predicciones para series con ventanas más largas resultan más ajustadas, mientras que las series con ventanas cortas tienden a tener errores más altos.</p>
<p>Asimismo, se puede notar que en todos los horizontes, las series con menor ventana se encuentran consistentemente por encima de las demás, reflejando un error mayor en cada paso de predicción. En resumen, a mayor ventana de análisis, menor es el RMSE y, por tanto, más precisas son las predicciones según esta métrica.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="EDA.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong>Análisis Exploratorio de los Datos</strong></p>
      </div>
    </a>
    <a class="right-next"
       href="RESIDUOS.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><strong>Análisis de los residuos para cada volatilidad</strong></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#librerias"><strong>Librerías</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#base-de-datos"><strong>Base de datos</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#funciones-importantes"><strong>Funciones importantes</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-prediccion-por-volatilidad"><strong>Modelos de predicción por volatilidad</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#volatilidad-de-la-ventana-de-7-dias"><strong>Volatilidad de la ventana de 7 días</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretaciones"><strong>Interpretaciones</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#lag-7-dias"><strong>Lag 7 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#lag-14-dias"><strong>Lag 14 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#lag-21-dias"><strong>Lag 21 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#lag-28-dias"><strong>Lag 28 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#general"><strong>General</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#volatilidad-de-la-ventana-de-14-dias"><strong>Volatilidad de la ventana de 14 días</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"><strong>Interpretaciones</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><strong>Lag 7 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><strong>Lag 14 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id4"><strong>Lag 21 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id5"><strong>Lag 28 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id6"><strong>General</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#volatilidad-de-la-ventana-de-21-dias"><strong>Volatilidad de la ventana de 21 días</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7"><strong>Interpretaciones</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id8"><strong>Lag 7 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id9"><strong>Lag 14 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id10"><strong>Lag 21 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id11"><strong>Lag 28 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id12"><strong>General</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#volatilidad-de-la-ventana-de-28-dias"><strong>Volatilidad de la ventana de 28 días</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id13"><strong>Interpretaciones</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id14"><strong>Lag 7 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id15"><strong>Lag 14 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id16"><strong>Lag 21 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id17"><strong>Lag 28 días</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id18"><strong>General</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-general"><strong>Análisis general</strong></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Valentina Esther Cabrera De la Rosa
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>